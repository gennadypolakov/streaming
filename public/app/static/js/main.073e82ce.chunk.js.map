{"version":3,"sources":["configureStore.js","reducers/index.js","actions/actionTypes.js","reducers/albums.js","components/loadData.js","reducers/app.js","reducers/balance.js","reducers/channels.js","reducers/schedule.js","reducers/tariffs.js","reducers/videos.js","utils/requests.js","actions/app.js","actions/channels.js","actions/market.js","actions/shedule.js","actions/tariffs.js","actions/videos.js","components/PageHeader.js","utils/googleoauth.js","utils/authorization.js","components/Popup/index.js","components/Popup/Popup.js","Pages/Translations/item.js","Pages/Translations/Translations.js","Pages/Translations/index.js","components/User.js","Pages/Video/video.js","Pages/Video/album.js","Pages/Video/index.js","actions/albums.js","Pages/Market/ListTranslations.js","Pages/Market/index.js","Pages/Sheduler/index.js","Pages/Partner/index.js","actions/balance.js","Pages/Balance/History.js","Pages/Balance/Balance.js","Pages/Balance/index.js","Pages/Account/Account.js","Pages/Account/index.js","Pages/Menu/index.js","App.js","index.js"],"names":["preloadedState","history","FETCH_DATA_START","FETCH_DATA_END","initialState","albums","albums_index","reducers_albums","state","arguments","length","undefined","_ref","type","payload","Object","objectSpread","defineProperty","checked","loadData","react_default","a","createElement","style","display","alignItems","flexDirection","width","vkui","size","marginTop","marginBottom","LoadData","Success","fontSize","color","textAlign","Failure","msg","user","token","popout","process","activeTab","updating","message","app","isMobile","referrals","balance","profit","loaded","reducers_balance","owner","owner_index","shared","shared_index","disabled","disabled_index","vk","youtube","twitch","custom","ok","available","available_index","purchased","purchased_index","reducers_channels","group_id","users","active","sold","schedule","action","tariff","tariffs","video","video_index","selectedVideos","updated","videoId","videos","createBrowserHistory","authRequest","method","url","body","uri","init","headers","Authorization","concat","qs","stringify","Content-Type","fetch","then","response","json","e","console","log","appState","data","dispatch","setActiveTab","tab","path","push","setPopup","channelHandler","getState","serviceName","items","keys","numActiveChannels","key","hasOwnProperty","photo","photo_50","photo_default","channelData","id","name","service","live","del","time","sell","price","rtmp","indexOf","sharedTime","unlim","start","end","Number","sort","b","getUserChannels","status","Cookies","get","setInterval","updateData","window","location","protocol","host","addedChannelId","getAvailableChannels","channels","translation","getPurchasedChannels","res","channelState","searchChannels","formData","found","found_index","soldStreams","events","_loop","i","toConsumableArray","map","item","title","Date","v","join","purchasedStreams","_loop2","getTariff","Promise","resolve","editVideo","selectVideo","_getState$videos","ind","slice","setTimeout","PageHeader","menuType","_this","this","props","activeStory","tabbar","onClick","selected","text","similar_default","users_default","coins_default","reorder_default","vertical","theme","react","noShadow","Component","mapDispatchToProps","connect","OAuth","channelId","getChannel","popup","openBlankPopup","pollPopup","closePopup","channel","options","screenY","outerHeight","screenX","outerWidth","popupPathname","open","_ref2","reject","polling","closed","clearInterval","pathname","interval","error","_ref3","close","servicePath","fb","OAuth2","channelType","Popup","confirm","dismiss","onSubmit","preventDefault","className","stretched","marginRight","level","Channel","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","showInfo","setState","show","changePrice","target","value","rtmpUrl","parse","hostname","domain","query","port","isValidRtmpUrl","rtmpKey","trim","isValidRtmpKey","saveChanges","JSON","customChannelName","enableBroadcast","stopPropagation","_this$props$data","amount","broadcast","rtmpError","paymentPopup","deleteChannel","changeTimeStart","getTime","timeEnd","timeStart","access","changeTimeEnd","addUser","vk_id","urlParts","split","time_start","getUnixTime","time_end","timeNow","enabledForMe","editAccess","minutesStep","isValidLink","_this2","_this$state","_this$props","channelStatus","titleOnly","before","src","bottomContent","delete_default","top","placeholder","onChange","defaultValue","bottom","justifyContent","paddingTop","maxWidth","format","marginLeft","multiline","search","defaultChecked","material_ui_pickers_esm","utils","DateFnsUtils","locale","ruLocale","keyboard","ampm","label","onError","minDate","disableOpenOnEnter","mask","cancelLabel","index","removable","onRemove","removeUser","user_id","surname","Translations","resultPopup","copied","confirmPopup","popupMsg","confirmFn","onClose","authorize","addUserGroup","displayChannels","filter","Translations_item","channelSettings","rtmpColsdHandler","rtmpColsd","logo","document","updateStreamKey","mainStyles","paddingBottom","activePanel","components_PageHeader","browser_forward_default","lib_default","onCopy","copy_default","left","browser_back_default","addon","height","CustomRTMP","router","CustomRtmpComponent","_this3","setRtmp","match","rtmpStatus","setKey","keyStatus","addCustomRtmp","_this3$props","typeName","_this4","User","logout","remove","assign","vkApp","padding","asideContent","first_name","last_name","VideoItem","_this$props$video","preview","alt","write_default","ownProps","Album","showAlbum","selectAlbum","countVideo","React","Video","formAddAlbum","formEditAlbum","formAddVideo","formEditVideo","h","alignment","newAlbum","addAlbum","albumId","album","editAlbum","deleteAlbum","addVideo","getRef","newVideoForm","video_default","album_index","newVideoName","newVideoAlbum","deleteVideo","showAll","startBroadcast","FormData","append","display_name","editVideoApi","getAlbums","selectChannel","selectedChannels","selectStream","selectedStreams","setVideos2Streams","streams","changed","getVideos","params","_this$props2","components_User","upload_default","add_default","description","toLoop","setTime","block","Video_album","Video_video","ListTranslations","getStreamTime","select","buyStreamTime","availableTime","timeStreams","newTS","startOfDay","endOfDay","setStreamDate","date","getSum","sum","Math","ceil","list","_this$state2","cancel_default","formBuyTime","ref","dateBroadcast","Market","searchTranslationClick","formSearchChannels","hidden","spinner","Market_ListTranslations","Scheduler","shedulerSwitch","showChannel","defaultView","fullcalendar_reactwrapper_lib_default","header","center","right","buttonText","today","month","week","day","editable","allDaySlot","selectHelper","droppable","slotLabelFormat","defaultDate","navLinks","eventLimit","timeFormat","eventLimitText","dayPopoverFormat","selectable","jsEvent","view","Partner","copyLink","getReferrals","reflink","ref_id","partners","floor","fename","History","t","balanceHistory","Balance","prolongPopup","prolongTariff","channelCount","count","discount","maxDiscount","totalPrice","newAmount","needPayment","changeTariff","localStorage","payment","checkPayment","doPayment","paymentSystem","form","submit","connectVk","send","app_id","intervalId","getBalance","receiver","buttonChangeTariff","Balance_History","react_router_dom","to","Slider_default","classes","thumb","track","min","max","step","event","String","_form","newState","newProps","tariffState","order","Account","Menu","expandable","user_default","App","updateInfo","subscribe","detail","fetchedUser","vk_access_token","access_token","newUser","login","scope","addEventListener","innerWidth","documentElement","clientWidth","getElementsByTagName","setIsMobile","react_router","exact","component","jwt","set","expires","withRouter","store","createStore","combineReducers","connectRouter","composeWithDevTools","applyMiddleware","routerMiddleware","thunk","ReactDOM","render","es","esm","src_App_0","getElementById"],"mappings":"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","file":"static/js/main.073e82ce.chunk.js","sourcesContent":["import { createBrowserHistory } from 'history';\r\nimport { applyMiddleware, createStore, compose } from 'redux';\r\nimport { routerMiddleware } from 'connected-react-router';\r\nimport thunk from 'redux-thunk';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\n\r\nimport createRootReducer from './reducers';\r\n\r\nexport const history = createBrowserHistory();\r\n\r\nexport const configureStore = preloadedState => {\r\n    return createStore(\r\n        createRootReducer(history),\r\n        preloadedState,\r\n        // compose(\r\n        composeWithDevTools(\r\n            applyMiddleware(\r\n                routerMiddleware(history),\r\n                thunk\r\n            )\r\n        )\r\n    );\r\n};\r\n","import { combineReducers } from 'redux';\r\nimport { connectRouter } from 'connected-react-router';\r\nimport albums from './albums';\r\nimport app from './app';\r\nimport balance from './balance';\r\nimport channels from './channels';\r\nimport schedule from './schedule';\r\nimport tariffs from './tariffs';\r\nimport videos from './videos';\r\n\r\nexport default history => combineReducers({\r\n    router: connectRouter(history),\r\n    albums,\r\n    app,\r\n    balance,\r\n    channels,\r\n    schedule,\r\n    tariffs,\r\n    videos\r\n});","export const FETCH_DATA_START = 'FETCH_DATA_START',\r\n  FETCH_DATA_SUCCESS = 'FETCH_DATA_SUCCESS',\r\n  FETCH_DATA_FAILURE = 'FETCH_DATA_FAILURE',\r\n  FETCH_DATA_END = 'FETCH_DATA_END',\r\n\r\n  SET_STATE = 'SET_STATE',\r\n  LOGIN = 'LOGIN',\r\n  LOGOUT = 'LOGOUT',\r\n\r\n  ACTIVE_TAB = 'ACTIVE_TAB',\r\n  SET_POPUP = 'SET_POPUP',\r\n  POPUP_MESSAGE = 'POPUP_MESSAGE',\r\n\r\n  ALBUMS = 'ALBUMS',\r\n  SELECT_ALBUM = 'SELECT_ALBUM',\r\n\r\n  USER_CHANNELS = 'USER_CHANNELS',\r\n  USERS = 'USERS',\r\n  DISABLED_USER_CHANNELS = 'DISABLED_USER_CHANNELS',\r\n  AVAILABLE_CHANNELS = 'AVAILABLE_CHANNELS',\r\n  PURCHASED_CHANNELS = 'PURCHASED_CHANNELS',\r\n  FOUND_CHANNELS = 'FOUND_CHANNELS',\r\n  BROADCAST = 'BROADCAST',\r\n  CHANNEL_STATE = 'CHANNEL_STATE',\r\n\r\n  TARIFF = 'TARIFF',\r\n  BALANCE = 'BALANCE',\r\n  HISTORY = 'HISTORY',\r\n\r\n  REFERRALS = 'REFERRALS',\r\n\r\n  SOLD_STREAMS = 'SOLD_STREAMS',\r\n  PURCHASED_STREAMS = 'PURCHASED_STREAMS',\r\n\r\n  VIDEOS = 'VIDEOS',\r\n  SELECT_VIDEO = 'SELECT_VIDEO',\r\n  SELECT_VIDEOS = 'SELECT_VIDEOS',\r\n  EDIT_VIDEO = 'EDIT_VIDEO',\r\n\r\n  START = 'START',\r\n  CLEAR_STATUS = 'CLEAR_STATUS',\r\n  SUCCESS = 'SUCCESS',\r\n  FAILURE = 'FAILURE',\r\n  POPUP_SUCCESS = 'POPUP_SUCCESS',\r\n  POPUP_FAILURE = 'POPUP_FAILURE',\r\n\r\n  IS_MOBILE = 'IS_MOBILE';\r\n","import { ALBUMS, SELECT_ALBUM } from './../actions/actionTypes';\r\n\r\nconst initialState = {\r\n    albums: {},\r\n    albums_index: []\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n    switch (type) {\r\n        case ALBUMS:\r\n            return { ...state, ...payload };\r\n        case SELECT_ALBUM:\r\n            return {\r\n                ...state,\r\n                albums: {\r\n                    ...state.albums,\r\n                    [payload]: {\r\n                        ...state.albums[payload],\r\n                        checked: !state.albums[payload].checked\r\n                    }\r\n                }\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","import React from 'react';\r\nimport { Spinner } from '@vkontakte/vkui';\r\n\r\nexport default () => {\r\n    return (\r\n        <div style={{ display: 'flex', alignItems: 'center', flexDirection: 'column', width: '100%' }}>\r\n            <Spinner size=\"large\" style={{ marginTop: 30, marginBottom: 30 }} />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport const LoadData = <div\r\n    style={{\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        flexDirection: 'column',\r\n        width: '100%'\r\n    }}>\r\n    <Spinner size=\"large\" style={{ marginTop: 10, marginBottom: 10 }} />\r\n</div>\r\n\r\nexport const Success = <div style={{\r\n    marginTop: 10,\r\n    marginBottom: 10,\r\n    fontSize: 15,\r\n    color: 'green',\r\n    textAlign: 'center',\r\n    width: '100%'\r\n}}>Успешно!</div>\r\n\r\nexport const Failure = (msg = false) => <div style={{\r\n    marginTop: 10,\r\n    marginBottom: 10,\r\n    color: 'red',\r\n    textAlign: 'center',\r\n    fontSize: 15,\r\n    width: '100%'\r\n}}>{msg || 'Что-то пошло не так ☹'}</div>\r\n","import { LoadData, Success, Failure } from '../components/loadData';\r\nimport { FETCH_DATA_START, FETCH_DATA_END, LOGIN, LOGOUT, START, SUCCESS, FAILURE, CLEAR_STATUS, POPUP_SUCCESS, POPUP_FAILURE, ACTIVE_TAB, SET_POPUP, POPUP_MESSAGE, SET_STATE, IS_MOBILE } from './../actions/actionTypes';\r\n\r\nconst initialState = {\r\n    user: false,\r\n    token: false,\r\n    popout: 'hidden',\r\n    loadData: false,\r\n    process: null,\r\n    activeTab: false,\r\n    updating: 0,\r\n    message: false\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n    switch (type) {\r\n        case SET_STATE:\r\n            return { ...state, ...payload };\r\n        case SET_POPUP:\r\n            return { ...state, ...payload };\r\n        case FETCH_DATA_START:\r\n            return { ...state, updating: 1, popout: 'spinner' };\r\n        case FETCH_DATA_END:\r\n            return { ...state, updating: 0, popout: 'hidden' };\r\n        case LOGIN:\r\n            return { ...state, ...payload };\r\n        case LOGOUT:\r\n            return { ...state, user: false, token: false };\r\n        case START:\r\n            return { ...state, process: LoadData };\r\n        case SUCCESS:\r\n            return { ...state, process: Success };\r\n        case FAILURE:\r\n            return { ...state, process: payload ? Failure(payload) : Failure() };\r\n        case POPUP_SUCCESS:\r\n            return { ...state, updating: 2, popout: 'success' };\r\n        case POPUP_FAILURE:\r\n            return { ...state, updating: 2, popout: 'failure' };\r\n        case POPUP_MESSAGE:\r\n            return { ...state, updating: 2, popout: 'message', ...payload };\r\n        case CLEAR_STATUS:\r\n            return { ...state, process: null };\r\n        case ACTIVE_TAB:\r\n            return { ...state, activeTab: payload };\r\n        case IS_MOBILE:\r\n            return { ...state, isMobile: payload };\r\n        default:\r\n            return state;\r\n    }\r\n}","import { BALANCE, HISTORY, REFERRALS } from './../actions/actionTypes';\r\n\r\nconst initialState = {\r\n    referrals: [],\r\n    balance: 0,\r\n    profit: 0,\r\n    history: [],\r\n    loaded: false\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n    switch (type) {\r\n        case REFERRALS:\r\n            return { ...state, ...payload };\r\n        case BALANCE:\r\n            return { ...state, ...payload };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","import { USER_CHANNELS, DISABLED_USER_CHANNELS, AVAILABLE_CHANNELS, FOUND_CHANNELS, PURCHASED_CHANNELS, USERS, BROADCAST, CHANNEL_STATE } from './../actions/actionTypes';\r\n\r\nconst initialState = {\r\n    owner: {},\r\n    owner_index: [],\r\n    shared: {},\r\n    shared_index: [],\r\n    disabled: {},\r\n    disabled_index: {\r\n        vk: [],\r\n        youtube: [],\r\n        twitch: [],\r\n        custom: [],\r\n        ok: []\r\n    },\r\n    available: {},\r\n    available_index: [],\r\n    purchased: {},\r\n    purchased_index: [],\r\n    loaded: false\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n    switch (type) {\r\n        case USER_CHANNELS:\r\n            return { ...state, ...payload, loaded: true };\r\n        case DISABLED_USER_CHANNELS:\r\n            return { ...state, ...payload };\r\n        case AVAILABLE_CHANNELS:\r\n            return { ...state, ...payload };\r\n        case FOUND_CHANNELS:\r\n            return { ...state, ...payload };\r\n        case PURCHASED_CHANNELS:\r\n            return { ...state, ...payload };\r\n        case USERS:\r\n            return {\r\n                ...state,\r\n                owner: {\r\n                    ...state.owner,\r\n                    [payload.group_id]: {\r\n                        ...state.owner[payload.group_id],\r\n                        users: payload.users\r\n                    }\r\n                }\r\n            };\r\n        case BROADCAST:\r\n            return {\r\n                ...state,\r\n                [payload.owner]: {\r\n                    ...state[payload.owner],\r\n                    [payload.group_id]: {\r\n                        ...state[payload.owner][payload.group_id],\r\n                        active: +!state[payload.owner][payload.group_id].active\r\n                    }\r\n                }\r\n            };\r\n        case CHANNEL_STATE:\r\n            return {\r\n                ...state,\r\n                ...payload\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n","import { SOLD_STREAMS, PURCHASED_STREAMS } from './../actions/actionTypes';\r\n\r\nconst initialState = {\r\n    sold: [],\r\n    purchased: []\r\n};\r\n\r\nexport default (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case SOLD_STREAMS:\r\n            return { ...state, sold: action.payload };\r\n        case PURCHASED_STREAMS:\r\n            return { ...state, purchased: action.payload };\r\n        default:\r\n            return state;\r\n    }\r\n}","import { TARIFF } from './../actions/actionTypes';\r\n\r\nconst initialState = {\r\n    tariff: false,\r\n    balance: 0\r\n};\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n    switch (type) {\r\n        case TARIFF:\r\n            return { ...state, ...payload };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","import { VIDEOS, SELECT_VIDEO, SELECT_VIDEOS, EDIT_VIDEO } from './../actions/actionTypes';\r\n\r\nconst initialState = {\r\n    video: {},\r\n    video_index: [],\r\n    selectedVideos: [],\r\n    updated: false,\r\n    videoId: false\r\n}\r\n\r\nexport default (state = initialState, { type, payload }) => {\r\n    switch (type) {\r\n        case VIDEOS:\r\n            return { ...state, ...payload, updated: true };\r\n        case SELECT_VIDEO:\r\n            return { ...state, ...payload };\r\n        case SELECT_VIDEOS:\r\n            return { ...state, ...payload };\r\n        case EDIT_VIDEO:\r\n            return { ...state, videoId: payload };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","// import request from 'request';\r\nimport qs from 'querystring';\r\n\r\n// export const authRequest = ({ method, url, token, body }) => {\r\n//     return new Promise((resolve, reject) => {\r\n//         const config = {\r\n//             url: url,\r\n//             headers: {\r\n//                 'Authorization': 'Bearer ' + token\r\n//             }\r\n//         }\r\n//         if (method === 'GET') {\r\n//             config.method = 'GET';\r\n//             if (body) config.qs = body;\r\n//         } else if (method === 'POST') {\r\n//             config.method = 'POST';\r\n//             if (body && body.formData) config.formData = body.formData;\r\n//             else config.form = body;\r\n//         }\r\n//         try {\r\n//             request(config, (err, res, body) => {\r\n//                 if (!err && res.statusCode == 200) {\r\n//                     console.log(JSON.parse(body))\r\n//                     resolve(JSON.parse(body));\r\n//                 }\r\n//                 else console.log('request.js', err);\r\n//             });\r\n//         } catch (e) {\r\n//             console.log('request.js catch!', e);\r\n//         }\r\n//     });\r\n// };\r\n\r\nexport const authRequest = ({ method, url, token, body }) => {\r\n    let uri = url;\r\n    let init = {\r\n        method,\r\n        headers: {\r\n            'Authorization': 'Bearer ' + token\r\n        }\r\n    }\r\n    if (method === 'GET') {\r\n        if (body) uri = `${uri}?${qs.stringify({ ...body, token })}`;\r\n    } else if (method === 'POST') {\r\n        if (body) {\r\n            init = {\r\n                ...init,\r\n                headers: {\r\n                    ...init.headers,\r\n                    'Content-Type': 'application/x-www-form-urlencoded'\r\n                },\r\n                body: qs.stringify(body)\r\n            }\r\n        }\r\n    }\r\n    return fetch(uri, init)\r\n        .then(response => {\r\n            try {\r\n                if (response.ok) return response.json();\r\n                else return false;\r\n            } catch (e) {\r\n                console.log('request.js catch', e);\r\n                return false;\r\n            }\r\n        });\r\n};\r\n","import { push } from 'connected-react-router';\r\nimport Cookies from 'js-cookie';\r\nimport { login as loginApi } from '../api';\r\nimport { FETCH_DATA_START, FETCH_DATA_END, LOGIN, LOGOUT, ACTIVE_TAB, SET_POPUP, SET_STATE, BALANCE, POPUP_MESSAGE, POPUP_SUCCESS, POPUP_FAILURE, IS_MOBILE } from './actionTypes';\r\n\r\nexport const appState = (data) => dispatch => dispatch({ type: SET_STATE, payload: data });\r\n\r\nexport const logout = () => dispatch => dispatch({ type: LOGOUT });\r\n\r\nexport const updateStreamKey = () => (dispatch, getState) => {\r\n\r\n  const updating = getState().app.updating;\r\n  if (!updating) dispatch({ type: FETCH_DATA_START });\r\n  let status = false;\r\n  let token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(status));\r\n  }\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({ token })\r\n  };\r\n  const url = `${window.location.protocol}//${window.location.host}/api/key`;\r\n\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return { data: { status: false } };\r\n    })\r\n    .then(data => {\r\n      console.log(data);\r\n      if (data.rtmp) {\r\n        const user = getState().app.user;\r\n        const { rtmp } = data;\r\n        dispatch({ type: SET_STATE, payload: { user: { ...user, rtmp } }});\r\n        dispatch({ type: POPUP_SUCCESS });\r\n        status = true;\r\n      } else {\r\n        dispatch({ type: POPUP_FAILURE });\r\n      }\r\n      if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const login = () => (dispatch, getState) => {\r\n\r\n  const updating = getState().app.updating;\r\n  if (!updating) dispatch({ type: FETCH_DATA_START });\r\n  let status = false;\r\n  let token = getState().app.token || Cookies.get('token');\r\n  const search = getState().router.location.search;\r\n  if (!token && !search) {\r\n    dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(status));\r\n  }\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({ token })\r\n  };\r\n  const url = `${window.location.protocol}//${window.location.host}/api/auth${search}`;\r\n\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return { data: { status: false } };\r\n    })\r\n    .then(data => {\r\n      if (data.user_id) {\r\n        if (data.jwt) {\r\n          token = data.jwt;\r\n          Cookies.set('token', data.jwt, { expires: 30 });\r\n        }\r\n        dispatch({ type: LOGIN, payload: { user: data, token } });\r\n        if (data.balance) dispatch({ type: BALANCE, payload: { balance: data.balance, history: data.history } });\r\n        status = true;\r\n      } else dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const newUser = () => (dispatch, getState) => {\r\n  if (getState().app.updating === 0) dispatch({ type: FETCH_DATA_START });\r\n  let status = false;\r\n  const user = getState().app.fetchedUser;\r\n  const vk_access_token = getState().app.vk_access_token;\r\n  if (!user && !vk_access_token) {\r\n    if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(status));\r\n  }\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({ user, vk_access_token })\r\n  };\r\n  const url = `${window.location.protocol}//${window.location.host}/api/auth`;\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return { data: { status: false } };\r\n    })\r\n    .then(data => {\r\n      if (data.user_id) {\r\n        let token = false;\r\n        if (data.jwt) {\r\n          token = data.jwt;\r\n          Cookies.set('token', data.jwt, { expires: 30 });\r\n        }\r\n        dispatch({ type: LOGIN, payload: { user: data, token } });\r\n        if (data.balance) dispatch({ type: BALANCE, payload: { balance: data.balance } });\r\n        status = true;\r\n      } else if (data.message) {\r\n        dispatch({ type: POPUP_MESSAGE, payload: { message: data.message } });\r\n      }\r\n      if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const setActiveTab = (tab, path = false) => (dispatch) => {\r\n  if (path) dispatch(push(path));\r\n  else {\r\n    if (tab === 'translations') dispatch(push('/'));\r\n    else dispatch(push(`/${tab}`));\r\n  }\r\n  dispatch({ type: ACTIVE_TAB, payload: tab });\r\n};\r\n\r\nexport const setPopup = (popout, message = false) => dispatch => dispatch({ type: SET_POPUP, payload: { popout, message } });\r\n\r\nexport const setIsMobile = (data) => (dispatch) => { dispatch({ type: IS_MOBILE, payload: data })};\r\n","import Cookies from 'js-cookie';\r\nimport { authRequest } from '../utils/requests';\r\nimport qs from 'querystring';\r\nimport {\r\n  FETCH_DATA_START,\r\n  FETCH_DATA_END,\r\n  USER_CHANNELS,\r\n  DISABLED_USER_CHANNELS,\r\n  AVAILABLE_CHANNELS,\r\n  PURCHASED_CHANNELS,\r\n  CHANNEL_STATE,\r\n  USERS,\r\n  START,\r\n  SUCCESS,\r\n  FAILURE,\r\n  CLEAR_STATUS,\r\n  POPUP_SUCCESS,\r\n  POPUP_FAILURE,\r\n  BROADCAST,\r\n  SET_STATE\r\n} from './../actions/actionTypes';\r\n\r\nconst channelHandler = (data, getState) => {\r\n\r\n  // const channels = getState().channels.owner_index;\r\n  const serviceName = {\r\n    vk: 'VK',\r\n    youtube: 'Youtube',\r\n    twitch: 'Twitch',\r\n    custom: 'Свой сервер',\r\n    ok: 'Одноклассники'\r\n  };\r\n  if (data.items && Object.keys(data.items).length > 0) {\r\n    const items = data.items;\r\n    const owner = {};\r\n    const owner_index = [];\r\n    const shared = {};\r\n    const shared_index = [];\r\n    const disabled = {};\r\n    const disabled_index = {\r\n      vk: [],\r\n      youtube: [],\r\n      twitch: [],\r\n      custom: [],\r\n      ok: []\r\n    };\r\n    let numActiveChannels = 0;\r\n    for (let key in items) {\r\n      if(!items.hasOwnProperty(key)) continue;\r\n      let photo = '/app/img/logo/custom.png';\r\n      if(items[key].type === 'vk') photo = items[key].photo_50;\r\n      if(items[key].type === 'youtube' || items[key].type === 'twitch') photo = items[key].photo_default;\r\n      if(items[key].type === 'ok') photo = '/app/img/logo/ok.png';\r\n      let channelData = {\r\n        group_id: +items[key].group_id,\r\n        id: items[key].id,\r\n        name: items[key].name,\r\n        photo,\r\n        service: serviceName[items[key].type],\r\n        type: items[key].type,\r\n        live: +items[key].live\r\n      };\r\n      if (+items[key].del === 0) {\r\n        if (items[key].owner) {\r\n          owner[key] = {\r\n            ...channelData,\r\n            users: items[key].users,\r\n            active: +items[key].active,\r\n            time: items[key].time,\r\n            sell: +items[key].sell,\r\n            price: items[key].price ? +items[key].price : 0,\r\n            rtmp: items[key].rtmp ? items[key].rtmp : false,\r\n            owner: true\r\n          };\r\n          if (owner_index.indexOf(+key) === -1) owner_index.push(+key);\r\n        } else {\r\n          shared[key] = {\r\n            ...channelData,\r\n            active: +items[key].active,\r\n            time: items[key].time,\r\n            rtmp: !!items[key].rtmp,\r\n            sharedTime: {\r\n              unlim: +items[key].unlim ? 1 : 0,\r\n              start: items[key].start,\r\n              end: items[key].end\r\n            }\r\n          };\r\n          if (shared_index.indexOf(+key) === -1) shared_index.push(+key);\r\n        }\r\n        if(!!Number(items[key].active)){\r\n          numActiveChannels++;\r\n        }\r\n      } else if (+items[key].del === 1) {\r\n        disabled[key] = channelData;\r\n        if (disabled_index[items[key].type].indexOf(+key) === -1) disabled_index[items[key].type].push(+key);\r\n      }\r\n    }\r\n    owner_index.sort((a, b) => b - a);\r\n    shared_index.sort((a, b) => b - a);\r\n\r\n    // const tempArr = [];\r\n    // let addedChannelId;\r\n    // if(channels.length === owner_index.length + 1){\r\n    //   owner_index.forEach((id,) => {\r\n    //     if (channels.indexOf(+id) === -1) tempArr.push(+id);\r\n    //   });\r\n    //   if(tempArr.length === 1){\r\n    //     addedChannelId = tempArr[0];\r\n    //   }\r\n    // }\r\n    // return { owner, owner_index, shared, shared_index, disabled, disabled_index, addedChannelId };\r\n    return { owner, owner_index, shared, shared_index, disabled, disabled_index, numActiveChannels };\r\n  }\r\n  return {};\r\n};\r\n\r\nexport const getUserChannels = () => (dispatch, getState) => {\r\n  let status = false;\r\n  if (getState().app.updating === 0) dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n    return status;\r\n  }\r\n\r\n  setInterval(() => updateData(dispatch, getState), 30000);\r\n\r\n  return authRequest({\r\n    method: 'GET',\r\n    url: `${window.location.protocol}//${window.location.host}/api/groups`,\r\n    token,\r\n    body: { token }\r\n  }).then(data => {\r\n    console.log('data', data);\r\n\r\n    dispatch({ type: USER_CHANNELS, payload: channelHandler(data, getState) });\r\n    status = true;\r\n    if(data.addedChannelId){\r\n      dispatch({ type: CHANNEL_STATE, payload: { addedChannelId: data.addedChannelId } });\r\n    }\r\n    // }\r\n    if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n    return status;\r\n  });\r\n};\r\n\r\nconst updateData = (dispatch, getState) => {\r\n  const token = getState().app.token || Cookies.get('token');\r\n  return authRequest({\r\n    method: 'GET',\r\n    url: `${window.location.protocol}//${window.location.host}/api/groups`,\r\n    token,\r\n    body: { token }\r\n  }).then(data => {\r\n    dispatch({ type: USER_CHANNELS, payload: channelHandler(data, getState) });\r\n  });\r\n};\r\n\r\n\r\nexport const getAvailableChannels = () => (dispatch, getState) => {\r\n  let status = false;\r\n  if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n    return status;\r\n  }\r\n  return authRequest({\r\n    method: 'GET',\r\n    url: `${window.location.protocol}//${window.location.host}/api/groups`,\r\n    token,\r\n    body: { token, channels: 'available' }\r\n  }).then(data => {\r\n    if (data.items) {\r\n      const items = data.items;\r\n      const available = {};\r\n      const available_index = [];\r\n      for (let key in items) {\r\n        available[key] = {\r\n          group_id: +items[key].group_id,\r\n          id: items[key].id,\r\n          price: +items[key].price,\r\n          name: items[key].name,\r\n          photo: items[key].type === 'vk' ? items[key].photo_50 : items[key].type === 'youtube' ? items[key].photo_default : '',\r\n          service: items[key].type === 'vk' ? 'VK' : items[key].type === 'youtube' ? 'Youtube' : '',\r\n          translation: true,\r\n          time: items[key].time\r\n        };\r\n        if (available_index.indexOf(+key) === -1) available_index.push(+key);\r\n      }\r\n      available_index.sort((a, b) => b - a);\r\n      dispatch({ type: AVAILABLE_CHANNELS, payload: { available, available_index } });\r\n      status = true;\r\n    }\r\n    if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n    return status;\r\n  });\r\n};\r\n\r\nexport const addCustomRtmp = (data) => (dispatch, getState) => {\r\n  if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    setTimeout(() => dispatch({ type: CLEAR_STATUS }), 1500);\r\n    return new Promise(resolve => resolve(dispatch({ type: POPUP_FAILURE })));\r\n  }\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': `Bearer ${token}`\r\n    },\r\n    body: JSON.stringify({ ...data, token, action: 'add_rtmp' })\r\n  };\r\n  return fetch(`${window.location.protocol}//${window.location.host}/api/groups`, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return false;\r\n    })\r\n    .then(data => {\r\n      if (data) {\r\n        dispatch({ type: USER_CHANNELS, payload: channelHandler(data, getState) });\r\n\r\n        if(data.addedChannelId){\r\n          dispatch({ type: CHANNEL_STATE, payload: { addedChannelId: data.addedChannelId } });\r\n        }\r\n\r\n      }\r\n\r\n      if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n\r\n    });\r\n};\r\n\r\nexport const saveChanges = formData => (dispatch, getState) => {\r\n  if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n  // dispatch({ type: START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    // setTimeout(() => dispatch({ type: CLEAR_STATUS }), 1500)\r\n    return new Promise(resolve => resolve(dispatch({ type: POPUP_FAILURE })));\r\n  }\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': `Bearer ${token}`\r\n    },\r\n    body: JSON.stringify({ ...formData, token })\r\n  };\r\n  return fetch(`${window.location.protocol}//${window.location.host}/api/groups`, init)\r\n    .then((res) => {\r\n      if (res.ok) return res.json();\r\n      else return { status: false };\r\n    })\r\n    .then(({ status }) => {\r\n      setTimeout(() => dispatch({ type: CLEAR_STATUS }), 1500);\r\n      if (status === 'ok') return dispatch({ type: POPUP_SUCCESS });\r\n      return dispatch({ type: POPUP_FAILURE });\r\n    });\r\n};\r\n\r\n\r\n// export const saveChanges = formData => (dispatch, getState) => {\r\n//     // dispatch({ type: START });\r\n//     const token = getState().app.token || Cookies.get('token');\r\n//     if (!token) {\r\n//         // setTimeout(() => dispatch({ type: CLEAR_STATUS }), 1500)\r\n//         return new Promise(resolve => resolve(dispatch({ type: FAILURE })));\r\n//     }\r\n//     const init = {\r\n//         method: 'POST',\r\n//         headers: {\r\n//             'Content-Type': 'application/json',\r\n//             'Authorization': `Bearer ${token}`\r\n//         },\r\n//         body: JSON.stringify({ ...formData, token })\r\n//     };\r\n//     return fetch(`${window.location.protocol}//${window.location.host}/api/groups`, init)\r\n//         .then((res) => {\r\n//             if (res.ok) return res.json();\r\n//             else return false;\r\n//         })\r\n//         .then(data => {\r\n//             setTimeout(() => dispatch({ type: CLEAR_STATUS }), 1500)\r\n//             if (data && data.status && data.status == 'ok') return dispatch({ type: SUCCESS });\r\n//             return dispatch({ type: FAILURE });\r\n//         });\r\n// }\r\n\r\nexport const enableBroadcast = formData => (dispatch, getState) => {\r\n  if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n  let status = false;\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(status));\r\n  }\r\n  const url = `${window.location.protocol}//${window.location.host}/api/groups`;\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': `Bearer ${token}`\r\n    },\r\n    body: JSON.stringify({ ...formData, token }) // qs.stringify(formData)\r\n  };\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) {\r\n        // return response.text();\r\n        return response.json();\r\n      }\r\n      else return false;\r\n    })\r\n    .then(data => {\r\n      if (data && data.status && data.status === 'ok') {\r\n        dispatch({ type: BROADCAST, payload: formData });\r\n        if(+formData.broadcast === 1){\r\n          dispatch({ type: CHANNEL_STATE, payload: { numActiveChannels: ++getState().channels.numActiveChannels } });\r\n        } else if(+formData.broadcast === 0) {\r\n          dispatch({ type: CHANNEL_STATE, payload: { numActiveChannels: --getState().channels.numActiveChannels } });\r\n        }\r\n        status = true;\r\n      }\r\n      if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const addUser = formData => (dispatch, getState) => {\r\n  if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n  let status = false;\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(status));\r\n  }\r\n  const url = `${window.location.protocol}//${window.location.host}/api/groups`;\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': `Bearer ${token}`\r\n    },\r\n    body: JSON.stringify({ ...formData, token }) // qs.stringify(formData)\r\n  };\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return false;\r\n    })\r\n    .then(data => {\r\n      if (data) {\r\n        dispatch({ type: USERS, payload: data });\r\n        status = true;\r\n      }\r\n      if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const removeUser = (user_id, group_id) => (dispatch, getState) => {\r\n  if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n  let status = false;\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(status));\r\n  }\r\n  const url = `${window.location.protocol}//${window.location.host}/api/groups`;\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': `Bearer ${token}`\r\n    },\r\n    body: JSON.stringify({ user_id, group_id, access: 'delete', token }) // qs.stringify(formData)\r\n  };\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return false;\r\n    })\r\n    .then(data => {\r\n      if (data) {\r\n        dispatch({ type: USERS, payload: data });\r\n        status = true;\r\n      }\r\n      if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const deleteChannel = (token, id) => dispatch => {\r\n  dispatch({ type: START });\r\n  const formData = {\r\n    action: 'delete',\r\n    group_id: id,\r\n    token: token\r\n  };\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/x-www-form-urlencoded',\r\n      'Authorization': `Bearer ${token}`\r\n    },\r\n    body: qs.stringify(formData)\r\n  };\r\n  return fetch(`${window.location.protocol}//${window.location.host}/api/groups`, init)\r\n    .then((res) => {\r\n      if (res.ok) return res.json();\r\n    })\r\n    .then(data => {\r\n      setTimeout(() => dispatch({ type: CLEAR_STATUS }), 1500);\r\n      if (data.status && data.status === 'ok') return dispatch({ type: SUCCESS });\r\n      return dispatch({ type: FAILURE });\r\n    });\r\n};\r\n\r\nexport const getPurchasedChannels = () => (dispatch, getState) => {\r\n  let status = false;\r\n  if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n    return status;\r\n  }\r\n  const init = {\r\n    method: 'GET',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`\r\n    }\r\n  };\r\n  return fetch(`${window.location.protocol}//${window.location.host}/api/market?token=${token}`, init)\r\n    .then(res => {\r\n      if (res.ok) return res.json();\r\n    })\r\n    .then(data => {\r\n      if (data.purchased) {\r\n        const items = data.purchased;\r\n        const purchased = {};\r\n        const purchased_index = data.purchased_index.sort((a, b) => b - a);\r\n        for (let key in items) {\r\n          purchased[key] = {\r\n            group_id: +items[key].group_id,\r\n            id: items[key].id,\r\n            price: +items[key].price,\r\n            sell: +items[key].sell,\r\n            name: items[key].name,\r\n            photo: items[key].type === 'vk' ? items[key].photo_50 : items[key].type === 'youtube' ? items[key].photo_default : '',\r\n            service: items[key].type === 'vk' ? 'VK' : items[key].type === 'youtube' ? 'Youtube' : '',\r\n            translation: true,\r\n            time: items[key].time,\r\n            rtmp: items[key].rtmp ? items[key].rtmp : false\r\n          }\r\n        }\r\n        dispatch({ type: PURCHASED_CHANNELS, payload: { purchased, purchased_index } });\r\n        status = true;\r\n      }\r\n      if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const channelState = data => dispatch => dispatch({ type: CHANNEL_STATE, payload: data });\r\n","import qs from 'querystring';\r\nimport { FETCH_DATA_START, FETCH_DATA_END, FOUND_CHANNELS, START, SUCCESS, FAILURE, CLEAR_STATUS } from './../actions/actionTypes';\r\n\r\nexport const searchChannels = (token, formData = false) => (dispatch, getState) => {\r\n    if (!formData) formData = {\r\n        action: 'search',\r\n        token: token\r\n    };\r\n    dispatch({ type: FETCH_DATA_START });\r\n    const init = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n            'Authorization': `Bearer ${token}`\r\n        },\r\n        body: qs.stringify(formData)\r\n    };\r\n    return fetch(`${window.location.protocol}//${window.location.host}/api/market`, init)\r\n        .then((res) => {\r\n            if (res.ok) return res.json();\r\n        })\r\n        .then(data => {\r\n            if (data.status && data.status === 'ok') {\r\n                const items = data.items;\r\n                const found = {};\r\n                const found_index = Object.keys(data.items).sort((a, b) => b - a);\r\n                for (let id in items) {\r\n                    found[id] = {\r\n                        group_id: +items[id].group_id,\r\n                        id: items[id].id,\r\n                        price: +items[id].price,\r\n                        name: items[id].name,\r\n                        photo: items[id].type === 'vk' ? items[id].photo_50 : items[id].type === 'youtube' ? items[id].photo_default : '',\r\n                        service: items[id].type === 'vk' ? 'VK' : items[id].type === 'youtube' ? 'Youtube' : '',\r\n                        translation: true,\r\n                        time: items[id].time\r\n                    }\r\n                }\r\n                dispatch({ type: FOUND_CHANNELS, payload: { found, found_index } });\r\n            }\r\n            return dispatch({ type: FETCH_DATA_END });\r\n        });\r\n}\r\n\r\nexport const buyStreamTime = (token, formData) => dispatch => {\r\n    dispatch({ type: START });\r\n    const init = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n            'Authorization': `Bearer ${token}`\r\n        },\r\n        body: qs.stringify(formData)\r\n    };\r\n    //const request = new Request(`${window.location.protocol}//${window.location.host}/api/videos`);\r\n    return fetch(`${window.location.protocol}//${window.location.host}/api/market`, init)\r\n        .then((res) => {\r\n            if (res.ok) return res.json();\r\n        })\r\n        .then(data => {\r\n            setTimeout(() => dispatch({ type: CLEAR_STATUS }), 1500);\r\n            if (data.status) {\r\n                if (data.status === 'ok') return dispatch({ type: SUCCESS });\r\n                else if (data.status === 'error') {\r\n                    return dispatch({ type: FAILURE, payload: data.message });\r\n                }\r\n            }\r\n            return dispatch({ type: FAILURE });\r\n        });\r\n}\r\n\r\n","import { SOLD_STREAMS, PURCHASED_STREAMS } from './../actions/actionTypes';\r\n\r\nexport const soldStreams = (id = 0) => (dispatch, getState) => {\r\n    const state = getState();\r\n    const owner = state.channels.owner;\r\n    let events = [];\r\n    if (id == 0) {\r\n        for (let i in owner) {\r\n            if (owner[i].time && owner[i].time.length > 0) {\r\n                events = [\r\n                    ...events,\r\n                    ...owner[i].time.map(item => {\r\n                        return {\r\n                            title: owner[i].name,\r\n                            start: new Date(item.start * 1000),\r\n                            end: new Date(item.end * 1000)\r\n                        };\r\n                    })\r\n                ];\r\n            }\r\n        }\r\n    } else if (owner[id]) {\r\n        if (owner[id].time && owner[id].time.length > 0) {\r\n            events = owner[id].time.map((item, i) => {\r\n                return {\r\n                    title: owner[id].time[i].video && owner[id].time[i].video.length > 0 ? owner[id].time[i].video.map(v => v.name).join(', ') : 'прямой эфир',\r\n                    start: new Date(item.start * 1000),\r\n                    end: new Date(item.end * 1000)\r\n                };\r\n            });\r\n        }\r\n    }\r\n    return dispatch({ type: SOLD_STREAMS, payload: events });\r\n}\r\n\r\nexport const purchasedStreams = (id = 0) => (dispatch, getState) => {\r\n    const state = getState();\r\n    const purchased = state.channels.purchased;\r\n    let events = [];\r\n    if (id == 0) {\r\n        for (let i in purchased) {\r\n            if (purchased[i].time && purchased[i].time.length > 0) {\r\n                events = [\r\n                    ...events,\r\n                    ...purchased[i].time.map(item => {\r\n                        return {\r\n                            title: purchased[i].name,\r\n                            start: new Date(item.start * 1000),\r\n                            end: new Date(item.end * 1000)\r\n                        };\r\n                    })\r\n                ];\r\n            }\r\n        }\r\n    } else if (purchased[id]) {\r\n        if (purchased[id].time && purchased[id].time.length > 0) {\r\n            events = purchased[id].time.map((item, i) => {\r\n                return {\r\n                    title: purchased[id].time[i].video && purchased[id].time[i].video.length > 0 ? purchased[id].time[i].video.map(v => v.name).join(', ') : 'прямой эфир',\r\n                    start: new Date(item.start * 1000),\r\n                    end: new Date(item.end * 1000)\r\n                };\r\n            });\r\n        }\r\n    }\r\n    return dispatch({ type: PURCHASED_STREAMS, payload: events });\r\n}\r\n","import Cookies from 'js-cookie';\r\nimport qs from 'querystring';\r\nimport {\r\n  FETCH_DATA_START,\r\n  FETCH_DATA_END,\r\n  TARIFF,\r\n  POPUP_MESSAGE,\r\n  POPUP_SUCCESS,\r\n  BALANCE\r\n} from './../actions/actionTypes';\r\n\r\nexport const tariffState = data => dispatch => dispatch({ type: TARIFF, payload: data });\r\n\r\nexport const getTariff = () => (dispatch, getState) => {\r\n  let status = false;\r\n  if (getState().app.updating === 0) dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(false));\r\n  }\r\n  const init = {\r\n    method: 'GET',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`\r\n    }\r\n  };\r\n  const url = `${window.location.protocol}//${window.location.host}/api/tariffs?${qs.stringify({ token })}`;\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return { status: false };\r\n    })\r\n    .then(data => {\r\n      if (data.status === 'ok') {\r\n        const tariff = data.tariff;\r\n        const balance = data.balance;\r\n        dispatch({ type: TARIFF, payload: { tariff } });\r\n        dispatch({ type: BALANCE, payload: { balance } });\r\n        status = true;\r\n      }\r\n      if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const changeTariff = amount => (dispatch, getState) => {\r\n  let status = false;\r\n  if (getState().app.updating === 0) dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(false));\r\n  }\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`\r\n    },\r\n    body: JSON.stringify({ token, amount })\r\n  };\r\n  const url = `${window.location.protocol}//${window.location.host}/api/tariffs`;\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return { data: { status: false } };\r\n    })\r\n    .then(data => {\r\n      if (data.status === 'ok') {\r\n        const tariff = data.tariff;\r\n        const balance = data.balance;\r\n        dispatch({ type: TARIFF, payload: { tariff } });\r\n        dispatch({ type: BALANCE, payload: { balance } });\r\n        dispatch({ type: POPUP_MESSAGE, payload: {message: 'Тариф успешно изменен!'} });\r\n        status = true;\r\n      } else if (data.message) {\r\n        dispatch({ type: POPUP_MESSAGE, payload: { message: data.message } });\r\n      }\r\n      if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const prolongTariff = () => (dispatch, getState) => {\r\n  let status = false;\r\n  if (getState().app.updating === 0) dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(false));\r\n  }\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`\r\n    },\r\n    body: JSON.stringify({ token, action: 'prolong' })\r\n  };\r\n  const url = `${window.location.protocol}//${window.location.host}/api/tariffs`;\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return { data: { status: false } };\r\n    })\r\n    .then(data => {\r\n      if (data.status === 'ok') {\r\n        const tariff = data.tariff;\r\n        const balance = data.balance;\r\n        dispatch({ type: TARIFF, payload: { tariff } });\r\n        dispatch({ type: BALANCE, payload: { balance } });\r\n        dispatch({ type: POPUP_SUCCESS });\r\n        status = true;\r\n      } else if (data.message) {\r\n        dispatch({ type: POPUP_MESSAGE, payload: { message: data.message } });\r\n      }\r\n      if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n","import Cookies from 'js-cookie';\r\nimport { FETCH_DATA_START, FETCH_DATA_END, VIDEOS, EDIT_VIDEO, SELECT_VIDEO, START, SUCCESS, FAILURE, CLEAR_STATUS, SET_POPUP } from './../actions/actionTypes';\r\nimport { authRequest } from '../utils/requests';\r\nimport qs from 'querystring';\r\n\r\nexport const getVideos = () => (dispatch, getState) => {\r\n  let status = false;\r\n  if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n    return status;\r\n  }\r\n  return authRequest({\r\n    method: 'GET',\r\n    url: `${window.location.protocol}//${window.location.host}/api/videos`,\r\n    token: token,\r\n    body: { token: token }\r\n  }).then(data => {\r\n    if (data.items) {\r\n      const video = data.items;\r\n      const video_index = Object.keys(video).sort((a, b) => b - a);\r\n      dispatch({ type: VIDEOS, payload: { video, video_index } });\r\n      status = true;\r\n    }\r\n    if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n    return status;\r\n  });\r\n};\r\n\r\nexport const addVideo = (token, formData) => dispatch => {\r\n  dispatch({ type: FETCH_DATA_START });\r\n  const headers = {\r\n    'Content-Type': 'multipart/form-data',\r\n    'Authorization': `Bearer ${token}`\r\n  };\r\n  const init = {\r\n    method: 'POST',\r\n    //headers,\r\n    body: formData\r\n  };\r\n  return fetch(`${window.location.protocol}//${window.location.host}/api/videos`, init)\r\n    .then((res) => {\r\n      if (res.ok) return res.json();\r\n    })\r\n    .then(data => {\r\n      if (data.items) {\r\n        const video = data.items;\r\n        const video_index = Object.keys(video).sort((a, b) => b - a);\r\n        dispatch({ type: VIDEOS, payload: { video, video_index } });\r\n      }\r\n      return dispatch({ type: FETCH_DATA_END });\r\n    });\r\n};\r\n\r\nexport const editVideo = id => dispatch => {\r\n  dispatch({ type: EDIT_VIDEO, payload: id });\r\n  dispatch({ type: SET_POPUP, payload: { popout: 'formEditVideo' } });\r\n};\r\n\r\nexport const editVideoApi = formData => (dispatch, getState) => {\r\n  dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) return dispatch({ type: FETCH_DATA_END });\r\n  const data = formData;\r\n  data.token = token;\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/x-www-form-urlencoded',\r\n      'Authorization': `Bearer ${token}`\r\n    },\r\n    body: qs.stringify(data)\r\n  };\r\n  return fetch(`${window.location.protocol}//${window.location.host}/api/videos`, init)\r\n    .then((res) => {\r\n      if (res.ok) return res.json();\r\n    })\r\n    .then(data => {\r\n      if (data.items) {\r\n        const video = data.items;\r\n        const video_index = Object.keys(video).sort((a, b) => b - a);\r\n        dispatch({ type: VIDEOS, payload: { video, video_index } });\r\n      }\r\n      return dispatch({ type: FETCH_DATA_END });\r\n    });\r\n};\r\n\r\nexport const deleteVideo = id => (dispatch, getState) => {\r\n  dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) return dispatch({ type: FETCH_DATA_END });\r\n  return authRequest({\r\n    method: 'GET', //change to POST\r\n    url: `${window.location.protocol}//${window.location.host}/api/videos`,\r\n    token,\r\n    body: { token, id, action: 'delete' }\r\n  }).then(data => {\r\n    if (data.items) {\r\n      const video = data.items;\r\n      const video_index = Object.keys(video).sort((a, b) => b - a);\r\n      dispatch({ type: VIDEOS, payload: { video, video_index } });\r\n    }\r\n    return dispatch({ type: FETCH_DATA_END });\r\n  });\r\n};\r\n\r\nexport const selectVideo = id => (dispatch, getState) => {\r\n  dispatch({ type: FETCH_DATA_START });\r\n  let { video, selectedVideos } = getState().videos;\r\n  video[id].checked = !getState().videos.video[id].checked;\r\n  const ind = selectedVideos.indexOf(id);\r\n  if (video[id].checked) {\r\n    if (ind === -1) {\r\n      selectedVideos.push(id);\r\n    }\r\n  } else {\r\n    if (ind !== -1) {\r\n      selectedVideos = [\r\n        ...selectedVideos.slice(0, ind),\r\n        ...selectedVideos.slice(ind + 1)\r\n      ];\r\n    }\r\n  }\r\n  selectedVideos.sort((a, b) => a - b);\r\n  setTimeout(() => dispatch({ type: FETCH_DATA_END }), 0);\r\n  return dispatch({ type: SELECT_VIDEO, payload: { video, selectedVideos } });\r\n};\r\n\r\nexport const setVideos2Streams = (token, formData) => dispatch => {\r\n  dispatch({ type: START });\r\n  const url = `${window.location.protocol}//${window.location.host}/api/videos`;\r\n  const init = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`,\r\n      'Content-Type': 'application/x-www-form-urlencoded'\r\n    },\r\n    body: qs.stringify(formData)\r\n  };\r\n  return fetch(url, init)\r\n    .then((res) => {\r\n      if (res.ok) return res.json();\r\n    })\r\n    .then(data => {\r\n      setTimeout(() => dispatch({ type: CLEAR_STATUS }), 1500)\r\n      if (data.status && data.status == 'ok') return dispatch({ type: SUCCESS });\r\n      return dispatch({ type: FAILURE });\r\n    });\r\n};\r\n","import React, { Component, Fragment } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { FixedLayout, HorizontalScroll, PanelHeader, Tabs, TabsItem, Epic, Tabbar, TabbarItem, View, Panel } from '@vkontakte/vkui';\r\nimport { setActiveTab } from './../actions';\r\nimport Icon24Reorder from '@vkontakte/icons/dist/24/reorder';\r\nimport Icon24Similar from '@vkontakte/icons/dist/24/similar';\r\nimport Icon24User from '@vkontakte/icons/dist/24/user';\r\nimport Icon24Users from '@vkontakte/icons/dist/24/users';\r\nimport Icon24Coins from '@vkontakte/icons/dist/24/coins';\r\n\r\nclass PageHeader extends Component {\r\n\r\n    render() {\r\n        let menuType;\r\n\r\n        if (this.props.isMobile) {\r\n            menuType = <Epic activeStory={this.props.activeTab} tabbar={\r\n                <Tabbar>\r\n                  <TabbarItem\r\n                    onClick={() => this.props.setActiveTab('translations')}\r\n                    selected={this.props.activeTab === 'translations'}\r\n                    text=\"Трансляции\"\r\n                  ><Icon24Similar /></TabbarItem>\r\n                  <TabbarItem\r\n                    onClick={() => this.props.setActiveTab('partner')}\r\n                    selected={this.props.activeTab === 'partner'}\r\n                    text=\"Партнерам\"\r\n                  ><Icon24Users /></TabbarItem>\r\n                  <TabbarItem\r\n                    onClick={() => this.props.setActiveTab('balance')}\r\n                    selected={this.props.activeTab === 'balance'}\r\n                    text=\"Баланс\"\r\n                  ><Icon24Coins /></TabbarItem>\r\n                  {/*\r\n                  <TabbarItem\r\n                    onClick={() => this.props.setActiveTab('account')}\r\n                    selected={this.props.activeTab === 'account'}\r\n                    text=\"Аккаунт\"\r\n                  ><Icon24User /></TabbarItem>\r\n                  */}\r\n                  <TabbarItem\r\n                    onClick={() => this.props.setActiveTab('menu')}\r\n                    selected={this.props.activeTab === 'menu'}\r\n                    text=\"Меню\"\r\n                  ><Icon24Reorder /></TabbarItem>\r\n                </Tabbar>\r\n              }>\r\n            </Epic>\r\n        } else {\r\n            menuType = <FixedLayout vertical=\"top\">\r\n                <Tabs theme=\"header\" type=\"buttons\">\r\n                    <HorizontalScroll>\r\n                        <TabsItem\r\n                            onClick={() => this.props.setActiveTab('translations')}\r\n                            selected={this.props.activeTab === 'translations'}\r\n                        >Трансляции</TabsItem>\r\n                        {/* <TabsItem\r\n                            onClick={() => this.props.setActiveTab('video')}\r\n                            selected={this.props.activeTab === 'video'}\r\n                        >Видео</TabsItem>\r\n                        <TabsItem\r\n                            onClick={() => this.props.setActiveTab('market')}\r\n                            selected={this.props.activeTab === 'market'}\r\n                        >Биржа</TabsItem>\r\n                        <TabsItem\r\n                            onClick={() => this.props.setActiveTab('schedule')}\r\n                            selected={this.props.activeTab === 'schedule'}\r\n                        >Расписание</TabsItem> */}\r\n                        <TabsItem\r\n                            onClick={() => this.props.setActiveTab('partner')}\r\n                            selected={this.props.activeTab === 'partner'}\r\n                        >Партнерская программа</TabsItem>\r\n                        <TabsItem\r\n                            onClick={() => this.props.setActiveTab('balance')}\r\n                            selected={this.props.activeTab === 'balance'}\r\n                        >Баланс</TabsItem>\r\n                        <TabsItem\r\n                            onClick={() => this.props.setActiveTab('account')}\r\n                            selected={this.props.activeTab === 'account'}\r\n                        >Аккаунт</TabsItem>\r\n                    </HorizontalScroll>\r\n                </Tabs>\r\n            </FixedLayout>\r\n        }\r\n\r\n        return <Fragment>\r\n            <PanelHeader noShadow>\r\n                StreamVi\r\n\t\t\t</PanelHeader>\r\n            { menuType }\r\n        </Fragment>;\r\n    }\r\n}\r\nconst mapStateToProps = state => {\r\n    return {\r\n        activeTab: state.app.activeTab,\r\n        isMobile: state.app.isMobile\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n    setActiveTab\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PageHeader);","// const config = {\r\n//     redirectUri: `${window.location.protocol}//${window.location.host}/api/googleoauth`,\r\n//     accessTokenUri: 'https://streamvi.ru/api/auth?gettoken=',\r\n//     width: 650,\r\n//     height: 430\r\n// };\r\n\r\nexport const OAuth = ({ channelId, getChannel }) => {\r\n    const popup = openBlankPopup(channelId);\r\n    return pollPopup({ popup, getChannel })\r\n        .then(closePopup);\r\n};\r\n\r\n\r\nconst openBlankPopup = (channel) => {\r\n\r\n    const options = {\r\n        top: window.screenY + ((window.outerHeight - 400) / 2.5),\r\n        left: window.screenX + ((window.outerWidth - 500) / 2)\r\n    };\r\n    const popupPathname = channel === '' ? '/api/googleoauth' : '/api/googleoauth?channel=' + channel;\r\n    const popup = window.open(`${window.location.protocol}//streamvi.ru${popupPathname}`, '_blank', 'menubar=no,toolbar=no,status=no,width=500,height=400,top=' + options.top + ',left=' + options.left);\r\n    return popup;\r\n}\r\n\r\n\r\nconst pollPopup = ({ popup, getChannel }) => {\r\n    return new Promise((resolve, reject) => {\r\n\r\n        const polling = setInterval(() => {\r\n            if (!popup || popup.closed) {\r\n                clearInterval(polling);\r\n            }\r\n            try {\r\n                const popupUrlPath = popup.location.pathname;\r\n                if (popupUrlPath === '/success.html') {\r\n                    resolve({ popup, getChannel, interval: polling });\r\n                }\r\n            } catch (error) {\r\n                // Ignore DOMException: Blocked a frame with origin from accessing a cross-origin frame.\r\n                // A hack to get around same-origin security policy errors in Internet Explorer.\r\n            }\r\n        }, 500);\r\n    });\r\n}\r\n\r\nconst closePopup = ({ popup, getChannel, interval }) => {\r\n    getChannel();\r\n    clearInterval(interval);\r\n    popup.close();\r\n}\r\n\r\n\r\n","\nconst servicePath = {\n    fb: 'fb',\n    twitch: 'twitch',\n    youtube: 'googleoauth'\n};\n\nexport const OAuth2 = channelType => {\n    const popup = openBlankPopup(channelType);\n    return pollPopup(popup)\n        .then(closePopup);\n};\n\n\nconst openBlankPopup = channelType => {\n\n    const options = {\n        top: window.screenY + ((window.outerHeight - 400) / 2.5),\n        left: window.screenX + ((window.outerWidth - 500) / 2)\n    };\n    const popupPathname = `/api/${servicePath[channelType]}`;\n    const popup = window.open(\n        // `${window.location.protocol}//${window.location.host}${popupPathname}`,\n        `${window.location.protocol}//streamvi.ru${popupPathname}`,\n        '_blank',\n        'menubar=no,toolbar=no,status=no,width=500,height=400,top=' + options.top + ',left=' + options.left);\n    return popup;\n}\n\n\nconst pollPopup = popup => {\n    return new Promise(resolve => {\n\n        const polling = setInterval(() => {\n            if (!popup || popup.closed) {\n                clearInterval(polling);\n            }\n            try {\n                const popupUrlPath = popup.location.pathname;\n                if (popupUrlPath === '/success.html') {\n                    resolve({popup, interval: polling});\n                }\n            } catch (error) {\n                // Ignore DOMException: Blocked a frame with origin from accessing a cross-origin frame.\n                // A hack to get around same-origin security policy errors in Internet Explorer.\n            }\n        }, 100);\n    });\n}\n\nconst closePopup = ({popup, interval}) => {\n    if(popup && interval){\n        clearInterval(interval);\n        popup.close();\n        return true;\n    }\n}\n\n\n","import Popup from './Popup';\r\n\r\nexport default Popup;\r\n","import React from 'react';\r\nimport { Button, Div, FormLayout, PopoutWrapper } from '@vkontakte/vkui';\r\n\r\n\r\nconst Popup = (msg, confirm, dismiss) => <PopoutWrapper>\r\n  <FormLayout\r\n    onSubmit={e => e.preventDefault()}\r\n    className=\"popup\">\r\n    <Div style={{ textAlign: 'center' }}>{msg}</Div>\r\n    <Div style={{ display: 'flex' }}>\r\n      <Button size=\"l\" stretched style={{ marginRight: 8 }} onClick={confirm}>Ок</Button>\r\n      <Button size=\"l\" stretched level=\"secondary\" onClick={dismiss}>Отмена</Button>\r\n    </Div>\r\n  </FormLayout>\r\n</PopoutWrapper>;\r\n\r\nexport default Popup;\r\n","import React, { Component, Fragment } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Avatar, Button, Cell, Checkbox, Div, FormLayout, FormLayoutGroup, Input, List, Switch } from '@vkontakte/vkui';\r\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\r\nimport Icon24Delete from '@vkontakte/icons/dist/24/delete';\r\nimport { MuiPickersUtilsProvider, DateTimePicker } from 'material-ui-pickers';\r\nimport DateFnsUtils from \"@date-io/date-fns\";\r\nimport { getTime, getUnixTime, format } from 'date-fns';\r\nimport ruLocale from \"date-fns/locale/ru\";\r\nimport url from 'url';\r\nimport {   addUser, appState, channelState, enableBroadcast, getUserChannels, removeUser, saveChanges, setActiveTab, setPopup } from '../../actions';\r\n\r\nclass Channel extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.timeNow = new Date();\r\n    this.state = {\r\n      isValidRtmpUrl: 'default',\r\n      isValidRtmpKey: 'default',\r\n      rtmp: props.data && props.data.rtmp ? props.data.rtmp : false,\r\n      show: true,\r\n      sell: props.data && props.data.sell ? props.data.sell : null,\r\n      enabledForMe: props.data && props.data.active ? !!props.data.active : null,\r\n      price:  props.data && props.data.price ? props.data.price : null,\r\n      editAccess: false,\r\n      users: {},\r\n      error: {},\r\n      disabled: false,\r\n      vk_id: '',\r\n      unlim: true,\r\n      minutesStep: 15,\r\n      timeStart: this.timeNow,\r\n      timeEnd: this.timeNow,\r\n      access: false,\r\n      isValidLink: 'default',\r\n      customChannelName: props.data && props.data.name ? this.props.data.name : ''\r\n    }\r\n  }\r\n\r\n  showInfo = () => {\r\n    this.props.updateData(this.props.id);\r\n    this.setState({\r\n      show: !this.state.show\r\n    })\r\n  };\r\n\r\n  componentWillMount() {\r\n    if (!this.props.data) {\r\n      this.props.setActiveTab('translations');\r\n    }\r\n  }\r\n\r\n  changePrice = e => {\r\n    this.setState({ price: e.target.value, disabled: false });\r\n  };\r\n\r\n  rtmpUrl = e => {\r\n    // {\r\n    //     \"name\": \"2IDB6WpAf3Y\",\r\n    //     \"domain\": \"stream3.vkuserlive.com\",\r\n    //     \"port\": 443,\r\n    //     \"query\": \"/live?srv=500727&s=aWQ9MklEQjZXcEFmM1kmc2lnbj1aa1o2a0RVMnlWczFWQ09RUG5DaW5RPT0=\"\r\n    // }\r\n    // hostname: \"stream2.vkuserlive.com\"\r\n    // href: \"rtmp://stream2.vkuserlive.com:443/live?srv=501713&s=aWQ9elFreVliVk5rMk0mc2lnbj1UZFdkK0tzYlJGSDA0a1VGeGpxQWZRPT0=\"\r\n    // path: \"/live?srv=501713&s=aWQ9elFreVliVk5rMk0mc2lnbj1UZFdkK0tzYlJGSDA0a1VGeGpxQWZRPT0=\"\r\n    // pathname: \"/live\"\r\n    // port: \"443\"\r\n    // protocol: \"rtmp:\"\r\n    // query: \"srv=501713&s=aWQ9elFreVliVk5rMk0mc2lnbj1UZFdkK0tzYlJGSDA0a1VGeGpxQWZRPT0=\"\r\n    // search: \"?srv=501713&s=aWQ9elFreVliVk5rMk0mc2lnbj1UZFdkK0tzYlJGSDA0a1VGeGpxQWZRPT0=\"\r\n    // slashes: true\r\n\r\n    const rtmpUrl = url.parse(e.target.value);\r\n    // if (rtmpUrl.hostname && rtmpUrl.port && rtmpUrl.path && rtmpUrl.protocol) {\r\n    if (rtmpUrl.hostname && rtmpUrl.path && rtmpUrl.protocol) {\r\n      const rtmp = {\r\n        ...this.state.rtmp,\r\n        domain: rtmpUrl.hostname,\r\n        query: rtmpUrl.path\r\n      };\r\n      if (rtmpUrl.port) {\r\n        rtmp.port = rtmpUrl.port;\r\n      }\r\n      // if (this.state.error && this.state.error.url) {\r\n      //   const error = this.state.error;\r\n      //   delete error.url;\r\n      //   this.setState({ error });\r\n      // }\r\n      this.setState({\r\n        rtmp,\r\n        isValidRtmpUrl: 'valid'\r\n      });\r\n    } else {\r\n      this.setState({\r\n        isValidRtmpUrl: 'error',\r\n        // error: {\r\n        //   ...this.state.error,\r\n        //   url: 'некорректный адрес rtmp-сервера'\r\n        // }\r\n      });\r\n    }\r\n  };\r\n\r\n  rtmpKey = e => {\r\n    if (e.target.value.trim() !== '') {\r\n      const rtmp = {\r\n        ...this.state.rtmp,\r\n        name: e.target.value\r\n      };\r\n      // if (this.state.error && this.state.error.key) {\r\n      //   const error = this.state.error;\r\n      //   delete error.key;\r\n      //   this.setState({ error });\r\n      // }\r\n      this.setState({\r\n        rtmp,\r\n        isValidRtmpKey: 'valid'\r\n      });\r\n    } else {\r\n      this.setState({\r\n        isValidRtmpKey: 'error',\r\n        // error: {\r\n        //   ...this.state.error,\r\n        //   key: 'укажите ключ в поле KEY'\r\n        // }\r\n      });\r\n    }\r\n  };\r\n\r\n  saveChanges = () => {\r\n    if (this.props.id) {\r\n      const formData = {\r\n        group_id: this.props.id,\r\n        price: this.state.price ? this.state.price : 0,\r\n        sell: this.state.sell ? 1 : 0,\r\n        action: 'update'\r\n      };\r\n      if (this.state.rtmp) formData.rtmp = JSON.stringify(this.state.rtmp);\r\n      if (this.props.data.name !== this.state.customChannelName) {\r\n        formData.name = this.state.customChannelName;\r\n      }\r\n      this.setState({ disabled: true });\r\n      this.props.saveChanges(formData)\r\n        .then(({ type }) => {\r\n          if (type === 'POPUP_SUCCESS') {\r\n            this.props.getUserChannels();\r\n            //this.props.setPopup('success');\r\n          } //else this.props.setPopup('failure');\r\n        });\r\n    }\r\n  };\r\n\r\n  enableBroadcast = e => {\r\n\r\n    e.stopPropagation();\r\n\r\n    const { type, rtmp, active } = this.props.data;\r\n\r\n    if (this.props.id && ((this.props.numActiveChannels < this.props.tariff.amount && +active === 0) || +active === 1)) {\r\n      if (type && (type === 'vk' || type === 'custom') && !rtmp) {\r\n        if (this.props.type && this.props.type === 'owner') this.props.rtmpError('owner');\r\n        if (this.props.type && this.props.type === 'shared') this.props.rtmpError('shared');\r\n      } else {\r\n        const formData = {\r\n          group_id: this.props.id,\r\n          broadcast: +!active,\r\n          owner: this.props.type\r\n        };\r\n        this.props.enableBroadcast(formData)\r\n          .then(status => {\r\n            // if (status) this.setState({ enabledForMe: !!this.props.data.active });\r\n            // if (status) this.setState({ enabledForMe: !this.state.enabledForMe });\r\n          });\r\n      }\r\n    } else if(this.props.numActiveChannels >= this.props.tariff.amount && +active === 0) {\r\n      this.props.paymentPopup();\r\n      // this.props.appState({\r\n      //   popup: {\r\n      //     msg: 'Достигнут лимит количества активных каналов на оплаченном тарифе!',\r\n      //     type: false\r\n      //   }\r\n      // });\r\n      this.props.appState({ popout: 'confirm' });\r\n    }\r\n  };\r\n\r\n  deleteChannel = () => {\r\n    if (this.props.id && this.props.token) {\r\n      this.props.deleteChannel(this.props.token, this.props.id)\r\n        .then(({ type }) => {\r\n          if (type === 'SUCCESS') this.props.getUserChannels();\r\n        });\r\n    }\r\n    this.setState({\r\n      show: !this.state.show\r\n    })\r\n  };\r\n\r\n  // editAccess = () => {\r\n  //   this.setState({\r\n  //     editAccess: !this.state.editAccess\r\n  //   })\r\n  // };\r\n  //\r\n  // backClick = () => {\r\n  //   this.setState({\r\n  //     editAccess: !this.state.editAccess\r\n  //   })\r\n  // };\r\n\r\n  changeTimeStart = time => {\r\n    if (getTime(this.state.timeEnd) <= getTime(time)) this.setState({ timeEnd: new Date(time.getTime() + 3600000) });\r\n    this.setState({\r\n      timeStart: time,\r\n      access: false\r\n    });\r\n  };\r\n\r\n  changeTimeEnd = time => {\r\n    if (getTime(this.state.timeStart) >= getTime(time)) this.setState({ timeStart: new Date(time.getTime() - 3600000) });\r\n    this.setState({\r\n      timeEnd: time,\r\n      access: false\r\n    });\r\n  };\r\n\r\n  addUser = () => {\r\n    const formData = {\r\n      access: 'add'\r\n    };\r\n    if (this.props.id && this.state.vk_id) {\r\n      const urlParts = url.parse(this.state.vk_id).pathname.split('/');\r\n      formData.group_id = this.props.id;\r\n      formData.vk_id = urlParts.length === 1 ? urlParts[0] : urlParts[1];\r\n      if (!this.state.unlim && this.state.timeEnd > this.state.timeStart) {\r\n        formData.time_start = getUnixTime(this.state.timeStart);\r\n        formData.time_end = getUnixTime(this.state.timeEnd);\r\n      }\r\n      this.setState({ access: true });\r\n      this.props.addUser(formData)\r\n        .then(status => {\r\n          if (status) this.setState({\r\n            access: false,\r\n            vk_id: ''\r\n          });\r\n        });\r\n    }\r\n  };\r\n\r\n  render() {\r\n\r\n    const channel = this.props.data || {};\r\n    let rtmpUrl = false;\r\n    let rtmpKey = false;\r\n    if (channel.rtmp) {\r\n      const rtmp = channel.rtmp;\r\n      if (rtmp.domain) {\r\n        rtmpUrl = `rtmp://${rtmp.domain}${rtmp.port ? ':' + rtmp.port : ''}${rtmp.query}`;\r\n      }\r\n      if (rtmp.name) rtmpKey = rtmp.name;\r\n    }\r\n    const { timeStart, timeEnd, minutesStep, customChannelName } = this.state;\r\n    const { activeTab, setActiveTab, appState } = this.props;\r\n\r\n    const channelStatus = <span\r\n      className={`status ${channel.live ? 'live' : 'offline'}`}\r\n      title={channel.live ? 'Идет трансляция' : 'Offline'}\r\n    />;\r\n\r\n    if (this.props.titleOnly) {\r\n      return(\r\n        <Cell\r\n          before={<Avatar size={40} src={channel.photo} />}\r\n          onClick={() => {\r\n            this.props.setActiveTab('channel-settings');\r\n            this.showInfo();\r\n          }}\r\n          size=\"l\"\r\n          bottomContent={channel.service}\r\n        >\r\n          {channelStatus} {channel.name}\r\n        </Cell>\r\n      );\r\n    } else {\r\n      return <Fragment>\r\n        {this.props.type === 'owner' || this.props.type === 'shared' ?\r\n          <List>\r\n            <div>\r\n              {/*{this.state.show && !this.state.editAccess ?*/}\r\n              {this.state.show ?\r\n                <div>\r\n                  <Cell onClick={() => { window.open(`https://vk.com/club${channel.id}`, \"_blank\") }}\r\n                    before={<Avatar size={40} src={channel.photo} />}\r\n                    size=\"l\"\r\n                    bottomContent={channel.service}\r\n                  >\r\n                    {channelStatus} {channel.name}\r\n                  </Cell>\r\n                  <Cell>\r\n                    {channel && channel.owner ?\r\n                      <FormLayout className=\"trnslatSet\">\r\n                        {/* <Checkbox\r\n                              defaultChecked={this.state.sell}\r\n                              onChange={() => this.setState({ sell: !this.state.sell, disabled: false })}\r\n                              className=\"stvi-font--small\"\r\n                          >\r\n                              Продавать время на бирже\r\n                          </Checkbox>\r\n                          <Input\r\n                              placeholder=\"Цена, руб/час\"\r\n                              value={String(this.state.price)}\r\n                              onChange={this.changePrice}\r\n                          /> */}\r\n                        {channel.type && (channel.type === 'vk' || channel.type === 'ok' || channel.type === 'custom') ?\r\n                          <div>\r\n                            <div className=\"title-wrapper\">\r\n                                <span className=\"trnslatSet-title\">Настройки трансляции</span>\r\n                                <span className=\"trnslatSet-title\"><Icon24Delete onClick={() => this.props.deleteChannel(this.props.id)}/></span>\r\n                            </div>\r\n                            <FormLayout>\r\n                              {channel.type === 'custom' || channel.type === 'ok' ?\r\n                                <Input\r\n                                  top='Название канала'\r\n                                  placeholder='Название'\r\n                                  onChange={e => this.setState({\r\n                                    customChannelName: e.target.value,\r\n                                    disabled: false\r\n                                  })}\r\n                                  defaultValue={customChannelName}\r\n                                />\r\n                                : null}\r\n                              <Input\r\n                                top='Адрес сервера'\r\n                                placeholder=\"RTMP URL\"\r\n                                defaultValue={rtmpUrl ? rtmpUrl : null}\r\n                                onChange={this.rtmpUrl}\r\n                                status={this.state.isValidRtmpUrl}\r\n                                bottom={this.state.isValidRtmpUrl === 'error' ? 'Некорректный адрес rtmp-сервера' : null}\r\n                                type='text'\r\n                              />\r\n                              <Input\r\n                                top='Ключ трансляции'\r\n                                placeholder=\"RTMP KEY\"\r\n                                onChange={this.rtmpKey}\r\n                                defaultValue={rtmpKey ? rtmpKey : null}\r\n                                status={this.state.isValidRtmpKey}\r\n                                bottom={this.state.isValidRtmpKey === 'error' ? 'Укажите ключ трансляции' : null}\r\n                                type='text'\r\n                              />\r\n                            </FormLayout>\r\n                            {/*<FormLayout>*/}\r\n                            {/*  <FormLayoutGroup*/}\r\n                            {/*    // bottom={this.state.error ?*/}\r\n                            {/*    //   Object.keys(this.state.error)*/}\r\n                            {/*    //     .map((key, i) => <div key={i}><small style={{ color: 'red' }}>*/}\r\n                            {/*    //       {this.state.error[key]}*/}\r\n                            {/*    //     </small></div>)*/}\r\n                            {/*    //   : null}*/}\r\n                            {/*  >*/}\r\n                            {/*    {channel.type === 'custom' || channel.type === 'ok' ?*/}\r\n                            {/*      <Input*/}\r\n                            {/*        placeholder='Название'*/}\r\n                            {/*        onChange={e => this.setState({*/}\r\n                            {/*          customChannelName: e.target.value,*/}\r\n                            {/*          disabled: false*/}\r\n                            {/*        })}*/}\r\n                            {/*        defaultValue={customChannelName}*/}\r\n                            {/*      />*/}\r\n                            {/*      : null}*/}\r\n                            {/*    <Input*/}\r\n                            {/*      top='Адрес сервера'*/}\r\n                            {/*      placeholder=\"RTMP URL\"*/}\r\n                            {/*      defaultValue={rtmpUrl ? rtmpUrl : null}*/}\r\n                            {/*      onChange={this.rtmpUrl}*/}\r\n                            {/*      status={this.state.isValidRtmpUrl}*/}\r\n                            {/*      bottom={this.state.isValidRtmpUrl === 'error' ? 'Некорректный адрес rtmp-сервера' : null}*/}\r\n                            {/*      type='text'*/}\r\n                            {/*    />*/}\r\n                            {/*    <Input*/}\r\n                            {/*      placeholder=\"RTMP KEY\"*/}\r\n                            {/*      onChange={this.rtmpKey}*/}\r\n                            {/*      defaultValue={rtmpKey ? rtmpKey : null}*/}\r\n                            {/*      status={this.state.isValidRtmpKey}*/}\r\n                            {/*      bottom={this.state.isValidRtmpKey === 'error' ? 'Укажите ключ трансляции' : null}*/}\r\n                            {/*      type='text'*/}\r\n                            {/*    />*/}\r\n\r\n                            {/*  </FormLayoutGroup>*/}\r\n                            {/*</FormLayout>*/}\r\n                          </div>\r\n                          : null}\r\n                        {/*<Button\r\n                              level=\"outline\"\r\n                              onClick={() => {\r\n                                if(!this.props.tariff){\r\n                                  appState({ popout: 'popup', popup: {msg: 'Невозможно на бесплатном тарифе', type: false}});\r\n                                } else {\r\n                                  this.editAccess();\r\n                                }\r\n                              }}\r\n                            >Настроить доступ</Button>*/}\r\n                        {this.props.process}\r\n                        <Div style={{ display: 'flex', justifyContent: 'center', paddingTop: '0px' }}>\r\n                          <Button\r\n                            size=\"l\"\r\n                            stretched\r\n                            style={{ maxWidth: '200px', paddingTop: '0px' }}\r\n                            onClick={this.saveChanges}\r\n                            disabled={this.state.disabled || this.state.isValidRtmpUrl !== 'valid' || this.state.isValidRtmpKey !== 'valid'}\r\n                            className=\"stvi-btn-main\"\r\n                          >\r\n                            Сохранить\r\n                          </Button>\r\n                          {/**\r\n                            <Button\r\n                              size=\"l\"\r\n                              stretched\r\n                              style={{ background: 'rgb(217, 83, 79)' }}\r\n                              onClick={() => this.props.deleteChannel(this.props.id)}\r\n                              className=\"stvi-btn-main\"\r\n                            >\r\n                              Отключить\r\n                            </Button>\r\n                          **/}\r\n                        </Div>\r\n                      </FormLayout>\r\n                      : channel.sharedTime ?\r\n                        <Fragment>\r\n                          <span style={{ display: 'block', color: 'green' }}>Доступное время:</span>\r\n                          {channel.sharedTime.unlim ?\r\n                            <span style={{ display: 'block', color: 'green' }}>неограниченно</span>\r\n                            :\r\n                            <div style={{ color: 'green' }}>\r\n                              {format(channel.sharedTime.start * 1000, 'dd.MM.yyyy HH:mm')}\r\n                              &nbsp;&nbsp;-&nbsp;&nbsp;\r\n                              {format(channel.sharedTime.end * 1000, 'dd.MM.yyyy HH:mm')}\r\n                            </div>\r\n                          }\r\n                        </Fragment>\r\n                        : null}\r\n                    <Div\r\n                      style={{ display: \"flex\", flexDirection: \"row\", alignItems: \"center\" }}\r\n                    >\r\n                      <Switch\r\n                        checked={!!channel.active}\r\n                        onChange={this.enableBroadcast}\r\n                      />\r\n                      <span style={{ marginLeft: \"15px\" }}>Транслировать</span>\r\n                    </Div>\r\n                  </Cell>\r\n                </div> : null}\r\n            </div>\r\n\r\n            {this.props.tariff ?\r\n              <div>\r\n                <Cell multiline>\r\n                  <Div className=\"translation__item-header\">\r\n                    <span>Выдача доступа</span>\r\n                    {/*<Button onClick={this.backClick} level=\"tertiary\"><Icon24Cancel /></Button>*/}\r\n                  </Div>\r\n                  <FormLayout>\r\n                    <Input\r\n                      onChange={e => {\r\n                        const isValidLink = e.target.value.search(/https:\\/\\/vk\\.com\\/[_\\-\\d\\w]+/i) !== -1 ? 'valid' : 'error';\r\n                        this.setState({ vk_id: e.target.value, access: false, isValidLink })\r\n                      }}\r\n                      type=\"text\"\r\n                      placeholder=\"Ссылка на профиль Вконтакте\"\r\n                      value={this.state.vk_id ? this.state.vk_id : ''}\r\n                      status={this.state.isValidLink}\r\n                      bottom={this.state.isValidLink === 'error' ? 'Некорректный адрес профиля' : null}\r\n                    />\r\n                    <Checkbox\r\n                      defaultChecked={!this.state.unlim}\r\n                      onChange={() => this.setState({ unlim: !this.state.unlim })}\r\n                    >Время</Checkbox>\r\n                    {this.state.unlim ? null : <div className=\"date-time\">\r\n                      <MuiPickersUtilsProvider utils={DateFnsUtils} locale={ruLocale}>\r\n                        <DateTimePicker\r\n                          keyboard\r\n                          ampm={false}\r\n                          label=\"от\"\r\n                          onError={console.log}\r\n                          minDate={this.timeNow}\r\n                          value={timeStart}\r\n                          onChange={this.changeTimeStart}\r\n                          format={'dd.MM.yyyy HH:mm'}\r\n                          disableOpenOnEnter\r\n                          mask={[/\\d/, /\\d/, '.', /\\d/, /\\d/, '.', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, ':', /\\d/, /\\d/]}\r\n                          minutesStep={minutesStep}\r\n                          cancelLabel={'Отмена'}\r\n                        />\r\n                        <DateTimePicker\r\n                          keyboard\r\n                          ampm={false}\r\n                          label=\"до\"\r\n                          onError={console.log}\r\n                          minDate={this.timeNow}\r\n                          value={timeEnd}\r\n                          onChange={this.changeTimeEnd}\r\n                          format={'dd.MM.yyyy HH:mm'}\r\n                          disableOpenOnEnter\r\n                          mask={[/\\d/, /\\d/, '.', /\\d/, /\\d/, '.', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, ':', /\\d/, /\\d/]}\r\n                          minutesStep={minutesStep}\r\n                          cancelLabel={'Отмена'}\r\n                        />\r\n                      </MuiPickersUtilsProvider>\r\n                    </div>}\r\n                    <Button\r\n                      disabled={this.state.access || this.state.isValidLink !== 'valid'}\r\n                      onClick={ e => {\r\n                        e.preventDefault();\r\n                        this.addUser();\r\n                      }}\r\n                      level=\"outline\"\r\n                    >Добавить</Button>\r\n                  </FormLayout>\r\n                  {channel.users ? channel.users.map((user, index) => <Cell\r\n                    before={<Avatar size={40} src={user.photo} />}\r\n                    key={index}\r\n                    removable\r\n                    bottomContent={user.time_start && user.time_end ?\r\n                      format(user.time_start * 1000, 'dd.MM.yyyy HH:mm') + \" — \" + format(user.time_end * 1000, 'dd.MM.yyyy HH:mm')\r\n                      : 'время не ограничено'}\r\n                    size=\"l\"\r\n                    onRemove={() => this.props.removeUser(user.user_id, this.props.id)}>\r\n                    {user.name + \" \" + user.surname}\r\n                  </Cell>) : null}\r\n                </Cell>\r\n              </div> : null}\r\n          </List>\r\n          :\r\n          <List>\r\n            {this.state.show ?\r\n              <div>\r\n                {channel.time ?\r\n                  <Cell className=\"content\">\r\n                    {this.props.type === 'available' ?\r\n                      <span style={{ display: 'block', color: 'red' }}>Недоступное для покупки время:</span>\r\n                      :\r\n                      <span style={{ display: 'block', color: 'green' }}>Оплаченное время:</span>\r\n                    }\r\n                    {channel.time.map((item, i) => <div key={i} style={this.props.type === 'available' ? { color: 'red' } : { color: 'green' }}>\r\n                      {format(item.start * 1000, 'dd.MM.yyyy HH:mm')}\r\n                      &nbsp;&nbsp;-&nbsp;&nbsp;\r\n                      {format(item.end * 1000, 'dd.MM.yyyy HH:mm')}\r\n                    </div>)}\r\n                  </Cell>\r\n                  : null }\r\n              </div>\r\n              : null}\r\n          </List>\r\n        }\r\n      </Fragment>;\r\n    }\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    token: state.app.token,\r\n    process: state.app.process,\r\n    tariff: state.tariffs.tariff,\r\n    numActiveChannels: state.channels.numActiveChannels\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  addUser,\r\n  appState,\r\n  channelState,\r\n  enableBroadcast,\r\n  getUserChannels,\r\n  removeUser,\r\n  saveChanges,\r\n  setActiveTab,\r\n  setPopup\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Channel);\r\n","import React, { Component, Fragment } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Alert, Avatar, Button, Div, FormLayout, HeaderButton, Input, Group, Panel, PanelHeader, PopoutWrapper, ScreenSpinner, Select, View, List, Cell } from '@vkontakte/vkui';\r\nimport Icon24BrowserBack from '@vkontakte/icons/dist/24/browser_back';\r\nimport Icon24BrowserForward from '@vkontakte/icons/dist/24/browser_forward';\r\nimport { authRequest } from '../../utils/requests';\r\nimport url from 'url';\r\nimport Icon24Copy from '@vkontakte/icons/dist/24/copy';\r\nimport CopyToClipboard from 'react-copy-to-clipboard';\r\n\r\nimport PageHeader from './../../components/PageHeader';\r\nimport { appState, deleteChannel, getUserChannels, getAvailableChannels, setPopup, setActiveTab, addCustomRtmp, channelState, updateStreamKey } from '../../actions';\r\nimport { OAuth } from '../../utils/googleoauth';\r\nimport { OAuth2 } from '../../utils/authorization';\r\nimport confirmPopup from '../../components/Popup/index';\r\n\r\nimport Channel from './item';\r\n\r\nimport './main.scss'\r\n\r\nclass Translations extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      display: 'all',\r\n      channelId: false,\r\n      channelType: false,\r\n      type: {\r\n        vk: {\r\n          name: 'Вконтакте',\r\n          logo: '/app/img/logo/vk.png',\r\n          active: true\r\n        },\r\n        youtube: {\r\n          name: 'YouTube',\r\n          logo: '/app/img/logo/youtube.png',\r\n          active: true\r\n        },\r\n        fb: {\r\n          name: 'Facebook',\r\n          logo: '/app/img/logo/fb.png'\r\n        },\r\n        ok: {\r\n          name: 'Одноклассники',\r\n          logo: '/app/img/logo/ok.png'\r\n        },\r\n        twitch: {\r\n          name: 'Twitch',\r\n          logo: '/app/img/logo/twitch.png',\r\n          active: true\r\n        },\r\n        custom: {\r\n          name: 'Свой RTMP-сервер',\r\n          logo: '/app/img/logo/custom.png'\r\n        }\r\n      },\r\n      rtmpColsd: true\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.title = \"Трансляции\";\r\n    console.log('this.props.pathname', this.props.pathname);\r\n    console.log('this.state.channelId', this.state.channelId);\r\n\r\n    if (this.props.pathname) {\r\n      if (this.props.pathname === '/groups' && !this.state.channelType) {\r\n        this.props.setActiveTab('services');\r\n      }\r\n      if(this.props.pathname === '/channel-settings' && !this.state.channelId){\r\n        this.props.setActiveTab('translations');\r\n      }\r\n    }\r\n  }\r\n\r\n  updateData = value => {\r\n    this.setState({ channelId: value })\r\n  };\r\n\r\n\r\n  popout = () => {\r\n    let msg, type;\r\n    if(this.props.popup){\r\n      msg = this.props.popup.msg;\r\n      type = this.props.popup.type;\r\n    }\r\n    switch (this.props.popout) {\r\n      case 'hidden':\r\n        return null;\r\n      case 'spinner':\r\n        return <ScreenSpinner />;\r\n      case 'success':\r\n        return this.resultPopup(true);\r\n      case 'failure':\r\n        return this.resultPopup();\r\n      case 'owner':\r\n        return this.rtmpError('owner');\r\n      case 'shared':\r\n        return this.rtmpError('shared');\r\n      case 'popup':\r\n        return this.popup(msg, type);\r\n      case 'copied':\r\n        return this.copied();\r\n      case 'confirm':\r\n        return confirmPopup(\r\n          this.popupMsg,\r\n          this.confirmFn,\r\n          () => this.props.setPopup('hidden')\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  // deleteChannelPopup = (delFn) => {\r\n  //   this.delMsg = 'Действительно хотите отключить канал?';\r\n  //   this.delFn = delFn;\r\n  //   this.props.setPopup('confirm');\r\n  // };\r\n\r\n  deleteChannel = (id) => {\r\n    this.popupMsg = 'Действительно хотите отключить канал?';\r\n    this.confirmFn = () => {\r\n      return this.props.deleteChannel(this.props.token, id)\r\n        .then(({ type }) => {\r\n          if (type === 'SUCCESS') {\r\n            this.props.getUserChannels()\r\n              .then(() => {\r\n                this.props.setActiveTab('translations');\r\n                this.props.setPopup('hidden');\r\n              });\r\n          }\r\n        });\r\n    };\r\n    this.props.setPopup('confirm');\r\n  };\r\n\r\n  paymentPopup = () => {\r\n    this.popupMsg = 'Достигнут лимит количества активных каналов! Желаете изменить тариф?';\r\n    this.confirmFn = () => this.props.setActiveTab('balance', '/balance/tariff');\r\n    this.props.setPopup('confirm');\r\n  };\r\n\r\n\r\n  resultPopup = (msg = false) => {\r\n    setTimeout(() => this.props.setPopup('hidden'), 2000);\r\n    return <Alert onClose={() => this.props.setPopup('hidden')}>\r\n      <Div style={msg ? { color: 'green' } : { color: 'red' }}>\r\n        {msg ? 'Успешно!' : 'Что-то пошло не так ☹'}\r\n      </Div>\r\n    </Alert>\r\n  };\r\n\r\n  copied = () => {\r\n    setTimeout(() => this.props.setPopup('hidden'), 2000);\r\n    return <Alert onClose={() => this.props.setPopup('hidden')}>\r\n      <Div style={{ color: 'green' }}>\r\n        {'Скопировано!'}\r\n      </Div>\r\n    </Alert>\r\n  };\r\n\r\n  popup = (msg, type = true) => {\r\n    const { appState } = this.props;\r\n    setTimeout(() => appState({ popout: 'hidden' }), 2000);\r\n    return <Alert onClose={() => appState({ popout: 'hidden' })}>\r\n      <Div style={{ color: type ? 'green' : 'red', textAlign: 'center' }}>\r\n        {msg}\r\n      </Div>\r\n    </Alert>\r\n  };\r\n\r\n  rtmpError = type => {\r\n    const msg = {\r\n      owner: 'Укажите настройки rtmp-сервера!',\r\n      shared: 'Владелец канала не указал настройки rtmp-сервера, трансляция невозможна!'\r\n    };\r\n    setTimeout(() => this.props.setPopup('hidden'), 5000);\r\n    return <Alert onClose={() => this.props.setPopup('hidden')}>\r\n      <Div style={{ color: 'red' }}>\r\n        {msg[type]}\r\n      </Div>\r\n    </Alert>\r\n  };\r\n\r\n  getChannel = () => {\r\n    if (this.props.token) {\r\n      this.props.getUserChannels();\r\n        // .then(this.openChannelSetting());\r\n      this.props.getAvailableChannels();\r\n    }\r\n  };\r\n\r\n  authorize = () => {\r\n    const { channelType } = this.state;\r\n\r\n    if (channelType && channelType !== 'vk') {\r\n      OAuth2(channelType)\r\n        .then(this.getChannel);\r\n    }\r\n  };\r\n\r\n  // openChannelSetting = () => {\r\n  //   this.props.setActiveTab('channel-settings');\r\n  //   this.props.channelState({ addedChannelId: false });\r\n  //   console.log(this.props.addedChannelId);\r\n  //   if(this.props.addedChannelId){\r\n  //     this.setState(\r\n  //       { channelId: this.props.addedChannelId },\r\n  //       () => {\r\n  //         this.props.setActiveTab('channel-settings');\r\n  //         this.props.channelState({ addedChannelId: false });\r\n  //       }\r\n  //     );\r\n  //   }\r\n  // };\r\n\r\n  addUserGroup = (authorize = false) => {\r\n    if (this.props.token) {\r\n      if (this.state.channelType) {\r\n        let channelId = this.state.channelId ? this.state.channelId : '';\r\n        console.log('this.state.channelId', this.state.channelId);\r\n        if (!authorize) {\r\n          // if (!!channelId) {\r\n          //   const urlParts = url.parse(channelId).pathname.split('/');\r\n          //   channelId = urlParts.length === 1 ? urlParts[0] : urlParts[1];\r\n          // }\r\n          authRequest({\r\n            method: 'GET',//todo change to POST\r\n            url: `${window.location.protocol}//${window.location.host}/api/channel/add`,\r\n            token: this.props.token,\r\n            body: { type: this.state.channelType, channelId, token: this.props.token }//todo delete token\r\n          }).then(() => {\r\n            this.props.getUserChannels()\r\n              .then(() => {\r\n                this.props.setActiveTab('channel-settings');\r\n                this.props.channelState({ addedChannelId: false });\r\n              });\r\n          });\r\n        } else if (this.state.channelType === 'youtube') {\r\n          if (!!channelId) {\r\n            const urlParts = url.parse(channelId).pathname.split('/');\r\n            channelId = urlParts.length === 1 ? urlParts[0] : urlParts[2];\r\n          }\r\n          OAuth({ channelId, getChannel: this.getChannel });\r\n          // if (channel === '') {\r\n          // \tOAuth({ channel: '', getChannel: this.getChannel });\r\n          // } else {\r\n          // \tOAuth({ channel: url.parse(channel).pathname.substring(9), getChannel: this.getChannel });\r\n          // }\r\n        }\r\n      }\r\n      // this.setState({\r\n      //   channelId: false,\r\n      //   channelType: false\r\n      // });\r\n    }\r\n  };\r\n\r\n  displayChannels = (type = 'all') => {\r\n\r\n    switch (type) {\r\n      case 'owner':\r\n        return this.props.owner_index.length > 0 ? <Fragment>\r\n          {this.props.owner_index\r\n            .filter(id => !!this.props.owner[id].live)\r\n            .map(i => <Group\r\n            key={i}\r\n            title=''\r\n            className=\"group-block\"\r\n          >\r\n            <Channel\r\n              key={i}\r\n              id={i}\r\n              type='owner'\r\n              data={this.props.owner[i]}\r\n              rtmpError={this.props.setPopup}\r\n              updateData={this.updateData}\r\n              titleOnly\r\n            />\r\n          </Group>)}\r\n          {this.props.owner_index\r\n            .filter(id => !this.props.owner[id].live)\r\n            .map(i => <Group\r\n            key={i}\r\n            title=''\r\n            className=\"group-block\"\r\n          >\r\n            <Channel\r\n              key={i}\r\n              id={i}\r\n              type='owner'\r\n              data={this.props.owner[i]}\r\n              rtmpError={this.props.setPopup}\r\n              updateData={this.updateData}\r\n              titleOnly\r\n            />\r\n          </Group>)}\r\n        </Fragment> : <Cell>Вы не добавили ни одного канала</Cell>;\r\n      case 'shared':\r\n        return this.props.shared_index.length > 0 ? this.props.shared_index.map(i => <Group\r\n          key={i}\r\n          title=''\r\n          className=\"group-block\"\r\n        >\r\n          <Channel\r\n            key={i}\r\n            id={i}\r\n            type='shared'\r\n            data={this.props.shared[i]}\r\n            rtmpError={this.props.setPopup}\r\n            channelSettings={this.state.channelSettings}\r\n          />\r\n        </Group>) : <Cell>Похоже нет каналов с предоставленным доступом</Cell>;\r\n      case 'purchased':\r\n        return this.props.purchased_index.length > 0 ? this.props.purchased_index.map(i => <Group\r\n          key={i}\r\n          title=''\r\n          className=\"group-block\">\r\n          <Channel\r\n            key={i}\r\n            type='purchased'\r\n            data={this.props.purchased[i]}\r\n            id={i}\r\n          />\r\n        </Group>) : <Cell>Оплаченных каналов нет</Cell>;\r\n      case 'all':\r\n        return <Fragment>\r\n          {this.props.owner_index\r\n            .filter(id => this.props.owner[id].live)\r\n            .map(i => <Group\r\n              key={i}\r\n              title=''\r\n              className=\"group-block\"\r\n            >\r\n              <Channel\r\n                key={i}\r\n                id={i}\r\n                type='owner'\r\n                data={this.props.owner[i]}\r\n                rtmpError={this.props.setPopup}\r\n                updateData={this.updateData}\r\n                titleOnly\r\n              />\r\n            </Group>)}\r\n          {this.props.shared_index\r\n            .filter(id => this.props.shared[id].live)\r\n            .map(i => <Group\r\n            key={i}\r\n            title=''\r\n            className=\"group-block\">\r\n            <Channel\r\n              key={i}\r\n              id={i}\r\n              type='shared'\r\n              data={this.props.shared[i]}\r\n              rtmpError={this.props.setPopup}\r\n              channelSettings={this.state.channelSettings}\r\n            />\r\n          </Group>)}\r\n          {this.props.owner_index\r\n            .filter(id => !this.props.owner[id].live)\r\n            .map(i => <Group\r\n            key={i}\r\n            title=''\r\n            className=\"group-block\">\r\n            <Channel\r\n              key={i}\r\n              id={i}\r\n              type='owner'\r\n              data={this.props.owner[i]}\r\n              rtmpError={this.props.setPopup}\r\n              updateData={this.updateData}\r\n              titleOnly\r\n            />\r\n          </Group>)}\r\n          {this.props.shared_index\r\n            .filter(id => !this.props.shared[id].live)\r\n            .map(i => <Group\r\n            key={i}\r\n            title=''\r\n            className=\"group-block\">\r\n            <Channel\r\n              key={i}\r\n              id={i}\r\n              type='shared'\r\n              data={this.props.shared[i]}\r\n              rtmpError={this.props.setPopup}\r\n              channelSettings={this.state.channelSettings}\r\n            />\r\n          </Group>)}\r\n          {this.props.purchased_index.map(i => <Group\r\n            key={i}\r\n            title=''\r\n            className=\"group-block\">\r\n              <Channel\r\n                key={i}\r\n                type='purchased'\r\n                data={this.props.purchased[i]}\r\n                id={i}\r\n              />\r\n          </Group>)}\r\n        </Fragment>;\r\n      default:\r\n        return <Cell>Выберите из выпадающего списка</Cell>;\r\n    }\r\n  };\r\n\r\n  rtmpColsdHandler = () => {\r\n    this.setState({\r\n      rtmpColsd: !this.state.rtmpColsd\r\n    });\r\n  };\r\n\r\n  render() {\r\n\r\n    const { activeTab, setActiveTab, disabled, disabled_index, isMobile, updateStreamKey } = this.props;\r\n\r\n    const { channelType } = this.state;\r\n\r\n    let mainStyles = {\r\n      paddingTop: (isMobile ? 10 : 60),\r\n      paddingBottom: 60,\r\n      color: 'gray'\r\n    };\r\n\r\n    return <View\r\n      activePanel={activeTab}\r\n      popout={this.popout()}\r\n    >\r\n      <Panel id='translations'>\r\n        <PageHeader />\r\n        <Group\r\n          style={mainStyles}\r\n          className={activeTab}\r\n        >\r\n          <List>\r\n            {this.props.user.rtmp ?\r\n              <Cell>\r\n                <Group className={this.state.rtmpColsd ? 'rtmp-wrapper collapsed' : 'rtmp-wrapper'}\r\n                       onClick={this.rtmpColsdHandler}>\r\n                  <div className=\"rtmp-wrapper__title\">\r\n                    <span className=\"title\">Настройки rtmp-сервера</span>\r\n                    <Icon24BrowserForward />\r\n                  </div>\r\n                  <FormLayout\r\n                    className='input-copy'\r\n                  >\r\n                      <Input\r\n                        top=\"rtmp-сервер для трансляции\"\r\n                        disabled\r\n                        value={this.props.user.rtmp.url}\r\n                      />\r\n                      <CopyToClipboard\r\n                        className=\"input-copy__icon\"\r\n                        text={this.props.user.rtmp.url}\r\n                        onCopy={() => this.props.setPopup('copied')}>\r\n                        <Icon24Copy\r\n                          onClick={(e) => e.stopPropagation()}\r\n                        />\r\n                      </CopyToClipboard>\r\n                  </FormLayout>\r\n                  <FormLayout\r\n                    className=\"input-copy\"\r\n                  >\r\n                    <Input\r\n                      top={<span>Ключ <Button className=\"get-new-key__button\" level=\"tertiary\" onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        updateStreamKey();\r\n                      }}>сгенерировать новый</Button></span>}\r\n                      disabled\r\n                      value={this.props.user.rtmp.name}\r\n                    />\r\n                    <CopyToClipboard\r\n                      className=\"input-copy__icon\"\r\n                      text={this.props.user.rtmp.name}\r\n                      onCopy={() => this.props.setPopup('copied')}>\r\n                      <Icon24Copy\r\n                        onClick={(e) => e.stopPropagation()}\r\n                      />\r\n                    </CopyToClipboard>\r\n                  </FormLayout>\r\n                </Group>\r\n              </Cell>\r\n              : null}\r\n            <Cell>\r\n              <Group\r\n                className='channels'\r\n                title={<Fragment>\r\n                <div>Каналы</div>\r\n                <Select\r\n                  defaultValue={ this.state.display }\r\n                  onChange={ e => this.setState({ display: e.target.value }) }\r\n                >\r\n                  <option value=\"all\">все</option>\r\n                  <option value=\"owner\">мои</option>\r\n                  <option value=\"shared\">доступные</option>\r\n                  <option value=\"purchased\">приобретенные</option>\r\n                </Select>\r\n                <Button level=\"tertiary\" onClick={() => {\r\n                  setActiveTab('services');\r\n                }}>Добавить канал</Button>\r\n              </Fragment>}>\r\n                {this.props.loaded ? this.displayChannels(this.state.display) : null}\r\n              </Group>\r\n            </Cell>\r\n          </List>\r\n        </Group>\r\n      </Panel>\r\n      <Panel id='services'>\r\n        <PanelHeader\r\n          theme='alternate'\r\n          left={<HeaderButton\r\n            onClick={() => setActiveTab('translations')}\r\n          >\r\n            <Icon24BrowserBack />\r\n          </HeaderButton>}\r\n          addon={<HeaderButton onClick={() => setActiveTab('translations')}>Назад</HeaderButton>}\r\n        >\r\n          Выберите сервис\r\n        </PanelHeader>\r\n        <Group\r\n          style={{\r\n            paddingTop: 10,\r\n            paddingBottom: 10,\r\n            color: 'gray',\r\n            height: '-webkit-fill-available'\r\n          }}\r\n          className={activeTab}\r\n        >\r\n          <List>\r\n            <Cell>\r\n              <Group title=\"Доступные сервисы\">\r\n                <List>\r\n                  {Object.keys(this.state.type).map((type, i) => {\r\n                    return <Cell\r\n                      key={i}\r\n                      before={<Avatar type=\"app\" src={this.state.type[type].logo} />}\r\n                      multiline={false}\r\n                      onClick={() => {\r\n                        this.setState({ channelType: type });\r\n                        setActiveTab('groups');\r\n                      }}\r\n                    >{this.state.type[type].name}</Cell>\r\n                  })}\r\n                </List>\r\n              </Group>\r\n            </Cell>\r\n          </List>\r\n        </Group>\r\n      </Panel>\r\n      <Panel id='groups'>\r\n        <PanelHeader\r\n          theme='alternate'\r\n          left={<HeaderButton\r\n            onClick={() => setActiveTab('services')}\r\n          >\r\n            <Icon24BrowserBack />\r\n          </HeaderButton>}\r\n          addon={<HeaderButton onClick={() => setActiveTab('services')}>Назад</HeaderButton>}\r\n        >\r\n          {channelType === 'custom' || channelType === 'ok' ? 'Укажите настройки нового канала' : 'Выберите группу'}\r\n        </PanelHeader>\r\n        <Group\r\n          style={{\r\n            paddingTop: 10,\r\n            paddingBottom: 10,\r\n            color: 'gray'\r\n          }}\r\n          className={activeTab}\r\n        >\r\n          <List>\r\n            <Cell>\r\n              {channelType && (channelType === 'custom' || channelType === 'ok') ?\r\n                <CustomRTMP\r\n                  channelType={channelType}\r\n                  updateData={this.updateData}\r\n                />\r\n                : <Group title={channelType ?\r\n                  `Доступные каналы/группы ${this.state.type[channelType].name}`\r\n                  : 'Доступные каналы/группы'\r\n                }>\r\n                  <List>\r\n                    {(\r\n                      channelType &&\r\n                      disabled_index[channelType] &&\r\n                      disabled_index[channelType].length > 0\r\n                    ) ? disabled_index[channelType].map(i => {\r\n                        return <Cell\r\n                          key={i}\r\n                          before={<Avatar type=\"app\" src={disabled[i].photo} />}\r\n                          multiline={false}\r\n                          onClick={() => {\r\n                            this.setState(\r\n                              { channelId: i },\r\n                              this.addUserGroup\r\n                            );\r\n                          }}\r\n                        >{disabled[i].name}</Cell>\r\n                      })\r\n                      : channelType && !this.props.user.token[channelType] ?\r\n                        <Div><Button\r\n                          // onClick={() => this.addUserGroup(true)}\r\n                          onClick={this.authorize}\r\n                          disabled={!this.state.type[channelType].active}\r\n                        >Авторизовать в {this.state.type[channelType].name}</Button></Div>\r\n                        : !channelType ? null : <Div>Нет каналов для добавления</Div>}\r\n                  </List>\r\n                </Group>}\r\n            </Cell>\r\n          </List>\r\n        </Group>\r\n      </Panel>\r\n      <Panel id='channel-settings'>\r\n        <PanelHeader\r\n          theme='alternate'\r\n          left={<HeaderButton onClick={() => setActiveTab('translations')}><Icon24BrowserBack /></HeaderButton>}\r\n        >\r\n          Настройки канала\r\n        </PanelHeader>\r\n        <Channel\r\n          key={this.state.channelId}\r\n          id={this.state.channelId}\r\n          type='owner'\r\n          data={this.props.owner[this.state.channelId]}\r\n          rtmpError={this.props.setPopup}\r\n          updateData={this.updateData}\r\n          deleteChannel={this.deleteChannel}\r\n          paymentPopup={this.paymentPopup}\r\n        />\r\n      </Panel>\r\n    </View>\r\n  }\r\n}\r\n\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    token: state.app.token,\r\n    user: state.app.user,\r\n    activePanel: state.app.activePanel,\r\n    activeTab: state.app.activeTab,\r\n    popout: state.app.popout,\r\n    popup: state.app.popup,\r\n    owner: state.channels.owner,\r\n    owner_index: state.channels.owner_index,\r\n    addedChannelId: state.channels.addedChannelId,\r\n    shared: state.channels.shared,\r\n    shared_index: state.channels.shared_index,\r\n    disabled: state.channels.disabled,\r\n    disabled_index: state.channels.disabled_index,\r\n    available: state.channels.available,\r\n    available_index: state.channels.available_index,\r\n    purchased: state.channels.purchased,\r\n    purchased_index: state.channels.purchased_index,\r\n    loaded: state.channels.loaded,\r\n    pathname: state.router.location.pathname,\r\n    isMobile: state.app.isMobile\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  appState,\r\n  deleteChannel,\r\n  setPopup,\r\n  getUserChannels,\r\n  getAvailableChannels,\r\n  setActiveTab,\r\n  channelState,\r\n  updateStreamKey\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Translations);\r\n\r\nclass CustomRtmpComponent extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      rtmp: '',\r\n      rtmpStatus: 'default',\r\n      key: '',\r\n      keyStatus: 'default',\r\n      name: '',\r\n      typeName: props.channelType ? props.channelType === 'ok' ? 'Одноклассники' : 'Свой RTMP-сервер' : 'Свой RTMP-сервер',\r\n      type: props.channelType ? props.channelType : 'custom'\r\n    };\r\n  }\r\n\r\n  setRtmp = e => {\r\n    const rtmp = e.target.value.trim();\r\n    this.setState({ rtmp });\r\n    if (rtmp.match(/^rtmp:\\/\\/[\\S]+\\/[\\S]*$/i)) {\r\n      this.setState({ rtmpStatus: 'valid' });\r\n    } else {\r\n      this.setState({ rtmpStatus: 'error' });\r\n    }\r\n  };\r\n\r\n  setKey = e => {\r\n    const rtmpKey = e.target.value.trim();\r\n    this.setState({ key: rtmpKey });\r\n    if (rtmpKey.trim() !== '') {\r\n      this.setState({ keyStatus: 'valid' });\r\n    } else {\r\n      this.setState({ keyStatus: 'error' });\r\n    }\r\n  };\r\n\r\n  addCustomRtmp = () => {\r\n    const { type } = this.state;\r\n    if (this.state.rtmpStatus === 'valid' && this.state.rtmpStatus !== 'error') {\r\n      const rtmpUrl = url.parse(this.state.rtmp);\r\n      let rtmp = {};\r\n      if (rtmpUrl.hostname) rtmp.domain = rtmpUrl.hostname;\r\n      if (rtmpUrl.port) rtmp.port = rtmpUrl.port;\r\n      if (rtmpUrl.path) rtmp.query = rtmpUrl.path;\r\n      rtmp.name = this.state.key;\r\n      let data = { rtmp, type };\r\n      if (this.state.name.trim() !== '') data.name = this.state.name.trim();\r\n      this.props.addCustomRtmp(data)\r\n        .then(() => {\r\n          const { addedChannelId, channelState, setActiveTab, updateData } = this.props;\r\n          if(addedChannelId){\r\n            updateData(addedChannelId);\r\n            setActiveTab('channel-settings');\r\n            channelState({ addedChannelId: false })\r\n          } else {\r\n            setActiveTab('translations');\r\n          }\r\n        });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Group title={this.state.typeName}>\r\n        <FormLayout>\r\n          <Input\r\n            top=\"Название\"\r\n            value={this.state.name}\r\n            placeholder='будет отображаться в списке ваших каналов'\r\n            onChange={e => this.setState({ name: e.target.value })}\r\n          />\r\n          <Input\r\n            top=\"rtmp-сервер для трансляции\"\r\n            value={this.state.rtmp}\r\n            placeholder='Адрес сервера'\r\n            onChange={this.setRtmp}\r\n            status={this.state.rtmpStatus}\r\n            bottom={this.state.rtmpStatus === 'error' ? 'Укажите корректный адрес rtmp-сервера' : null}\r\n          />\r\n          <Input\r\n            value={this.state.key}\r\n            placeholder='Ключ'\r\n            onChange={this.setKey}\r\n            status={this.state.keyStatus}\r\n            bottom={this.state.keyStatus === 'error' ? 'Укажите корректный ключ' : null}\r\n          />\r\n          <Button\r\n            onClick={this.addCustomRtmp}\r\n            disabled={!(this.state.rtmpStatus === 'valid' && this.state.keyStatus === 'valid')}\r\n          >Добавить</Button>\r\n        </FormLayout>\r\n      </Group>\r\n    );\r\n  }\r\n}\r\n\r\nconst CustomRTMP = connect(\r\n  (state) => {\r\n    return {\r\n      addedChannelId: state.channels.addedChannelId\r\n    };\r\n  },\r\n  {\r\n    addCustomRtmp,\r\n    setActiveTab,\r\n    channelState\r\n  }\r\n)(CustomRtmpComponent);\r\n","import Translations from './Translations';\r\n\r\nexport default Translations;","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport Cookies from 'js-cookie';\r\nimport { Avatar, Button, Cell, Div } from '@vkontakte/vkui';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport { logout } from './../actions';\r\n\r\nclass User extends Component {\r\n\r\n    logout = () => {\r\n        Cookies.remove('token');\r\n        this.props.logout();\r\n        window.location.assign('/');\r\n    }\r\n\r\n    render() {\r\n        const user = this.props.user;\r\n        return user && !this.props.vkApp ? <Div className=\"user\">\r\n            <Cell style={{padding: '0px 15px'}}\r\n                before={<Avatar src={user.photo} />}\r\n                asideContent={<Button onClick={this.logout} level=\"outline\" style={{marginLeft: '12px'}}>Выйти</Button>}\r\n            >\r\n                {user.first_name + ' ' + user.last_name}\r\n            </Cell>\r\n        </Div> : null;\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        user: state.app.user,\r\n        vkApp: state.app.vkApp\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n    logout\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(User);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Cell, Checkbox } from '@vkontakte/vkui';\r\nimport Icon24Write from '@vkontakte/icons/dist/24/write';\r\nimport './main.scss';\r\nimport { editVideo, selectVideo } from '../../actions';\r\n\r\n\r\nclass VideoItem extends Component {\r\n\r\n  render() {\r\n\r\n    const id = +this.props.id;\r\n    const { preview, name, checked } = this.props.video;\r\n\r\n    return <div className=\"video-item\">\r\n      <div\r\n        className=\"preview\"\r\n        onClick={() => this.props.selectVideo(id)}\r\n      >\r\n        <Checkbox\r\n          checked={!!checked}\r\n          onChange={() => this.props.selectVideo(id)}\r\n        />\r\n        <img src={'/upload/thumbnails/' + preview} alt=\"\" />\r\n      </div>\r\n      <Cell asideContent={<div onClick={() => this.props.editVideo(id)}><Icon24Write /></div>}>{name}</Cell>\r\n    </div >\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state, ownProps) => {\r\n  return {\r\n    video: state.videos.video[ownProps.id]\r\n  }\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  editVideo,\r\n  selectVideo\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(VideoItem);\r\n\r\n","import React from 'react';\r\nimport { Checkbox } from '@vkontakte/vkui';\r\nimport './main.scss';\r\n\r\nclass Album extends React.Component {\r\n    // constructor(props) {\r\n    //     super(props);\r\n    // }\r\n\r\n    render() {\r\n        const { showAlbum, selectAlbum } = this.props;\r\n        const { id, name, preview, countVideo, checked, } = this.props.data;\r\n        return (\r\n            <div className=\"album\">\r\n                <div className=\"preview\">\r\n                    <Checkbox onClick={() => selectAlbum(+id)} defaultChecked={!!checked} />\r\n                    <div className=\"quantity\">{countVideo}</div>\r\n                    <img src={'/upload/thumbnails/' + preview} onClick={() => showAlbum(+id)} alt=\"\" />\r\n                </div>\r\n                <div className=\"album_name\" onClick={() => showAlbum(+id)}>{name}</div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default Album;","import React, { Component, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { Alert, Avatar, Button, Cell, Checkbox, Div, File, FixedLayout, FormLayout, Header, Input, Group, Link, Panel, PopoutWrapper, Select, View, ScreenSpinner } from '@vkontakte/vkui';\nimport Icon24Upload from '@vkontakte/icons/dist/24/upload';\nimport Icon24Add from '@vkontakte/icons/dist/24/add';\nimport Icon24Video from '@vkontakte/icons/dist/24/video';\nimport { getTime, format } from 'date-fns';\nimport { MuiPickersUtilsProvider, DateTimePicker } from 'material-ui-pickers';\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport ruLocale from \"date-fns/locale/ru\";\nimport { addAlbum, addVideo, editVideo, editVideoApi, deleteVideo, deleteAlbum, editAlbum, getAlbums, getVideos, setPopup, selectAlbum, selectVideo, setVideos2Streams, setActiveTab } from '../../actions';\nimport User from './../../components/User';\nimport PageHeader from './../../components/PageHeader';\nimport VideoItem from './video';\nimport Album from './album';\nimport './main.scss';\n\nclass Video extends Component {\n  constructor() {\n    super();\n    this.timeNow = new Date();\n    this.state = {\n      showAlbum: 'all',\n      selectedChannels: [],\n      selectedStreams: [],\n      timeStart: this.timeNow,\n      timeEnd: this.timeNow,\n      changed: false,\n      minutesStep: 15,\n    };\n  }\n\n  componentDidMount() {\n    document.title = \"Видео\";\n    if (!this.props.updated) {\n      this.props.getVideos();\n      this.props.getAlbums()\n        .then(status => {\n          if (status && this.props.album_index.length > 0) {\n            const albumId = this.props.match.params.id;\n            if (albumId && typeof (+albumId) === 'number' && this.props.album[albumId]) {\n              this.setState({\n                albumId,\n                showAlbum: albumId\n              });\n            }\n          }\n        });\n    }\n  }\n\n  popout = () => {\n    const popup = this.props.popout;\n    switch (popup) {\n      case 'hidden':\n        return null;\n      case 'spinner':\n        return <ScreenSpinner />;\n      case 'formAddAlbum':\n        return this.formAddAlbum;\n      case 'formEditAlbum':\n        return this.formEditAlbum();\n      case 'formAddVideo':\n        return this.formAddVideo;\n      case 'formEditVideo':\n        return this.formEditVideo();\n      default:\n        return null;\n    }\n  };\n\n  formAddAlbum = <PopoutWrapper v=\"center\" h=\"center\">\n    <FormLayout className=\"popup\">\n      <Input\n        top=\"Название\"\n        alignment=\"left\"\n        onChange={e => {\n          this.setState({ newAlbum: e.target.value })\n        }}\n      />\n      <Div style={{ display: 'flex' }}>\n        <Button\n          size=\"l\"\n          stretched\n          style={{ marginRight: 8 }}\n          onClick={() => this.addAlbum()}\n        >Сохранить</Button>\n        <Button\n          size=\"l\"\n          stretched\n          level=\"secondary\"\n          onClick={() => {\n            this.setState({ newAlbum: false });\n            this.props.setPopup('hidden');\n          }}\n        >Отмена</Button>\n      </Div>\n    </FormLayout>\n  </PopoutWrapper>;\n\n  formEditAlbum = () => {\n    if (this.state.albumId) {\n      const id = this.state.albumId;\n      const album = this.props.album[id];\n\n      return <PopoutWrapper v=\"center\" h=\"center\">\n        <FormLayout className=\"popup\">\n          <Input\n            top=\"Название\"\n            defaultValue={album.name}\n            alignment=\"left\"\n            onChange={e => {\n              const editAlbum = {\n                id,\n                name: e.target.value\n              };\n              this.setState({ editAlbum });\n            }}\n          />\n          <Link onClick={() => {\n            this.deleteAlbum();\n            this.props.setPopup('hidden');\n            this.setState({ showAlbum: 'all' });\n          }} style={{ marginLeft: 20 }}>Удалить</Link>\n\n          <Div style={{ display: 'flex' }}>\n            <Button\n              size=\"l\"\n              stretched\n              style={{ marginRight: 8 }}\n              onClick={() => {\n                this.editAlbum();\n                this.props.setPopup('hidden');\n              }}\n            >Сохранить</Button>\n            <Button\n              size=\"l\"\n              stretched\n              level=\"secondary\"\n              onClick={() => {\n                this.setState({ editAlbum: false });\n                this.props.setPopup('hidden');\n              }}>Отмена</Button>\n          </Div>\n        </FormLayout>\n      </PopoutWrapper>\n    } else return null;\n  };\n\n  formAddVideo = <PopoutWrapper>\n    <FormLayout onSubmit={e => this.addVideo(e)} getRef={v => this.newVideoForm = v} className=\"popup\">\n      <File name=\"video\" before={<Icon24Video />} size=\"xl\" level=\"2\" />\n      <Input top=\"Название, если оставить пустым, сохранится под именем файла\" alignment=\"left\" name=\"display_name\" />\n      <Div style={{ display: 'flex' }}>\n        <Button size=\"l\" stretched style={{ marginRight: 8 }}>Загрузить</Button>\n        <Button size=\"l\" stretched level=\"secondary\" onClick={() => this.props.setPopup('hidden')}>Отмена</Button>\n      </Div>\n    </FormLayout>\n  </PopoutWrapper>;\n\n  formEditVideo = () => {\n    const id = this.props.videoId;\n    if (id) {\n      const { video, album, album_index } = this.props;\n      return <PopoutWrapper v=\"center\" h=\"center\">\n        <FormLayout className=\"popup\">\n          {/* <FormLayout onSubmit={e => this.editVideo(e, id)} getRef={v => this.editVideoForm = v}> */}\n          <Input\n            top=\"Название\"\n            defaultValue={video[id].name}\n            alignment=\"left\"\n            name=\"display_name\"\n            onChange={e => this.setState({ newVideoName: e.target.value })}\n          />\n          <Select\n            top=\"Альбом\"\n            placeholder=\"Выберите альбом\"\n            defaultValue={video[id].album ? video[id].album : null}\n            name=\"album\"\n            alignment=\"left\"\n            onChange={e => this.setState({ newVideoAlbum: e.target.value })}\n          >\n            {album_index.map(i => <option key={i} value={i}>{album[i].name}</option>)}\n          </Select>\n          <Link onClick={() => this.deleteVideo(id)} style={{ marginLeft: 20 }}>Удалить</Link>\n\n          <Div style={{ display: 'flex' }}>\n            <Button\n              size=\"l\"\n              stretched\n              style={{ marginRight: 8 }}\n              onClick={this.editVideo}\n            >Сохранить</Button>\n            <Button\n              size=\"l\"\n              stretched\n              level=\"secondary\"\n              onClick={() => {\n                this.setState({ newVideoAlbum: false, newVideoName: false });\n                this.props.editVideo(false);\n                this.props.setPopup('hidden');\n              }}>Отмена</Button>\n          </Div>\n        </FormLayout>\n      </PopoutWrapper>\n    } else return null;\n  };\n\n  showAlbum = id => {\n    this.setState({\n      showAlbum: id,\n      albumId: id\n    });\n    this.props.setActiveTab('video', '/video/album/' + id);\n  };\n\n  showAll = () => {\n    this.setState({\n      showAlbum: 'all',\n      albumId: false\n    });\n    this.props.setActiveTab('video');\n  };\n\n  startBroadcast = () => this.setState({ showAlbum: 'broadcast' });\n\n  addAlbum = () => {\n    if (this.state.newAlbum) {\n      this.props.addAlbum(this.state.newAlbum);\n    }\n  };\n\n  editAlbum = () => {\n    if (this.state.editAlbum) {\n      if (this.state.editAlbum.name.trim() !== this.props.album[this.state.editAlbum.id].name) {\n        this.props.editAlbum(this.state.editAlbum.id, this.state.editAlbum.name);\n      }\n    }\n  };\n\n  deleteAlbum = () => {\n    this.props.deleteAlbum(this.state.showAlbum);\n  };\n\n  addVideo = (e) => {\n    e.preventDefault();\n    if (this.props.token && this.newVideoForm) {\n      const formData = new FormData(this.newVideoForm);\n      formData.append('token', this.props.token);\n      formData.append('action', 'upload');\n      this.props.addVideo(this.props.token, formData);\n    }\n  };\n\n  editVideo = () => {\n    const id = this.props.videoId;\n    if (!id) this.props.setPopup('hidden');\n    const token = this.props.token;\n    if (token !== undefined) {\n      const display_name = this.state.newVideoName ? this.state.newVideoName : this.props.video[id].name;\n      let album = 0;\n      if (this.state.newVideoAlbum === undefined) {\n        if (this.props.video[id].album) album = this.props.video[id].album;\n      } else if (this.state.newVideoAlbum !== '') album = this.state.newVideoAlbum;\n\n      const formData = {\n        id,\n        display_name,\n        album,\n        action: 'update'\n      };\n      this.props.editVideoApi(formData)\n        .then(this.props.getAlbums);\n    }\n  };\n\n  deleteVideo = id => {\n    this.props.deleteVideo(id)\n      .then(this.props.getAlbums);\n  };\n\n  selectChannel = id => {\n    const ind = this.state.selectedChannels.indexOf(id);\n    if (ind === -1) this.setState({\n      selectedChannels: [\n        ...this.state.selectedChannels,\n        id\n      ]\n    });\n    else this.setState({\n      selectedChannels: [\n        ...this.state.selectedChannels.slice(0, ind),\n        ...this.state.selectedChannels.slice(ind + 1)\n      ]\n    });\n  };\n\n  selectStream = id => {\n    const ind = this.state.selectedStreams.indexOf(id);\n    if (ind === -1) this.setState({\n      selectedStreams: [\n        ...this.state.selectedStreams,\n        id\n      ]\n    });\n    else this.setState({\n      selectedStreams: [\n        ...this.state.selectedStreams.slice(0, ind),\n        ...this.state.selectedStreams.slice(ind + 1)\n      ]\n    });\n  };\n\n  setVideos2Streams = () => {\n    if (this.props.token && this.props.selectedVideos && this.state.selectedStreams && this.props.selectedVideos.length > 0 && this.state.selectedStreams.length > 0) {\n      const token = this.props.token;\n      const formData = {\n        action: 'video2stream',\n        token,\n        videos: this.props.selectedVideos.join(','),\n        channels: this.state.selectedChannels.join(','),\n        streams: this.state.selectedStreams.join(',')\n      };\n      this.props.setVideos2Streams(token, formData);\n    }\n  };\n\n  changeTimeStart = time => {\n    if (getTime(this.state.timeEnd) <= getTime(time)) this.setState({ timeEnd: new Date(time.getTime() + 3600000) });\n    this.setState({ timeStart: time });\n    this.setState({ changed: true });\n  };\n\n  changeTimeEnd = time => {\n    if (getTime(this.state.timeStart) >= getTime(time)) this.setState({ timeStart: new Date(time.getTime() - 3600000) });\n    this.setState({ timeEnd: time });\n    this.setState({ changed: true });\n  };\n\n  render() {\n    const { video, video_index, album, album_index } = this.props;\n\n    return <View\n      activePanel={this.props.activeTab}\n      popout={this.popout()}\n    >\n      <Panel id={this.props.activeTab}>\n        <PageHeader />\n        <Group\n          style={{\n            paddingTop: 60,\n            paddingBottom: 60,\n            color: 'gray'\n          }}\n          className={this.props.activeTab}\n        >\n          {this.props.user ? <User /> : null}\n          {this.state.showAlbum !== 'all' ?\n            <Div>\n              <Link onClick={this.showAll}>К списку альбомов</Link>\n            </Div>\n            : null}\n          {this.state.showAlbum !== 'broadcast' ?\n            <Div>\n              <Button\n                before={<Icon24Upload />}\n                size=\"l\"\n                onClick={() => this.props.setPopup('formAddVideo')}\n                style={{ marginRight: 5 }}\n              >Загрузить видео</Button>\n              {this.state.showAlbum === 'all' ?\n                <Button\n                  before={<Icon24Add />}\n                  size=\"l\"\n                  onClick={() => this.props.setPopup('formAddAlbum')}\n                >Добавить альбом</Button> : null}\n            </Div>\n            : null\n          }\n          {this.state.showAlbum === 'broadcast' ?\n            <Div>\n              <FormLayout>\n                <Header>Транслировать видео</Header>\n                {this.props.owner_index && this.props.owner_index.length > 0 ?\n                  <Fragment>\n                    <Header level=\"2\">Мои каналы</Header>\n                    {this.props.owner_index.map(id => {\n                      return (<Cell\n                        key={id}\n                        before={<Avatar type=\"image\" src={this.props.owner[id].photo} />}\n                        asideContent={<Checkbox onClick={() => this.selectChannel(id)} disabled />}\n                        size='l'\n                        multiline\n                        description={this.props.owner[id].time ? 'Проданное время' : null}\n                        bottomContent={this.props.owner[id].time && this.props.owner[id].time.length > 0 ?\n                          this.props.owner[id].time.map((time, i) => {\n                            return <div key={i} style={{ display: 'flex', alignItems: 'center' }}>\n                              {format(time.start * 1000, 'dd.MM.yy HH:mm')}\n                              &nbsp;&nbsp;-&nbsp;&nbsp;\n                              {format(time.end * 1000, 'dd.MM.yy HH:mm')}\n                              <Checkbox onClick={() => this.selectStream(time.id)} />\n                            </div>\n                          }) : null}\n                      >\n                        {this.props.owner[id].name}\n                      </Cell>);\n                    })}\n                  </Fragment>\n                  : null}\n                {this.props.purchased_index && this.props.purchased_index.length > 0 ?\n                  <Fragment>\n                    <Header level=\"2\">Купленные каналы</Header>\n                    {this.props.purchased_index.map(id => {\n                      return (<Cell\n                        key={id}\n                        before={<Avatar type=\"image\" src={this.props.purchased[id].photo} />}\n                        asideContent={<Checkbox disabled onClick={() => this.selectChannel(id)} />}\n                        size='l'\n                        multiline\n                        description={this.props.purchased[id].time ? 'Купленное время' : null}\n                        bottomContent={this.props.purchased[id].time && this.props.purchased[id].time.length > 0 ?\n                          this.props.purchased[id].time.map((time, i) => {\n                            return <div key={i} style={{ display: 'flex', alignItems: 'center' }}>\n                              {format(time.start * 1000, 'dd.MM.yy HH:mm')}\n                              &nbsp;&nbsp;-&nbsp;&nbsp;\n                              {format(time.end * 1000, 'dd.MM.yy HH:mm')}\n                              <Checkbox onClick={() => this.selectStream(time.id)} />\n                            </div>\n                          }) : null}\n                      >\n                        {this.props.purchased[id].name}\n                      </Cell>);\n                    })}\n                  </Fragment>\n                  : null}\n                <Checkbox onClick={() => this.setState({ toLoop: !this.state.toLoop })} defaultChecked={!!this.state.toLoop}>Зациклить</Checkbox>\n                <Checkbox onClick={() => this.setState({ setTime: !this.state.setTime })} defaultChecked={!!this.state.setTime}>Указать время</Checkbox>\n                {this.state.setTime ?\n                  <div className=\"date-time\">\n                    <MuiPickersUtilsProvider utils={DateFnsUtils} locale={ruLocale}>\n                      <DateTimePicker\n                        keyboard\n                        ampm={false}\n                        label=\"от\"\n                        onError={console.log}\n                        minDate={this.timeNow}\n                        value={this.state.timeStart}\n                        onChange={this.changeTimeStart}\n                        format={'dd.MM.yyyy HH:mm'}\n                        disableOpenOnEnter\n                        mask={[/\\d/, /\\d/, '.', /\\d/, /\\d/, '.', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, ':', /\\d/, /\\d/]}\n                        minutesStep={this.state.minutesStep}\n                        cancelLabel={'Отмена'}\n                      />\n                      <DateTimePicker\n                        keyboard\n                        ampm={false}\n                        label=\"до\"\n                        onError={console.log}\n                        minDate={this.timeNow}\n                        value={this.state.timeEnd}\n                        onChange={this.changeTimeEnd}\n                        format={'dd.MM.yyyy HH:mm'}\n                        disableOpenOnEnter\n                        mask={[/\\d/, /\\d/, '.', /\\d/, /\\d/, '.', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, ':', /\\d/, /\\d/]}\n                        minutesStep={this.state.minutesStep}\n                        cancelLabel={'Отмена'}\n                      />\n                    </MuiPickersUtilsProvider>\n                  </div>\n                  : null}\n                <Checkbox onClick={() => this.setState({ block: !this.state.block })} defaultChecked={!!this.state.block}>Заблокировать для других трансляций</Checkbox>\n                {this.props.process}\n                <Div style={{ display: 'flex' }}>\n                  <Button size=\"l\" stretched style={{ marginRight: 8 }} onClick={this.setVideos2Streams}>Применить</Button>\n                  <Button size=\"l\" stretched level=\"secondary\" onClick={this.showAll}>Закрыть</Button>\n                </Div>\n              </FormLayout>\n            </Div>\n            : this.state.showAlbum === 'all' ?\n              <div>\n                <Group title=\"Альбомы\">\n                  <Div>\n                    {album_index.map(id => {\n                      return (\n                        <Album\n                          key={id}\n                          data={album[id]}\n                          showAlbum={this.showAlbum}\n                          selectAlbum={this.props.selectAlbum}\n                        />\n                      );\n                    })}\n                  </Div>\n                </Group>\n                <Group title=\"Видео\">\n                  <Div>\n                    {video_index.map(id => <VideoItem\n                      key={id}\n                      id={id}\n                    />)}\n                  </Div>\n                </Group>\n              </div>\n              :\n              <Group>\n                <Cell asideContent={<Button size=\"l\" onClick={() => this.props.setPopup('formEditAlbum')}>Редактировать</Button>}>\n                  <h2>{album[this.state.showAlbum].name}</h2>\n                </Cell>\n                <Div>\n                  {video_index.filter(id => video[id].album && +video[id].album === +this.state.showAlbum).map(id => <VideoItem\n                    key={id}\n                    id={id}\n                  />)}\n                </Div>\n              </Group>\n          }\n          {this.state.showAlbum !== 'broadcast' ?\n            <FixedLayout className=\"fixedfooter\" vertical=\"bottom\">\n              <Cell className=\"container\" asideContent={`Выбрано: ${this.props.selectedVideos.length}`}>\n                <Button\n                  onClick={this.startBroadcast}\n                  size=\"l\"\n                >Транслировать</Button>\n              </Cell>\n            </FixedLayout>\n            : null\n          }\n        </Group>\n      </Panel>\n    </View>\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    token: state.app.token,\n    user: state.app.user,\n    process: state.app.process,\n    activeTab: state.app.activeTab,\n    popout: state.app.popout,\n    videoId: state.videos.videoId,\n    video: state.videos.video,\n    video_index: state.videos.video_index,\n    selectedVideos: state.videos.selectedVideos,\n    updated: state.videos.updated,\n    album: state.albums.albums,\n    album_index: state.albums.albums_index,\n    owner: state.channels.owner,\n    owner_index: state.channels.owner_index,\n    purchased: state.channels.purchased,\n    purchased_index: state.channels.purchased_index,\n  }\n};\n\nconst mapDispatchToProps = {\n  addAlbum,\n  addVideo,\n  editVideo,\n  editVideoApi,\n  deleteVideo,\n  deleteAlbum,\n  editAlbum,\n  getAlbums,\n  getVideos,\n  setPopup,\n  selectAlbum,\n  selectVideo,\n  setVideos2Streams,\n  setActiveTab\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Video);\n","import Cookies from 'js-cookie';\r\nimport qs from 'querystring';\r\nimport { authRequest } from '../utils/requests';\r\nimport { FETCH_DATA_START, FETCH_DATA_END, ALBUMS, SELECT_ALBUM, SELECT_VIDEOS } from './../actions/actionTypes';\r\n\r\nexport const addAlbum = name => (dispatch, getState) => {\r\n    let status = false;\r\n    if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n    const token = getState().app.token || Cookies.get('token');\r\n    if (!token) {\r\n        if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n        return status;\r\n    }\r\n    const init = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n            'Authorization': `Bearer ${token}`\r\n        },\r\n        body: qs.stringify({ token, name })\r\n    };\r\n    const url = `${window.location.protocol}//${window.location.host}/api/albums`;\r\n    return fetch(url, init)\r\n        .then((res) => {\r\n            if (res.ok) return res.json();\r\n            else return false\r\n        })\r\n        .then(data => {\r\n            if (data.items) {\r\n                const albums = data.items;\r\n                const albums_index = Object.keys(data.items).sort((a, b) => b - a);\r\n                dispatch({ type: ALBUMS, payload: { albums, albums_index } });\r\n                status = true;\r\n            }\r\n            if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n            return status;\r\n        });\r\n}\r\n\r\nexport const selectAlbum = id => (dispatch, getState) => {\r\n    dispatch({ type: FETCH_DATA_START });\r\n\r\n    const checked = !getState().albums.albums[id].checked;\r\n    dispatch({ type: SELECT_ALBUM, payload: +id })\r\n\r\n    let { video, selectedVideos } = getState().videos;\r\n    for (let i in video) {\r\n        if (video[i].album && +video[i].album === +id) {\r\n            video[i].checked = checked;\r\n            const ind = selectedVideos.indexOf(+i);\r\n            if (checked) {\r\n                if (ind === -1) {\r\n                    selectedVideos.push(+i);\r\n                }\r\n            } else {\r\n                if (ind !== -1) {\r\n                    selectedVideos = [\r\n                        ...selectedVideos.slice(0, ind),\r\n                        ...selectedVideos.slice(ind + 1)\r\n                    ];\r\n                }\r\n            }\r\n        }\r\n    }\r\n    setTimeout(() => dispatch({ type: FETCH_DATA_END }), 0);\r\n    return dispatch({ type: SELECT_VIDEOS, payload: { video, selectedVideos } });\r\n};\r\n\r\nexport const editAlbum = (id, name) => (dispatch, getState) => {\r\n    let status = false;\r\n    if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n    const token = getState().app.token || Cookies.get('token');\r\n    if (!token) {\r\n        if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n        return status;\r\n    }\r\n    authRequest({\r\n        method: 'GET', //change to POST\r\n        url: `${window.location.protocol}//${window.location.host}/api/albums`,\r\n        token: token,\r\n        body: { token, id, name }\r\n    }).then(data => {\r\n        if (data.items) {\r\n            const albums = data.items;\r\n            const albums_index = Object.keys(data.items).sort((a, b) => b - a);\r\n            dispatch({ type: ALBUMS, payload: { albums, albums_index } });\r\n            status = true;\r\n        }\r\n        if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n        return status;\r\n    });\r\n}\r\n\r\nexport const deleteAlbum = id => (dispatch, getState) => {\r\n    let status = false;\r\n    if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n    const token = getState().app.token || Cookies.get('token');\r\n    if (!token) {\r\n        if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n        return status;\r\n    }\r\n    const init = {\r\n        method: 'POST',\r\n        headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n        },\r\n        body: qs.stringify({ token, id, action: 'delete' })\r\n    };\r\n    const url = `${window.location.protocol}//${window.location.host}/api/albums`;\r\n    return fetch(url, init)\r\n        .then((res) => {\r\n            if (res.ok) return res.json();\r\n            else return false\r\n        })\r\n        .then(data => {\r\n            if (data.items) {\r\n                const albums = data.items;\r\n                const albums_index = Object.keys(data.items).sort((a, b) => b - a);\r\n                dispatch({ type: ALBUMS, payload: { albums, albums_index } });\r\n                status = true;\r\n            }\r\n            if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n            return status;\r\n        });\r\n}\r\n\r\nexport const getAlbums = () => (dispatch, getState) => {\r\n    let status = false;\r\n    if (!getState().app.updating) dispatch({ type: FETCH_DATA_START });\r\n    const token = getState().app.token || Cookies.get('token');\r\n    if (!token) {\r\n        if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n        return new Promise(resolve => resolve(status));\r\n    }\r\n    const init = {\r\n        method: 'GET',\r\n        headers: {\r\n            'Authorization': `Bearer ${token}`\r\n        }\r\n    };\r\n    const url = `${window.location.protocol}//${window.location.host}/api/albums?token=${token}`;\r\n    return fetch(url, init)\r\n        .then((res) => {\r\n            if (res.ok) return res.json();\r\n            else return false\r\n        })\r\n        .then(data => {\r\n            if (data && data.items) {\r\n                const albums = data.items;\r\n                const albums_index = Object.keys(data.items).sort((a, b) => b - a);\r\n                dispatch({ type: ALBUMS, payload: { albums, albums_index } });\r\n                status = true;\r\n            }\r\n            if (getState().app.updating) dispatch({ type: FETCH_DATA_END });\r\n            return status;\r\n        });\r\n}\r\n\r\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Avatar, Button, Cell, Div, FormLayout, FormLayoutGroup, List } from '@vkontakte/vkui';\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\nimport { MuiPickersUtilsProvider, DatePicker, DateTimePicker } from 'material-ui-pickers';\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport { getTime, getUnixTime, endOfDay, startOfDay, format } from 'date-fns';\nimport ruLocale from \"date-fns/locale/ru\";\nimport { buyStreamTime, searchChannels, getUserChannels, soldStreams, getPurchasedChannels, purchasedStreams } from '../../actions';\n\nclass ListTranslations extends Component {\n    constructor(props) {\n        super(props);\n        this.timeNow = new Date();\n        this.state = {\n            select: false,\n            id: 0,\n            price: 0,\n            startOfDay: startOfDay(this.timeNow),\n            endOfDay: endOfDay(this.timeNow),\n            timeStart: this.timeNow,\n            timeEnd: this.timeNow,\n            changed: false, // были ли изменения\n            disabled: false, // выключена ли кнопка покупки\n            availableTime: null,\n            minutesStep: 15\n        }\n    };\n\n    selectChannel = (id = false) => {\n        if (id) {\n            this.getStreamTime(id);\n            this.setState({ select: !this.state.select, id });\n        } else this.setState({ select: !this.state.select, id: !this.state.id });\n    };\n\n    buyStreamTime = e => {\n        e.preventDefault();\n        this.setState({ disabled: true });\n        let error = [];\n        if (getTime(this.state.timeStart) >= getTime(this.state.timeEnd)) error = [\n            ...error,\n            'Некорректное время'\n        ];\n\n        if (this.props.token && error.length == 0) {\n            const token = this.props.token;\n            const formData = {\n                group_id: this.state.id,\n                time_start: getUnixTime(this.state.timeStart),\n                time_end: getUnixTime(this.state.timeEnd),\n                token: this.props.token,\n                action: 'buy'\n            };\n            this.props.buyStreamTime(token, formData)\n                .then(() => {\n                    this.props.getUserChannels()\n                        .then(this.props.soldStreams);\n                    this.props.getPurchasedChannels()\n                        .then(this.props.purchasedStreams);\n                })\n                .then(this.props.searchChannels(token))\n                .then(this.getStreamTime(this.state.id))\n                .then(this.setState({ disabled: false, error: false }));\n        } else this.setState({ error });\n    }\n\n    getStreamTime = id => {\n        this.setState({\n            disabled: false,\n            availableTime: <p style={{ color: 'green' }}>Трансляций не запланировано</p>,\n        });\n        const timeStreams = this.props.found[id].time;\n        if (timeStreams) {\n            const newTS = timeStreams.filter(item => (+item.start * 1000) > getTime(this.state.startOfDay) && (+item.start * 1000) < getTime(this.state.endOfDay));\n            if (newTS.length > 0) {\n                this.setState({\n                    availableTime: <div style={{ color: 'red' }}>\n                        <div>Недоступное для покупки время</div>\n                        {newTS.map((item, i) => {\n                            return (\n                                <div key={i}>\n                                    {format(item.start * 1000, 'dd.MM.yyyy HH:mm')}\n                                    &nbsp;&nbsp;-&nbsp;&nbsp;\n                                    {format(item.end * 1000, 'dd.MM.yyyy HH:mm')}\n                                </div>\n                            );\n                        })}\n                    </div>\n                });\n            }\n        }\n    }\n\n    setStreamDate = date => {\n        this.setState({\n            disabled: false,\n            availableTime: <p style={{ color: 'green' }}>Трансляций не запланировано</p>,\n            startOfDay: startOfDay(date),\n            endOfDay: endOfDay(date)\n        });\n        const timeStreams = this.props.found[this.state.id].time;\n        if (timeStreams && this.state.id) {\n            const newTS = timeStreams.filter(item => (+item.start * 1000) > getTime(startOfDay(date)) && (+item.start * 1000) < getTime(endOfDay(date)));\n            if (newTS.length > 0) {\n                this.setState({\n                    availableTime: <div style={{ color: 'red' }}>\n                        <div>Недоступное для покупки время</div>\n                        {newTS.map((item, i) => {\n                            return (\n                                <div key={i}>\n                                    {format(item.start * 1000, 'dd.MM.yyyy HH:mm')}\n                                    &nbsp;&nbsp;-&nbsp;&nbsp;\n                                    {format(item.end * 1000, 'dd.MM.yyyy HH:mm')}\n                                </div>\n                            );\n                        })}\n                    </div>\n                });\n            }\n        }\n    }\n\n    changeTimeStart = time => {\n        if (getTime(this.state.timeEnd) <= getTime(time)) this.setState({ timeEnd: new Date(time.getTime() + 3600000) });\n        this.setState({ timeStart: time });\n        this.setState({ disabled: false });\n    };\n    changeTimeEnd = time => {\n        if (getTime(this.state.timeStart) >= getTime(time)) this.setState({ timeStart: new Date(time.getTime() - 3600000) });\n        this.setState({ timeEnd: time });\n        this.setState({ disabled: false });\n    };\n\n    getSum = () => {\n        const { timeStart, timeEnd, id } = this.state;\n        const price = this.props.found[id].price;\n        let sum = 0;\n        if (id) {\n            sum = Math.ceil((getTime(timeEnd) - getTime(timeStart)) / 3600000 * (+price));\n            if (sum < 0) {\n                return <div style={{ color: 'red' }}>Время начала и конца указано некорректно!</div>;\n            } else return <div>{sum} руб.</div>;\n        }\n        return <div>0 руб.</div>;\n    }\n\n    list = () => {\n        if (this.props.found_index && this.props.found_index.length > 0) {\n            return this.props.found_index.map(id =>\n                <Cell\n                    before={<Avatar size={40} src={this.props.found[id].photo} />}\n                    onClick={() => this.selectChannel(id)}\n                    size=\"l\"\n                    key={id}\n                    asideContent={this.props.found[id].price + \" руб / час\"}\n                    className='channel'\n                >\n                    {this.props.found[id].name}\n                </Cell>\n            );\n        } else return null;\n    }\n\n    render() {\n\n        const channels = this.props.found;\n        const { id, timeStart, timeEnd, startOfDay, minutesStep } = this.state;\n\n        return (\n            <Div>\n                {!this.state.select ? this.list() :\n                    <List className=\"select-translation\">\n                        <Cell\n                            onClick={() => this.selectChannel()}\n                            asideContent={<Icon24Cancel />}>Покупка трансляции</Cell>\n                        <Cell\n                            before={<Avatar size={40} src={channels[id].photo} />}\n                            size=\"l\"\n                            asideContent={channels[id].price + \" руб/час\"}\n                        >\n                            {channels[id].name}\n                        </Cell>\n                        <FormLayout onSubmit={this.buyStreamTime} getRef={v => this.formBuyTime = v}>\n                            <div className=\"broadcast-date\">\n                                <MuiPickersUtilsProvider utils={DateFnsUtils} locale={ruLocale}>\n                                    <DatePicker\n                                        value={startOfDay}\n                                        onChange={this.setStreamDate}\n                                        minDate={new Date()}\n                                        format={'dd.MM.yyyy'}\n                                        ref={v => this.dateBroadcast = v}\n                                        keyboard\n                                        name=\"date\"\n                                        cancelLabel={'Отмена'}\n                                    />\n                                </MuiPickersUtilsProvider>\n                            </div>\n                            <div className=\"free-time\">\n                                {this.state.id ? this.state.availableTime : null}\n                            </div>\n                            <FormLayoutGroup top=\"Интервал трансляции\" >\n                                <div className=\"date-time\">\n                                    <MuiPickersUtilsProvider utils={DateFnsUtils} locale={ruLocale}>\n                                        <DateTimePicker\n                                            keyboard\n                                            ampm={false}\n                                            label=\"от\"\n                                            onError={console.log}\n                                            minDate={this.timeNow}\n                                            value={timeStart}\n                                            onChange={this.changeTimeStart}\n                                            format={'dd.MM.yyyy HH:mm'}\n                                            disableOpenOnEnter\n                                            mask={[/\\d/, /\\d/, '.', /\\d/, /\\d/, '.', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, ':', /\\d/, /\\d/]}\n                                            minutesStep={minutesStep}\n                                            cancelLabel={'Отмена'}\n                                        />\n                                        <DateTimePicker\n                                            keyboard\n                                            ampm={false}\n                                            label=\"до\"\n                                            onError={console.log}\n                                            minDate={this.timeNow}\n                                            value={timeEnd}\n                                            onChange={this.changeTimeEnd}\n                                            format={'dd.MM.yyyy HH:mm'}\n                                            disableOpenOnEnter\n                                            mask={[/\\d/, /\\d/, '.', /\\d/, /\\d/, '.', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, ':', /\\d/, /\\d/]}\n                                            minutesStep={minutesStep}\n                                            cancelLabel={'Отмена'}\n                                        />\n                                    </MuiPickersUtilsProvider>\n                                </div>\n                            </FormLayoutGroup>\n                            <div className=\"summ\">\n                                <h4>Сумма: </h4>\n                                {this.getSum()}\n                            </div>\n                            <input type=\"hidden\" name=\"group_id\" value={id} />\n                            {this.props.process}\n                            <Button size=\"xl\" disabled={this.state.disabled}>Забронировать</Button>\n                        </FormLayout>\n                    </List>\n                }\n            </Div>\n        )\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        found: state.channels.found,\n        found_index: state.channels.found_index,\n        token: state.app.token,\n        process: state.app.process,\n    };\n};\n\nconst mapDispatchToProps = {\n    buyStreamTime,\n    searchChannels,\n    getUserChannels,\n    soldStreams,\n    getPurchasedChannels,\n    purchasedStreams\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ListTranslations);\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Button, Div, FormLayout, FormLayoutGroup, Group, Input, Panel, ScreenSpinner, View } from '@vkontakte/vkui';\nimport { MuiPickersUtilsProvider, DateTimePicker } from 'material-ui-pickers';\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport { getTime, getUnixTime } from 'date-fns';\nimport ruLocale from \"date-fns/locale/ru\";\nimport User from './../../components/User';\nimport PageHeader from './../../components/PageHeader';\nimport { searchChannels } from '../../actions';\nimport List from './ListTranslations';\nimport './main.scss';\n\nclass Market extends Component {\n  constructor(props) {\n    super(props);\n    this.timeNow = new Date();\n    this.state = {\n      show: false,\n      name: '',\n      timeStart: this.timeNow,\n      timeEnd: this.timeNow,\n      // timeStart: moment(new Date()).hour(0).minute(0),\n      // timeEnd: moment(new Date()).hour(23).minute(59),\n      changed: false,\n      minutesStep: 15,\n    }\n  }\n\n  componentDidMount() {\n    document.title = \"Биржа\";\n  }\n\n  searchTranslationClick = () => {\n    this.setState({\n      show: true,\n    })\n  };\n  searchChannels = e => {\n    e.preventDefault();\n    if (this.props.token && this.formSearchChannels) {\n      // const formData = new FormData(this.formSearchChannels);\n      // formData.set('action', 'search');\n      // formData.set('token', this.props.token);\n      // if (this.state.changed) {\n      //     formData.set('time_start', getUnixTime(this.state.timeStart));\n      //     formData.set('time_end', getUnixTime(this.state.timeEnd));\n      // }\n      // if (this.state.name.trim() !== '') {\n      //     formData.set('name', this.state.name);\n      // }\n      const formData = {\n        action: 'search',\n        token: this.props.token\n      };\n      if (this.state.changed) {\n        formData.time_start = getUnixTime(this.state.timeStart);\n        formData.time_end = getUnixTime(this.state.timeEnd);\n      }\n      if (this.state.name.trim() !== '') {\n        formData.name = this.state.name;\n      }\n      this.props.searchChannels(this.props.token, formData)\n        .then(this.setState({ show: true }));\n    }\n  };\n  changeTimeStart = time => {\n    if (getTime(this.state.timeEnd) <= getTime(time)) this.setState({ timeEnd: new Date(time.getTime() + 3600000) });\n    this.setState({ timeStart: time });\n    this.setState({ changed: true });\n  };\n  changeTimeEnd = time => {\n    if (getTime(this.state.timeStart) >= getTime(time)) this.setState({ timeStart: new Date(time.getTime() - 3600000) });\n    this.setState({ timeEnd: time });\n    this.setState({ changed: true });\n  };\n\n  popout = {\n    hidden: null,\n    spinner: <ScreenSpinner />\n  };\n\n  render() {\n    return <View\n      activePanel={this.props.activeTab}\n      popout={this.popout[this.props.popout]}\n    >\n      <Panel id={this.props.activeTab}>\n        <PageHeader />\n        <Group\n          style={{\n            paddingTop: 60,\n            paddingBottom: 60,\n            color: 'gray'\n          }}\n          className={this.props.activeTab}\n        >\n          {this.props.user ? <User /> : null}\n          <Div>\n            <FormLayout onSubmit={this.searchChannels} getRef={v => this.formSearchChannels = v}>\n\n              <Input\n                className=\"search\"\n                type=\"text\"\n                onChange={e => this.setState({ name: e.target.value })}\n                placeholder=\"Поиск по названию\"\n              />\n\n              <FormLayoutGroup top=\"Выберите необходимый интервал\" >\n                <div className=\"date-time\">\n                  <MuiPickersUtilsProvider utils={DateFnsUtils} locale={ruLocale}>\n                    <DateTimePicker\n                      keyboard\n                      ampm={false}\n                      label=\"от\"\n                      onError={console.log}\n                      minDate={this.timeNow}\n                      value={this.state.timeStart}\n                      onChange={this.changeTimeStart}\n                      format={'dd.MM.yyyy HH:mm'}\n                      disableOpenOnEnter\n                      mask={[/\\d/, /\\d/, '.', /\\d/, /\\d/, '.', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, ':', /\\d/, /\\d/]}\n                      minutesStep={this.state.minutesStep}\n                      cancelLabel={'Отмена'}\n                    />\n                    <DateTimePicker\n                      keyboard\n                      ampm={false}\n                      label=\"до\"\n                      onError={console.log}\n                      minDate={this.timeNow}\n                      value={this.state.timeEnd}\n                      onChange={this.changeTimeEnd}\n                      format={'dd.MM.yyyy HH:mm'}\n                      disableOpenOnEnter\n                      mask={[/\\d/, /\\d/, '.', /\\d/, /\\d/, '.', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, ':', /\\d/, /\\d/]}\n                      minutesStep={this.state.minutesStep}\n                      cancelLabel={'Отмена'}\n                    />\n                  </MuiPickersUtilsProvider>\n                </div>\n              </FormLayoutGroup>\n              <Button size=\"xl\">Показать</Button>\n            </FormLayout>\n          </Div>\n          {this.state.show ? <List /> : null}\n        </Group>\n      </Panel>\n    </View>\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    token: state.app.token,\n    user: state.app.user,\n    popout: state.app.popout,\n    activeTab: state.app.activeTab\n  };\n};\n\nconst mapDispatchToProps = {\n  searchChannels\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Market);\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Alert, Button, Div, Group, Panel, ScreenSpinner, Select, View } from '@vkontakte/vkui';\nimport 'fullcalendar-reactwrapper/dist/css/fullcalendar.min.css';\nimport FullCalendar from 'fullcalendar-reactwrapper';\nimport { soldStreams, purchasedStreams } from '../../actions';\nimport User from './../../components/User';\nimport PageHeader from './../../components/PageHeader';\nimport LoadData from '../../components/loadData';\n\nclass Scheduler extends Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tevents: props.soldStreams().payload,\n\t\t\tshedulerSwitch: true,\n\t\t\tdefaultView: 'month',\n\t\t\tdefaultValue: 0\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tdocument.title = \"Расписание\";\n\t}\n\n\tshedulerSwitch = () => {\n\t\tif (this.state.shedulerSwitch) {\n\t\t\tthis.setState({\n\t\t\t\tshedulerSwitch: false,\n\t\t\t\tevents: this.props.purchasedStreams().payload,\n\t\t\t\tdefaultValue: 0\n\t\t\t});\n\t\t} else {\n\n\t\t\tthis.setState({\n\t\t\t\tshedulerSwitch: true,\n\t\t\t\tevents: this.props.soldStreams().payload,\n\t\t\t\tdefaultValue: 0\n\t\t\t});\n\t\t}\n\t}\n\n\tshowChannel = e => {\n\t\tconst id = e.target.value;\n\t\tif (this.state.shedulerSwitch) {\n\t\t\tthis.setState({\n\t\t\t\tdefaultValue: id,\n\t\t\t\tevents: this.props.soldStreams(id).payload\n\t\t\t});\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\tdefaultValue: id,\n\t\t\t\tevents: this.props.purchasedStreams(id).payload\n\t\t\t});\n\t\t}\n\t}\n\n\tpopout = {\n\t\tclosed: null,\n\t\tspinner: <ScreenSpinner />\n\t}\n\n\trender() {\n\t\treturn <View\n\t\t\tactivePanel={this.props.activeTab}\n\t\t\tpopout={this.popout[this.props.popout]}\n\t\t>\n\t\t\t<Panel id={this.props.activeTab}>\n\t\t\t\t<PageHeader />\n\t\t\t\t<Group\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tpaddingTop: 60,\n\t\t\t\t\t\tpaddingBottom: 60,\n\t\t\t\t\t\tcolor: 'gray'\n\t\t\t\t\t}}\n\t\t\t\t\tclassName={this.props.activeTab}\n\t\t\t\t>\n\t\t\t\t\t{this.props.user ? <User /> : null}\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tstyle={{ marginRight: 5 }}\n\t\t\t\t\t\t\tlevel={this.state.shedulerSwitch ? 'primary' : 'outline'}\n\t\t\t\t\t\t\tonClick={this.shedulerSwitch}\n\t\t\t\t\t\t>Мои каналы</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tlevel={this.state.shedulerSwitch ? 'outline' : 'primary'}\n\t\t\t\t\t\t\tonClick={this.shedulerSwitch}\n\t\t\t\t\t\t>Мои трансляции</Button>\n\t\t\t\t\t</Div>\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t//placeholder=\"Выберите альбом\"\n\t\t\t\t\t\t\tdefaultValue={this.state.defaultValue}\n\t\t\t\t\t\t\tname=\"album\"\n\t\t\t\t\t\t\talignment=\"left\"\n\t\t\t\t\t\t\tonChange={e => this.showChannel(e)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option key={0} value={0}>Все</option>\n\t\t\t\t\t\t\t{this.state.shedulerSwitch ?\n\t\t\t\t\t\t\t\tthis.props.owner_index.map(id => <option key={id} value={id}>{this.props.owner[id].name}</option>)\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\tthis.props.purchased_index.map(id => <option key={id} value={id}>{this.props.purchased[id].name}</option>)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</Select>\n\t\t\t\t\t</Div>\n\t\t\t\t\t{this.props.loadData ? <LoadData /> :\n\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t<FullCalendar\n\t\t\t\t\t\t\t\tid=\"GPL-My-Project-Is-Open-Source\"\n\t\t\t\t\t\t\t\tlocale=\"ru\"\n\t\t\t\t\t\t\t\theader={{\n\t\t\t\t\t\t\t\t\tleft: 'prev,today,next',\n\t\t\t\t\t\t\t\t\tcenter: 'title',\n\t\t\t\t\t\t\t\t\tright: 'agendaDay,agendaWeek,month',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tbuttonText={\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttoday: 'сегодня',\n\t\t\t\t\t\t\t\t\t\tmonth: 'месяц',\n\t\t\t\t\t\t\t\t\t\tweek: 'неделя',\n\t\t\t\t\t\t\t\t\t\tday: 'день'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\teditable={false}\n\t\t\t\t\t\t\t\tdefaultView={this.state.defaultView}\n\t\t\t\t\t\t\t\tallDaySlot={false}\n\t\t\t\t\t\t\t\tselectHelper={true}\n\t\t\t\t\t\t\t\tdroppable={true} // this allows things to be dropped onto the calendar !!!\n\t\t\t\t\t\t\t\tslotLabelFormat={'HH:mm'}\n\t\t\t\t\t\t\t\tdefaultDate={new Date()}\n\t\t\t\t\t\t\t\tnavLinks={true} // can click day/week names to navigate views\n\t\t\t\t\t\t\t\teventLimit={true} // allow \"more\" link when too many events\n\t\t\t\t\t\t\t\tevents={this.state.events}\n\t\t\t\t\t\t\t\ttimeFormat={'HH:mm'}\n\t\t\t\t\t\t\t\teventLimitText={'ещё'}\n\t\t\t\t\t\t\t\tdayPopoverFormat={'dddd, DD.MM.YY'}\n\t\t\t\t\t\t\t\tselectable={true}\n\t\t\t\t\t\t\t\tselect={(start, end, jsEvent, view) => console.log(start, end, jsEvent, view)}\n\t\t\t\t\t\t\t// eventClick={console.log}\n\t\t\t\t\t\t\t//eventClick={(event, jsEvent, view) => console.log(event, jsEvent, view)}\n\t\t\t\t\t\t\t//eventMouseover={this.openPopup}\n\t\t\t\t\t\t\t//eventMouseout={this.props.popoutNull}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Div>}\n\t\t\t\t</Group>\n\t\t\t</Panel >\n\t\t</View >\n\t}\n}\n\nconst mapStateToProps = state => {\n\treturn {\n\t\ttoken: state.app.token,\n\t\tuser: state.app.user,\n\t\tloadData: state.app.loadData,\n\t\tpopout: state.app.popout,\n\t\tprocess: state.app.process,\n\t\tactiveTab: state.app.activeTab,\n\t\towner: state.channels.owner,\n\t\towner_index: state.channels.owner_index,\n\t\tpurchased: state.channels.purchased,\n\t\tpurchased_index: state.channels.purchased_index\n\t};\n};\n\nconst mapDispatchToProps = {\n\tsoldStreams,\n\tpurchasedStreams\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Scheduler);\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport {Alert, Cell, Div, Group, Input, List, Panel, View} from '@vkontakte/vkui';\r\nimport { format } from 'date-fns';\r\nimport Icon24Copy from '@vkontakte/icons/dist/24/copy';\r\nimport CopyToClipboard from 'react-copy-to-clipboard';\r\n\r\nimport User from './../../components/User';\r\nimport PageHeader from './../../components/PageHeader';\r\nimport { referrals as getReferrals, setPopup } from '../../actions';\r\n\r\nimport './main.scss';\r\n\r\nclass Partner extends Component {\r\n\r\n  componentDidMount() {\r\n    document.title = \"Партнерская программа\";\r\n    this.props.getReferrals();\r\n  }\r\n\r\n  popout = () => {\r\n    switch (this.props.popout) {\r\n      case 'hidden':\r\n        return null;\r\n      case 'success':\r\n        return this.popup();\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  popup = () => {\r\n    setTimeout(() => this.props.setPopup('hidden'), 1000);\r\n    return <Alert onClose={() => this.props.setPopup('hidden')}>\r\n      <Div style={{ color: 'green' }}>\r\n        Скопировано!\r\n      </Div>\r\n    </Alert>\r\n  };\r\n\r\n  copyLink = () => {\r\n    // let copyText = document.getElementById('reflink');\r\n    // copyText.focus();\r\n    // copyText.select();\r\n    // document.execCommand('copy');\r\n    this.props.setPopup('success');\r\n  };\r\n\r\n\r\n  render() {\r\n\r\n    const { activeTab, popout, profit, referrals, user, isMobile } = this.props;\r\n\r\n    let mainStyles = {\r\n      paddingTop: (isMobile ? 10 : 60),\r\n      paddingBottom: 60,\r\n      color: 'gray'\r\n    };\r\n\r\n    const reflink = `${window.location.protocol}//${window.location.host}/p/${user.ref_id}`;\r\n\r\n    return <View\r\n      activePanel={activeTab}\r\n      popout={this.popout()}\r\n    >\r\n      <Panel id={activeTab}>\r\n        <PageHeader />\r\n        <Group\r\n          style={mainStyles}\r\n          className={activeTab}\r\n        >\r\n          {user ? <User /> : null}\r\n          <Div>\r\n            <Group title=\"Ваша ссылка для привлечения партнеров\">\r\n              <Div className='input-copy'>\r\n                <Input\r\n                  id='reflink'\r\n                  disabled\r\n                  value={reflink}\r\n                />\r\n                <CopyToClipboard\r\n                  text={reflink}\r\n                  onCopy={this.copyLink}>\r\n                  <Icon24Copy/>\r\n                </CopyToClipboard>\r\n              </Div>\r\n            </Group>\r\n            <Group title=\"Бонус клиентам\">\r\n              <Div>\r\n                При регистрации по Вашей партнерской ссылке клиент получает бонус - 300 руб на баланс своего аккаунта.<br />\r\n                Высокая комисссия в размере 30% от всех платежей привлеченных партнеров.\r\n              </Div>\r\n            </Group>\r\n            <Group title=\"Статистика\">\r\n              <Div>\r\n                Детальная статистика по числу рефералов и заработанным средствам.\r\n              </Div>\r\n            </Group>\r\n            <Group title={`Партнеры: ${user.partners}`} />\r\n            <Group title={`Заработано: ${Math.floor(profit)} ₽`}>\r\n              {referrals && referrals.length > 0 ?\r\n                <List>\r\n                  {referrals.map((ref, i) => <Cell\r\n                    before={`${Math.floor(ref.sum)} ₽`}\r\n                    size=\"l\"\r\n                    multiline\r\n                    key={i}\r\n                    asideContent={format(ref.date * 1000, 'dd.MM.yyyy')}\r\n                    bottomContent={ref.description}\r\n                  >\r\n                    {ref.name} {ref.fename}\r\n                  </Cell>)}\r\n                </List>\r\n                : null}\r\n            </Group>\r\n          </Div>\r\n        </Group>\r\n      </Panel>\r\n    </View>\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeTab: state.app.activeTab,\r\n    popout: state.app.popout,\r\n    user: state.app.user,\r\n    referrals: state.balance.referrals,\r\n    profit: state.balance.profit,\r\n    isMobile: state.app.isMobile\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  getReferrals,\r\n  setPopup\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Partner);\r\n","import Cookies from 'js-cookie';\r\nimport qs from 'querystring';\r\nimport { FETCH_DATA_START, FETCH_DATA_END, BALANCE, HISTORY, REFERRALS } from './../actions/actionTypes';\r\n\r\nexport const referrals = () => (dispatch, getState) => {\r\n  let status = false;\r\n  if (getState().app.updating === 0) dispatch({ type: FETCH_DATA_START });\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n    return new Promise(resolve => resolve(false));\r\n  }\r\n  const init = {\r\n    method: 'GET',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`\r\n    }\r\n  };\r\n  const url = `${window.location.protocol}//${window.location.host}/api/balance?${qs.stringify({ token })}`;\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return { data: { status: false } };\r\n    })\r\n    .then(data => {\r\n      if (data.status === 'ok') {\r\n        const referrals = data.referrals;\r\n        const profit = data.profit;\r\n        const balance = data.balance;\r\n        dispatch({ type: REFERRALS, payload: { balance, referrals, profit } });\r\n        status = true;\r\n      }\r\n      if (getState().app.updating === 1) dispatch({ type: FETCH_DATA_END });\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const getBalance = () => (dispatch, getState) => {\r\n  let status = false;\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    return new Promise(resolve => resolve(false));\r\n  }\r\n  const init = {\r\n    method: 'GET',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`\r\n    }\r\n  };\r\n  const url = `${window.location.protocol}//${window.location.host}/api/balance?${qs.stringify({ token })}`;\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return { data: { status: false } };\r\n    })\r\n    .then(data => {\r\n      if (data.status === 'ok') {\r\n        const { balance, history } = data;\r\n        dispatch({ type: BALANCE, payload: { balance, history, loaded: true } });\r\n        status = true;\r\n      }\r\n      return status;\r\n    });\r\n};\r\n\r\nexport const balanceHistory = () => (dispatch, getState) => {\r\n  let status = false;\r\n  const token = getState().app.token || Cookies.get('token');\r\n  if (!token) {\r\n    return new Promise(resolve => resolve(false));\r\n  }\r\n  const init = {\r\n    method: 'GET',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`\r\n    }\r\n  };\r\n  const url = `${window.location.protocol}//${window.location.host}/api/balance?${qs.stringify({ token })}`;\r\n  return fetch(url, init)\r\n    .then(response => {\r\n      if (response.ok) return response.json();\r\n      else return { data: { status: false } };\r\n    })\r\n    .then(data => {\r\n      if (data.status === 'ok') {\r\n        const balance = data.balance;\r\n        dispatch({ type: BALANCE, payload: { balance } });\r\n        status = true;\r\n      }\r\n      return status;\r\n    });\r\n};\r\n","import React, { Component, Fragment } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport './main.scss';\r\nimport { balanceHistory } from '../../actions';\r\nimport {format} from \"date-fns\";\r\n\r\n\r\nclass History extends Component {\r\n\r\n\r\n  render() {\r\n\r\n    return this.props.loaded && this.props.history && this.props.history.length > 0 ? <table>\r\n      <thead>\r\n        <tr>\r\n          <th>Дата</th>\r\n          <th>Сумма</th>\r\n          <th>Описание</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n      {this.props.history.map( (t, i) => <tr key={i}>\r\n        <td>{format(t.date * 1000, 'dd.MM.yyyy')}</td>\r\n        <td><span style={ t.type === '+' ? { color: 'green' } : { color: 'red' } }>{t.type}</span>{Math.floor(t.sum)}</td>\r\n        <td>{t.description}</td>\r\n      </tr>)}\r\n      </tbody>\r\n      </table> : null;\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    history: state.balance.history,\r\n    loaded: state.balance.loaded\r\n  }\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  balanceHistory\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(History);\r\n\r\n","import React, { Component, Fragment } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Link } from 'react-router-dom';\r\nimport { Alert, Button, Cell, Div, Group, Input, List, Panel, ScreenSpinner, Tabs, TabsItem, View, Radio} from '@vkontakte/vkui';\r\nimport Slider from '@material-ui/lab/Slider';\r\nimport connectVk from '@vkontakte/vkui-connect';\r\nimport { format } from 'date-fns';\r\nimport './main.scss';\r\nimport { changeTariff, getBalance, getTariff, prolongTariff, setActiveTab, setPopup, tariffState } from '../../actions';\r\nimport PageHeader from './../../components/PageHeader';\r\nimport History from './History';\r\n\r\nclass Balance extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      changeTariff: props.pathname === '/balance/tariff', // флаг изменения тарифа\r\n      newAmount: 2,\r\n      price: 150,\r\n      totalPrice: 0,\r\n      balance: 100,\r\n      maxDiscount: 51, // макс скидка\r\n      discount: 3, // скидка\r\n      disabled: true,\r\n      payment: 0,\r\n      paymentSystem: 'yandex',\r\n      receiver: 41001135399963,\r\n      pathname: props.pathname,\r\n      form: false\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    document.title = \"Баланс\";\r\n    this.props.getTariff()\r\n      .then(status => {\r\n        if (status) this.channelCount(this.props.tariff.amount);\r\n        else this.channelCount(this.state.newAmount);\r\n      });\r\n    // if(\r\n    //     localStorage.balance !== undefined &&\r\n    //     localStorage.payment !== undefined &&\r\n    //     localStorage.newAmount !== undefined\r\n    // ) {\r\n    //     this.setState({\r\n    //         newAmount: localStorage.newAmount\r\n    //     }, this.checkPayment);\r\n    // }\r\n    this.checkPayment();\r\n  }\r\n\r\n  // componentWillReceiveProps(nextProps) {\r\n  //     this.setState({\r\n  //         changeTariff: nextProps.pathname === '/balance/tariff'\r\n  //     });\r\n  // }\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    let newState = {};\r\n    let newProps = {};\r\n    if ((props.pathname === '/balance/tariff') !== state.changeTariff) {\r\n      newState = { ...newState, changeTariff: !state.changeTariff };\r\n    }\r\n    // if(props.order)\r\n    // if (nextProps.pathname !== prevState.pathname) {\r\n    //     newState = { ...newState, pathname: nextProps.pathname };\r\n    // }\r\n    // if (nextProps.balance > 0 && nextProps.tariff && nextProps.tariff.amount !== prevState.newAmount) {\r\n    //     newState = { ...newState, disabled: false };\r\n    // }\r\n    // if (nextProps.balance > 0 && !nextProps.tariff) {\r\n    //     newState = { ...newState, disabled: false };\r\n    // }\r\n    if (Object.keys(newProps).length > 0) props.tariffState(newProps);\r\n    if (Object.keys(newState).length > 0) return newState;\r\n    else return null;\r\n  }\r\n\r\n  popout = () => {\r\n    switch (this.props.popout) {\r\n      case 'hidden':\r\n        return null;\r\n      case 'spinner':\r\n        return <ScreenSpinner />;\r\n      case 'prolong':\r\n        return this.prolongPopup();\r\n      case 'success':\r\n        return this.resultPopup(true);\r\n      case 'failure':\r\n        return this.resultPopup();\r\n      case 'message':\r\n        return this.resultPopup(this.props.message);\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  prolongPopup = () => <Alert onClose={() => this.props.setPopup('hidden')}>\r\n    <Div>\r\n      <Div>Текущий тариф будет продлен на 1 календарныей месяц</Div>\r\n      <Div style={{ display: 'flex' }}>\r\n        <Button\r\n          size=\"l\"\r\n          stretched\r\n          style={{ marginRight: 8 }}\r\n          onClick={this.props.prolongTariff}>Ок</Button>\r\n        <Button size=\"l\" stretched level=\"secondary\" onClick={() => this.props.setPopup('hidden')}>Отмена</Button>\r\n      </Div>\r\n    </Div>\r\n  </Alert>;\r\n\r\n  resultPopup = (msg = false) => {\r\n    setTimeout(() => this.props.setPopup('hidden'), 3000)\r\n    return <Alert onClose={() => this.props.setPopup('hidden')}>\r\n      <Div style={msg ? { color: 'green' } : { color: 'red' }}>\r\n        {msg === true ? 'Успешно!' : msg === false ? 'Что-то пошло не так ☹' : msg}\r\n      </Div>\r\n    </Alert>\r\n  };\r\n\r\n  channelCount = count => {\r\n    let disabled = true;\r\n    if (!this.props.tariff) disabled = false;\r\n    else if (this.props.tariff && +this.props.tariff.amount !== +count) disabled = false;\r\n    let discount = +count > 2 ? (+count - 2) * this.state.discount : 0;\r\n    if (discount > this.state.maxDiscount) discount = this.state.maxDiscount;\r\n    const totalPrice = Math.ceil(this.state.price * (1 + (+count - 2) * (1 - discount / 100)));\r\n    // if (this.props.balance < totalPrice) disabled = true;\r\n    this.setState({\r\n      disabled,\r\n      newAmount: +count,\r\n      totalPrice,\r\n      needPayment: this.props.balance < totalPrice ? totalPrice - Math.floor(this.props.balance) : 0\r\n    })\r\n  };\r\n\r\n  changeTariff = () => {\r\n    if(this.state.needPayment && this.state.needPayment > 0) {\r\n      if(\r\n        localStorage.balance === undefined &&\r\n        localStorage.payment === undefined &&\r\n        localStorage.newAmount === undefined\r\n      ){\r\n        localStorage.balance = this.props.balance;\r\n        localStorage.payment = this.state.needPayment;\r\n        localStorage.newAmount = this.state.newAmount;\r\n      }\r\n      this.setState({payment: this.state.needPayment});\r\n      this.props.setActiveTab('balance', '/balance/payment');\r\n      this.checkPayment()\r\n        .then(() => {\r\n          this.props.setActiveTab('balance', '/balance/tariff');\r\n        });\r\n    } else {\r\n      const newAmount = localStorage.newAmount ? localStorage.newAmount : this.state.newAmount;\r\n      this.props.changeTariff(newAmount)\r\n        .then(status => {\r\n          if (status) this.setState({\r\n            disabled: true\r\n          });\r\n          if(\r\n            localStorage.balance !== undefined &&\r\n            localStorage.payment !== undefined &&\r\n            localStorage.newAmount !== undefined\r\n          ) {\r\n            delete localStorage.balance;\r\n            delete localStorage.payment;\r\n            delete localStorage.newAmount;\r\n          }\r\n          this.props.getTariff()\r\n            .then(status => {\r\n              if (status) this.channelCount(this.props.tariff.amount);\r\n              else this.channelCount(this.state.newAmount);\r\n            });\r\n        });\r\n    }\r\n  };\r\n\r\n  doPayment = () => {\r\n    if (this.state.paymentSystem === 'yandex') {\r\n      this.state.form.submit();\r\n    } else if (this.state.paymentSystem === 'vkpay') {\r\n      connectVk.send(\"VKWebAppOpenPayForm\", {\r\n        app_id: 6958212,\r\n        action: 'pay-to-group',\r\n        params: {\r\n          amount: this.state.payment,\r\n          description: 'пополнение баланса',\r\n          group_id: 158819144\r\n        }\r\n      });\r\n    }\r\n\r\n  };\r\n\r\n  checkPayment = () => {\r\n    if(\r\n      localStorage.balance !== undefined &&\r\n      localStorage.payment !== undefined &&\r\n      localStorage.newAmount !== undefined\r\n    ){\r\n      return new Promise(resolve => {\r\n        const intervalId = setInterval(() => {\r\n          this.props.getBalance()\r\n            .then(status => {\r\n              if (status) {\r\n                if(+this.props.balance >= +localStorage.balance + +localStorage.payment) {\r\n                  this.setState({ needPayment: 0 }, this.changeTariff);\r\n                  if(this.state.intervalId) {\r\n                    clearInterval(this.state.intervalId);\r\n                  }\r\n                  resolve(true);\r\n                }\r\n              }\r\n            });\r\n        }, 1000);\r\n        this.setState({ intervalId });\r\n      });\r\n    }\r\n  };\r\n\r\n  render() {\r\n\r\n    const { tariff, isMobile } = this.props;\r\n    const { needPayment } = this.state;\r\n\r\n    let buttonChangeTariff = 'Подключить тариф';\r\n\r\n    if(tariff){\r\n      if(needPayment && needPayment > 0){\r\n        buttonChangeTariff = 'Пополнить баланс и изменить тариф'\r\n      } else {\r\n        buttonChangeTariff = 'Изменить тариф'\r\n      }\r\n    } else {\r\n      if(needPayment && needPayment > 0){\r\n        buttonChangeTariff = 'Пополнить баланс и подключить тариф'\r\n      } else {\r\n        buttonChangeTariff = 'Подключить тариф'\r\n      }\r\n    }\r\n\r\n    let mainStyles = {\r\n      paddingTop: (isMobile ? 5 : 60),\r\n      paddingBottom: 60,\r\n      color: 'gray'\r\n    };\r\n\r\n    return <View\r\n      activePanel={this.props.activeTab}\r\n      popout={this.popout()}\r\n    >\r\n      <Panel id={this.props.activeTab}>\r\n        <PageHeader />\r\n        <Group\r\n          style={mainStyles}\r\n          className={this.props.activeTab}\r\n        >\r\n          <List style={{paddingBottom: (isMobile ? '60px' : '0px')}}>\r\n            <Cell>\r\n              <Div>\r\n                {this.props.pathname === '/balance' ?\r\n                  <Cell>\r\n                    <Group title=\"Ваш баланс\">\r\n                      <Cell>{Math.floor(this.props.balance)} ₽</Cell>\r\n                      <Div className=\"balance-button\">\r\n                        <Button\r\n                          before=\"\"\r\n                          size=\"l\"\r\n                          onClick={() => this.props.setActiveTab('balance', '/balance/payment')}\r\n                        >Пополнить</Button>\r\n                      </Div>\r\n                    </Group>\r\n                    <Group title=\"Тариф\">\r\n                      <List>\r\n                        {this.props.tariff ?<Fragment>\r\n                            <Cell>Количество каналов: {this.props.tariff.amount}</Cell>\r\n                            <Cell>Тариф действителен до {format(this.props.tariff.end * 1000, 'dd.MM.yyyy')}</Cell>\r\n                          </Fragment>\r\n                          :\r\n                          <Cell multiline>У вас нет активных тарифов</Cell>}\r\n                        <Div className=\"balance-button\">\r\n                          <Button\r\n                            before=\"\"\r\n                            size=\"l\"\r\n                            onClick={() => this.props.setActiveTab('balance', '/balance/tariff')}\r\n                            style={{ marginRight: 5 }}\r\n                          >\r\n                            {this.props.tariff ? 'Изменить' : 'Подключить'}\r\n                          </Button>\r\n                          {this.props.tariff ? <Button\r\n                            before=\"\"\r\n                            size=\"l\"\r\n                            onClick={() => this.props.setPopup('prolong')}\r\n                          >Продлить</Button> : null}\r\n                        </Div>\r\n                      </List>\r\n                    </Group>\r\n                    <Group title=\"История операций\">\r\n                      <Cell multiline>\r\n                        <History />\r\n                      </Cell>\r\n                    </Group>\r\n                  </Cell> : null}\r\n                {this.props.pathname === '/balance/tariff' ?\r\n                  <Div>\r\n                    <Cell><Link className=\"back-link\" to='/balance'>Назад</Link></Cell>\r\n                    <Group title=\"Изменение тарифа\">\r\n                      <Cell multiline>\r\n                        <Div className=\"total_price\">Текущий баланс <span>{Math.floor(this.props.balance)}</span> ₽</Div>\r\n                        <Div>Количество каналов: {this.state.newAmount}</Div>\r\n                        <Div>\r\n                          <Slider\r\n                            classes={{\r\n                              thumb: 'slider-thumb',\r\n                              track: 'slider-track'\r\n                            }}\r\n                            value={+this.state.newAmount}\r\n                            min={2}\r\n                            max={100}\r\n                            step={1}\r\n                            onChange={(event, value) => this.channelCount(value)}\r\n                          />\r\n                        </Div>\r\n                        <Div>Каждый следующий канал уменьшает стоимость на 3%! *</Div>\r\n                        <Div className=\"total_price\">Итого <span>{this.state.totalPrice}</span> ₽</Div>\r\n                        <Div>\r\n                          <Button\r\n                            disabled={this.state.disabled}\r\n                            size=\"l\"\r\n                            onClick={this.changeTariff}>\r\n                            {buttonChangeTariff}\r\n                          </Button>\r\n                        </Div>\r\n                        <Div>* При досрочном изменении тарифа на баланс пользователя возвращается сумма за неиспользованный период</Div>\r\n                      </Cell>\r\n                    </Group>\r\n                  </Div>\r\n                  : null}\r\n                {this.props.pathname === '/balance/payment' ?\r\n                  <Div>\r\n                    <Cell><Link className=\"back-link\"to='/balance'>Назад</Link></Cell>\r\n                    <Group title=\"Пополнение баланса\">\r\n                      <Cell>Текущий баланс: {Math.floor(this.props.balance)} ₽</Cell>\r\n                      <Cell>\r\n                        <Div className=\"money-count-title\">Сумма пополнения в рублях</Div>\r\n                        <Input\r\n                          value={String(this.state.payment)}\r\n                          onChange={e => this.setState({ payment: e.target.value })} />\r\n                      </Cell>\r\n                      <Group title=\"Платежная система\">\r\n                        <Cell multiline>\r\n                          <Tabs type=\"buttons\">\r\n                            <TabsItem\r\n                              onClick={() => this.setState({ paymentSystem: 'yandex' })}\r\n                              selected={this.state.paymentSystem === 'yandex'}\r\n                            >\r\n                              Яндекс.Деньги\r\n                            </TabsItem>\r\n                            <TabsItem\r\n                              onClick={() => {\r\n                                this._form = false;\r\n                                this.setState({ paymentSystem: 'unitpay', form: false });\r\n                              }}\r\n                              selected={this.state.paymentSystem === 'unitpay'}\r\n                            >\r\n                              Unitpay\r\n                            </TabsItem>\r\n                            {this.props.vkApp ? <TabsItem\r\n                              onClick={() => {\r\n                                this._form = false;\r\n                                this.setState({ paymentSystem: 'vkpay', form: false });\r\n                              }}\r\n                              selected={this.state.paymentSystem === 'vkpay'}\r\n                            >\r\n                              VK Pay\r\n                            </TabsItem> : null}\r\n                          </Tabs>\r\n                          {this.state.paymentSystem === 'yandex' ?\r\n                            <Div className=\"payment-system\">\r\n                              <form\r\n                                target=\"_blank\"\r\n                                method=\"POST\"\r\n                                action=\"https://money.yandex.ru/quickpay/confirm.xml\"\r\n                                ref={form => {\r\n                                  if (!this.state.form) this.setState({ form });\r\n                                }}\r\n                              >\r\n                                <input type=\"hidden\" name=\"receiver\" defaultValue={this.state.receiver} />\r\n                                <input type=\"hidden\" name=\"quickpay-form\" value=\"donate\" />\r\n                                <input type=\"hidden\" name=\"targets\" value=\"транзакция\" />\r\n                                <Radio name=\"paymentType\" value=\"PC\" defaultChecked>Яндекс.Деньгами</Radio>\r\n                                <Radio name=\"paymentType\" value=\"AC\">Банковской картой</Radio>\r\n                                <input type=\"hidden\" name=\"sum\" defaultValue={this.state.payment} />\r\n                                <input type=\"hidden\" name=\"label\" defaultValue={this.props.user.user_id} />\r\n                                <input type=\"hidden\" name=\"successURL\" value=\"http://streamvi.ru/balance\" />\r\n                              </form>\r\n                            </Div>\r\n                            : <Div className=\"payment-system\" />}\r\n                          <Button\r\n                            disabled={!(((this.state.paymentSystem === 'yandex' && this.state.form) || (this.state.paymentSystem === 'vkpay' && this.props.vkApp)) && this.state.payment > 0)}\r\n                            size=\"l\"\r\n                            onClick={this.doPayment}>\r\n                            Перейти к оплате\r\n                          </Button>\r\n                        </Cell>\r\n                      </Group>\r\n                    </Group>\r\n                  </Div>\r\n                  : null}\r\n              </Div>\r\n            </Cell>\r\n          </List>\r\n        </Group>\r\n      </Panel>\r\n    </View>\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeTab: state.app.activeTab,\r\n    popout: state.app.popout,\r\n    user: state.app.user,\r\n    message: state.app.message,\r\n    balance: state.balance.balance,\r\n    tariff: state.tariffs.tariff,\r\n    order: state.tariffs.order,\r\n    pathname: state.router.location.pathname,\r\n    vkApp: state.app.vkApp,\r\n    isMobile: state.app.isMobile\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n  changeTariff,\r\n  getBalance,\r\n  getTariff,\r\n  prolongTariff,\r\n  setActiveTab,\r\n  setPopup,\r\n  tariffState\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Balance);\r\n","import Balance from './Balance';\r\n\r\nexport default Balance;","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Group, Panel, ScreenSpinner, View, List } from '@vkontakte/vkui';\r\n\r\nimport User from './../../components/User';\r\nimport PageHeader from './../../components/PageHeader';\r\n\r\nimport './main.scss';\r\n\r\n\r\nclass Account extends Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tdocument.title = 'Аккаунт';\r\n\t}\r\n\r\n\r\n\tpopout = () => {\r\n\t\tconst popup = this.props.popout\r\n\t\tswitch (popup) {\r\n\t\t\tcase 'hidden':\r\n\t\t\t\treturn null;\r\n\t\t\tcase 'spinner':\r\n\t\t\t\treturn <ScreenSpinner />;\r\n\t\t\tdefault:\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\r\n\t\treturn <View\r\n\t\t\tactivePanel={this.props.activeTab}\r\n\t\t\tpopout={this.popout()}\r\n\t\t>\r\n\t\t\t<Panel id={this.props.activeTab}>\r\n\t\t\t\t<PageHeader />\r\n\t\t\t\t<Group\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tpaddingTop: 60,\r\n\t\t\t\t\t\tpaddingBottom: 60,\r\n\t\t\t\t\t\tcolor: 'gray'\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tclassName={this.props.activeTab}\r\n\t\t\t\t>\r\n\t\t\t\t\t<List>\r\n\t\t\t\t\t\t{this.props.user ? <User /> : null}\r\n\t\t\t\t\t</List>\r\n\t\t\t\t</Group>\r\n\t\t\t</Panel>\r\n\t\t</View>\r\n\t}\r\n}\r\n\r\n\r\nconst mapStateToProps = state => {\r\n\treturn {\r\n\t\tuser: state.app.user,\r\n\t\tactiveTab: state.app.activeTab\r\n\t};\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Account);\r\n","import Account from './Account';\r\n\r\nexport default Account;","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Cell, Div, Group, List, Panel, View, PanelHeader, HeaderButton } from '@vkontakte/vkui';\r\nimport PageHeader from './../../components/PageHeader';\r\n\r\nimport { setActiveTab } from './../../actions';\r\n\r\nimport Icon24User from '@vkontakte/icons/dist/24/user';\r\nimport Icon24Users from '@vkontakte/icons/dist/24/users';\r\nimport Icon24BrowserBack from '@vkontakte/icons/dist/24/browser_back';\r\nimport Icon24Coins from '@vkontakte/icons/dist/24/coins';\r\n\r\nimport './main.scss';\r\n\r\nclass Menu extends Component {\r\n    render() {\r\n        const { activeTab, setActiveTab, user, isMobile } = this.props;\r\n\r\n        return  <View activePanel={activeTab}>\r\n                    <Panel id={activeTab}>\r\n                        <PageHeader />\r\n                        <Div className={activeTab}>\r\n                            <Group>\r\n                                <List>\r\n                                    <Cell expandable before={<Icon24Coins />}>\r\n                                        Биржа\r\n                                    </Cell>\r\n                                    <Cell expandable before={<Icon24Users />}>\r\n                                        Видео\r\n                                    </Cell>\r\n                                    <Cell expandable before={<Icon24User />}\r\n                                          onClick={() => setActiveTab('account')}\r\n                                    >\r\n                                        Аккаунт\r\n                                    </Cell>\r\n                                </List>\r\n                            </Group>\r\n                        </Div>\r\n                    </Panel>\r\n                </View>\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        activeTab: state.app.activeTab,\r\n        popout: state.app.popout,\r\n        user: state.app.user,\r\n        isMobile: state.app.isMobile\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n    setActiveTab\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Menu);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Route, Switch, withRouter } from 'react-router-dom';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport connectVk from '@vkontakte/vkui-connect';\r\n\r\nimport { login, getUserChannels, getAvailableChannels, getPurchasedChannels, getTariff, soldStreams, purchasedStreams, setActiveTab, appState, setPopup, newUser, setIsMobile } from './actions';\r\nimport Translations from './Pages/Translations';\r\nimport Video from './Pages/Video';\r\nimport Market from './Pages/Market';\r\nimport Scheduler from './Pages/Sheduler';\r\nimport Partner from './Pages/Partner';\r\nimport Balance from './Pages/Balance';\r\nimport Account from './Pages/Account';\r\nimport Menu from './Pages/Menu';\r\nimport './App.scss';\r\n\r\nclass App extends Component {\r\n\r\n\tcomponentDidMount() {\r\n\r\n\t\tconnectVk.subscribe(e => {\r\n\t\t\tswitch (e.detail.type) {\r\n\t\t\t\tcase 'VKWebAppGetUserInfoResult':\r\n\t\t\t\t\tthis.props.appState({\r\n\t\t\t\t\t\tfetchedUser: e.detail.data,\r\n\t\t\t\t\t\tvkApp: true\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'VKWebAppAccessTokenReceived':\r\n\t\t\t\t\tthis.props.appState({\r\n\t\t\t\t\t\tvk_access_token: e.detail.data.access_token,\r\n\t\t\t\t\t\tvkApp: true\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.props.newUser()\r\n\t\t\t\t\t\t.then(status => {\r\n\t\t\t\t\t\t\tif (status) this.updateInfo();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'VKWebAppOpenPayFormResult':\r\n\t\t\t\t\tconst data = e.detail.data;\r\n\t\t\t\t\tif (data.status) {\r\n\t\t\t\t\t\tthis.props.login();\r\n\t\t\t\t\t\tthis.props.setPopup(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'VKWebAppGetUserInfoFailed':\r\n\t\t\t\t\tconsole.log('error', e.detail.type);\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.log(e.detail.type);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconnectVk.send('VKWebAppGetUserInfo', {});\r\n\r\n\t\tif(!this.props.user) {\r\n\t\t\tthis.props.login()\r\n\t\t\t\t.then(status => {\r\n\t\t\t\t\tif (status) {\r\n\t\t\t\t\t\tthis.updateInfo();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconnectVk.send('VKWebAppGetAuthToken', { \"app_id\": 6958212, \"scope\": \"groups\" });\r\n\t\t\t\t\t\tif (this.props.fetchedUser && this.props.vk_access_token) {\r\n\t\t\t\t\t\t\tthis.props.newUser();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\tif(this.props.pathname) {\r\n\t\t\tif (this.props.pathname === '/') {\r\n\t\t\t\tthis.props.setActiveTab('translations', '/' + this.props.search);\r\n\t\t\t} else {\r\n\t\t\t\tthis.props.setActiveTab(this.props.pathname.split('/')[1], this.props.pathname + this.props.search);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twindow.addEventListener(\"resize\", event => {\r\n\t\t\tlet width = window.innerWidth || document.documentElement.clientWidth || document.getElementsByTagName('body')[0].clientWidth;\r\n\t\t\t(width < 500) ? this.props.setIsMobile(true) : this.props.setIsMobile(false);\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t// setAuth = (user) => {\r\n\t// \tconst { cookies, login } = this.props;\r\n\t// \tcookies.set('token', user.token, { path: '/' });\r\n\t// \tlogin(user, true);\r\n\t// }\r\n\r\n\tupdateInfo = () => {\r\n\t\tthis.props.getUserChannels()\r\n\t\t\t.then(this.props.soldStreams);\r\n\t\tthis.props.getAvailableChannels();\r\n\t\tthis.props.getPurchasedChannels()\r\n\t\t\t.then(this.props.purchasedStreams);\r\n\t\tthis.props.getTariff();\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn !this.props.activeTab ? null : <Switch>\r\n\t\t\t<Route path='/' exact component={Translations} />\r\n\t\t\t<Route path='/services' exact component={Translations} />\r\n\t\t\t<Route path='/groups' exact component={Translations} />\r\n\t\t\t<Route path='/video' exact component={Video} />\r\n\t\t\t<Route path='/video/album/:id' exact component={Video} />\r\n\t\t\t<Route path='/market' exact component={Market} />\r\n\t\t\t<Route path='/schedule' exact component={Scheduler} />\r\n\t\t\t<Route path='/partner' exact component={Partner} />\r\n\t\t\t<Route path='/balance' component={Balance} />\r\n\t\t\t<Route path='/account' exact component={Account} />\r\n\t\t\t<Route path='/menu' exact component={Menu} />\r\n\t\t\t<Route component={Translations} />\r\n\t\t</Switch>;\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n\treturn {\r\n\t\tpopout: state.app.popout,\r\n\t\tuser: state.app.user,\r\n\t\tactiveTab: state.app.activeTab,\r\n\t\tfetchedUser: state.app.fetchedUser,\r\n\t\tvk_access_token: state.app.vk_access_token,\r\n\t\tpathname: state.router.location.pathname,\r\n\t\tsearch: state.router.location.search,\r\n\t\tisMobile: state.app.isMobile\r\n\t};\r\n};\r\n\r\nconst mapDispatchToProps = {\r\n\tlogin,\r\n\tgetAvailableChannels,\r\n\tgetPurchasedChannels,\r\n\tgetTariff,\r\n\tgetUserChannels,\r\n\tsoldStreams,\r\n\tpurchasedStreams,\r\n\tsetActiveTab,\r\n\tappState,\r\n\tsetPopup,\r\n\tnewUser,\r\n\tsetIsMobile\r\n};\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(App));\r\n","import 'core-js/es6/map';\nimport 'core-js/es6/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { ConnectedRouter } from 'connected-react-router';\nimport { configureStore, history } from './configureStore';\nimport connectVk from '@vkontakte/vkui-connect';\nimport App from './App';\n\nconst store = configureStore();\n\n// Init VK App\nconnectVk.send('VKWebAppInit', {});\n\nReactDOM.render(\n  <div className=\"container\" style={{height: '100%'}}>\n    <Provider store={store}>\n      <ConnectedRouter history={history}>\n        <App />\n      </ConnectedRouter>\n    </Provider>\n  </div>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}