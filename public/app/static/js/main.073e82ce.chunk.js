(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{142:function(e,t,a){},210:function(e,t,a){},232:function(e,t,a){e.exports=a(485)},450:function(e,t,a){},453:function(e,t,a){},474:function(e,t,a){},479:function(e,t,a){},481:function(e,t,a){},483:function(e,t,a){},485:function(e,t,a){"use strict";a.r(t);a(233),a(258);var n,r,o=a(0),i=a.n(o),l=a(28),s=a.n(l),c=a(9),p=a(76),u=a(38),d=a(55),m=a(108),h=a(212),f=a(213),y=a(56),b=a(30),v="FETCH_DATA_START",E="FETCH_DATA_END",g={albums:{},albums_index:[]},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"ALBUMS":return Object(b.a)({},e,n);case"SELECT_ALBUM":return Object(b.a)({},e,{albums:Object(b.a)({},e.albums,Object(y.a)({},n,Object(b.a)({},e.albums[n],{checked:!e.albums[n].checked})))});default:return e}},S=a(1),w=function(){return i.a.createElement("div",{style:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%"}},i.a.createElement(S.Spinner,{size:"large",style:{marginTop:30,marginBottom:30}}))},C=i.a.createElement("div",{style:{display:"flex",alignItems:"center",flexDirection:"column",width:"100%"}},i.a.createElement(S.Spinner,{size:"large",style:{marginTop:10,marginBottom:10}})),O=i.a.createElement("div",{style:{marginTop:10,marginBottom:10,fontSize:15,color:"green",textAlign:"center",width:"100%"}},"\u0423\u0441\u043f\u0435\u0448\u043d\u043e!"),T=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return i.a.createElement("div",{style:{marginTop:10,marginBottom:10,color:"red",textAlign:"center",fontSize:15,width:"100%"}},e||"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a \u2639")},A={user:!1,token:!1,popout:"hidden",loadData:!1,process:null,activeTab:!1,updating:0,message:!1},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"SET_STATE":case"SET_POPUP":return Object(b.a)({},e,n);case v:return Object(b.a)({},e,{updating:1,popout:"spinner"});case E:return Object(b.a)({},e,{updating:0,popout:"hidden"});case"LOGIN":return Object(b.a)({},e,n);case"LOGOUT":return Object(b.a)({},e,{user:!1,token:!1});case"START":return Object(b.a)({},e,{process:C});case"SUCCESS":return Object(b.a)({},e,{process:O});case"FAILURE":return Object(b.a)({},e,{process:n?T(n):T()});case"POPUP_SUCCESS":return Object(b.a)({},e,{updating:2,popout:"success"});case"POPUP_FAILURE":return Object(b.a)({},e,{updating:2,popout:"failure"});case"POPUP_MESSAGE":return Object(b.a)({},e,{updating:2,popout:"message"},n);case"CLEAR_STATUS":return Object(b.a)({},e,{process:null});case"ACTIVE_TAB":return Object(b.a)({},e,{activeTab:n});case"IS_MOBILE":return Object(b.a)({},e,{isMobile:n});default:return e}},_={referrals:[],balance:0,profit:0,history:[],loaded:!1},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"REFERRALS":case"BALANCE":return Object(b.a)({},e,n);default:return e}},x={owner:{},owner_index:[],shared:{},shared_index:[],disabled:{},disabled_index:{vk:[],youtube:[],twitch:[],custom:[],ok:[]},available:{},available_index:[],purchased:{},purchased_index:[],loaded:!1},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"USER_CHANNELS":return Object(b.a)({},e,n,{loaded:!0});case"DISABLED_USER_CHANNELS":case"AVAILABLE_CHANNELS":case"FOUND_CHANNELS":case"PURCHASED_CHANNELS":return Object(b.a)({},e,n);case"USERS":return Object(b.a)({},e,{owner:Object(b.a)({},e.owner,Object(y.a)({},n.group_id,Object(b.a)({},e.owner[n.group_id],{users:n.users})))});case"BROADCAST":return Object(b.a)({},e,Object(y.a)({},n.owner,Object(b.a)({},e[n.owner],Object(y.a)({},n.group_id,Object(b.a)({},e[n.owner][n.group_id],{active:+!e[n.owner][n.group_id].active})))));case"CHANNEL_STATE":return Object(b.a)({},e,n);default:return e}},N={sold:[],purchased:[]},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SOLD_STREAMS":return Object(b.a)({},e,{sold:t.payload});case"PURCHASED_STREAMS":return Object(b.a)({},e,{purchased:t.payload});default:return e}},L={tariff:!1,balance:0},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"TARIFF":return Object(b.a)({},e,n);default:return e}},M={video:{},video_index:[],selectedVideos:[],updated:!1,videoId:!1},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"VIDEOS":return Object(b.a)({},e,n,{updated:!0});case"SELECT_VIDEO":case"SELECT_VIDEOS":return Object(b.a)({},e,n);case"EDIT_VIDEO":return Object(b.a)({},e,{videoId:n});default:return e}},U=Object(u.a)(),R=a(57),H=a.n(R),G=a(12),F=a(13),z=a(15),K=a(14),W=a(16),J=a(43),Y=(a(173),a(34)),q=a(31),X=a.n(q),$=a(33),Q=a.n($),Z=function(e){var t=e.method,a=e.url,n=e.token,r=e.body,o=a,i={method:t,headers:{Authorization:"Bearer "+n}};return"GET"===t?r&&(o="".concat(o,"?").concat(Q.a.stringify(Object(b.a)({},r,{token:n})))):"POST"===t&&r&&(i=Object(b.a)({},i,{headers:Object(b.a)({},i.headers,{"Content-Type":"application/x-www-form-urlencoded"}),body:Q.a.stringify(r)})),fetch(o,i).then(function(e){try{return!!e.ok&&e.json()}catch(t){return console.log("request.js catch",t),!1}})},ee=a(29),te=function(e){return function(t){return t({type:"SET_STATE",payload:e})}},ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(a){a(t?Object(ee.d)(t):"translations"===e?Object(ee.d)("/"):Object(ee.d)("/".concat(e))),a({type:"ACTIVE_TAB",payload:e})}},ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(a){return a({type:"SET_POPUP",payload:{popout:e,message:t}})}},re=function(e,t){var a={vk:"VK",youtube:"Youtube",twitch:"Twitch",custom:"\u0421\u0432\u043e\u0439 \u0441\u0435\u0440\u0432\u0435\u0440",ok:"\u041e\u0434\u043d\u043e\u043a\u043b\u0430\u0441\u0441\u043d\u0438\u043a\u0438"};if(e.items&&Object.keys(e.items).length>0){var n=e.items,r={},o=[],i={},l=[],s={},c={vk:[],youtube:[],twitch:[],custom:[],ok:[]},p=0;for(var u in n)if(n.hasOwnProperty(u)){var d="/app/img/logo/custom.png";"vk"===n[u].type&&(d=n[u].photo_50),"youtube"!==n[u].type&&"twitch"!==n[u].type||(d=n[u].photo_default),"ok"===n[u].type&&(d="/app/img/logo/ok.png");var m={group_id:+n[u].group_id,id:n[u].id,name:n[u].name,photo:d,service:a[n[u].type],type:n[u].type,live:+n[u].live};0===+n[u].del?(n[u].owner?(r[u]=Object(b.a)({},m,{users:n[u].users,active:+n[u].active,time:n[u].time,sell:+n[u].sell,price:n[u].price?+n[u].price:0,rtmp:!!n[u].rtmp&&n[u].rtmp,owner:!0}),-1===o.indexOf(+u)&&o.push(+u)):(i[u]=Object(b.a)({},m,{active:+n[u].active,time:n[u].time,rtmp:!!n[u].rtmp,sharedTime:{unlim:+n[u].unlim?1:0,start:n[u].start,end:n[u].end}}),-1===l.indexOf(+u)&&l.push(+u)),Number(n[u].active)&&p++):1===+n[u].del&&(s[u]=m,-1===c[n[u].type].indexOf(+u)&&c[n[u].type].push(+u))}return o.sort(function(e,t){return t-e}),l.sort(function(e,t){return t-e}),{owner:r,owner_index:o,shared:i,shared_index:l,disabled:s,disabled_index:c,numActiveChannels:p}}return{}},oe=function(){return function(e,t){var a=!1;0===t().app.updating&&e({type:v});var n=t().app.token||X.a.get("token");return n?(setInterval(function(){return ie(e,t)},3e4),Z({method:"GET",url:"".concat(window.location.protocol,"//").concat(window.location.host,"/api/groups"),token:n,body:{token:n}}).then(function(n){return console.log("data",n),e({type:"USER_CHANNELS",payload:re(n)}),a=!0,n.addedChannelId&&e({type:"CHANNEL_STATE",payload:{addedChannelId:n.addedChannelId}}),1===t().app.updating&&e({type:E}),a})):(t().app.updating&&e({type:E}),a)}},ie=function(e,t){var a=t().app.token||X.a.get("token");return Z({method:"GET",url:"".concat(window.location.protocol,"//").concat(window.location.host,"/api/groups"),token:a,body:{token:a}}).then(function(t){e({type:"USER_CHANNELS",payload:re(t)})})},le=function(){return function(e,t){var a=!1;t().app.updating||e({type:v});var n=t().app.token||X.a.get("token");return n?Z({method:"GET",url:"".concat(window.location.protocol,"//").concat(window.location.host,"/api/groups"),token:n,body:{token:n,channels:"available"}}).then(function(n){if(n.items){var r=n.items,o={},i=[];for(var l in r)o[l]={group_id:+r[l].group_id,id:r[l].id,price:+r[l].price,name:r[l].name,photo:"vk"===r[l].type?r[l].photo_50:"youtube"===r[l].type?r[l].photo_default:"",service:"vk"===r[l].type?"VK":"youtube"===r[l].type?"Youtube":"",translation:!0,time:r[l].time},-1===i.indexOf(+l)&&i.push(+l);i.sort(function(e,t){return t-e}),e({type:"AVAILABLE_CHANNELS",payload:{available:o,available_index:i}}),a=!0}return t().app.updating&&e({type:E}),a}):(t().app.updating&&e({type:E}),a)}},se=function(){return function(e,t){var a=!1;t().app.updating||e({type:v});var n=t().app.token||X.a.get("token");if(!n)return t().app.updating&&e({type:E}),a;var r={method:"GET",headers:{Authorization:"Bearer ".concat(n)}};return fetch("".concat(window.location.protocol,"//").concat(window.location.host,"/api/market?token=").concat(n),r).then(function(e){if(e.ok)return e.json()}).then(function(n){if(n.purchased){var r=n.purchased,o={},i=n.purchased_index.sort(function(e,t){return t-e});for(var l in r)o[l]={group_id:+r[l].group_id,id:r[l].id,price:+r[l].price,sell:+r[l].sell,name:r[l].name,photo:"vk"===r[l].type?r[l].photo_50:"youtube"===r[l].type?r[l].photo_default:"",service:"vk"===r[l].type?"VK":"youtube"===r[l].type?"Youtube":"",translation:!0,time:r[l].time,rtmp:!!r[l].rtmp&&r[l].rtmp};e({type:"PURCHASED_CHANNELS",payload:{purchased:o,purchased_index:i}}),a=!0}return t().app.updating&&e({type:E}),a})}},ce=function(e){return function(t){return t({type:"CHANNEL_STATE",payload:e})}},pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(a,n){t||(t={action:"search",token:e}),a({type:v});var r={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(e)},body:Q.a.stringify(t)};return fetch("".concat(window.location.protocol,"//").concat(window.location.host,"/api/market"),r).then(function(e){if(e.ok)return e.json()}).then(function(e){if(e.status&&"ok"===e.status){var t=e.items,n={},r=Object.keys(e.items).sort(function(e,t){return t-e});for(var o in t)n[o]={group_id:+t[o].group_id,id:t[o].id,price:+t[o].price,name:t[o].name,photo:"vk"===t[o].type?t[o].photo_50:"youtube"===t[o].type?t[o].photo_default:"",service:"vk"===t[o].type?"VK":"youtube"===t[o].type?"Youtube":"",translation:!0,time:t[o].time};a({type:"FOUND_CHANNELS",payload:{found:n,found_index:r}})}return a({type:E})})}},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t,a){var n=a().channels.owner,r=[];if(0==e){var o=function(e){n[e].time&&n[e].time.length>0&&(r=[].concat(Object(Y.a)(r),Object(Y.a)(n[e].time.map(function(t){return{title:n[e].name,start:new Date(1e3*t.start),end:new Date(1e3*t.end)}}))))};for(var i in n)o(i)}else n[e]&&n[e].time&&n[e].time.length>0&&(r=n[e].time.map(function(t,a){return{title:n[e].time[a].video&&n[e].time[a].video.length>0?n[e].time[a].video.map(function(e){return e.name}).join(", "):"\u043f\u0440\u044f\u043c\u043e\u0439 \u044d\u0444\u0438\u0440",start:new Date(1e3*t.start),end:new Date(1e3*t.end)}}));return t({type:"SOLD_STREAMS",payload:r})}},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t,a){var n=a().channels.purchased,r=[];if(0==e){var o=function(e){n[e].time&&n[e].time.length>0&&(r=[].concat(Object(Y.a)(r),Object(Y.a)(n[e].time.map(function(t){return{title:n[e].name,start:new Date(1e3*t.start),end:new Date(1e3*t.end)}}))))};for(var i in n)o(i)}else n[e]&&n[e].time&&n[e].time.length>0&&(r=n[e].time.map(function(t,a){return{title:n[e].time[a].video&&n[e].time[a].video.length>0?n[e].time[a].video.map(function(e){return e.name}).join(", "):"\u043f\u0440\u044f\u043c\u043e\u0439 \u044d\u0444\u0438\u0440",start:new Date(1e3*t.start),end:new Date(1e3*t.end)}}));return t({type:"PURCHASED_STREAMS",payload:r})}},me=function(){return function(e,t){var a=!1;0===t().app.updating&&e({type:v});var n=t().app.token||X.a.get("token");if(!n)return 1===t().app.updating&&e({type:E}),new Promise(function(e){return e(!1)});var r={method:"GET",headers:{Authorization:"Bearer ".concat(n)}},o="".concat(window.location.protocol,"//").concat(window.location.host,"/api/tariffs?").concat(Q.a.stringify({token:n}));return fetch(o,r).then(function(e){return e.ok?e.json():{status:!1}}).then(function(n){if("ok"===n.status){var r=n.tariff,o=n.balance;e({type:"TARIFF",payload:{tariff:r}}),e({type:"BALANCE",payload:{balance:o}}),a=!0}return 1===t().app.updating&&e({type:E}),a})}},he=function(e){return function(t){t({type:"EDIT_VIDEO",payload:e}),t({type:"SET_POPUP",payload:{popout:"formEditVideo"}})}},fe=function(e){return function(t,a){t({type:v});var n=a().videos,r=n.video,o=n.selectedVideos;r[e].checked=!a().videos.video[e].checked;var i=o.indexOf(e);return r[e].checked?-1===i&&o.push(e):-1!==i&&(o=[].concat(Object(Y.a)(o.slice(0,i)),Object(Y.a)(o.slice(i+1)))),o.sort(function(e,t){return e-t}),setTimeout(function(){return t({type:E})},0),t({type:"SELECT_VIDEO",payload:{video:r,selectedVideos:o}})}},ye=a(88),be=a.n(ye),ve=a(215),Ee=a.n(ve),ge=a(78),ke=a.n(ge),Se=a(89),we=a.n(Se),Ce=a(90),Oe=a.n(Ce),Te=a(143),Ae=a.n(Te),je=a(216),_e=a.n(je),Pe=a(144),xe=a.n(Pe),De=a(109),Ne=a.n(De),Ie=a(110),Le=a.n(Ie),Ve=function(e){function t(){return Object(G.a)(this,t),Object(z.a)(this,Object(K.a)(t).apply(this,arguments))}return Object(W.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e,t=this;return e=this.props.isMobile?i.a.createElement(S.Epic,{activeStory:this.props.activeTab,tabbar:i.a.createElement(S.Tabbar,null,i.a.createElement(S.TabbarItem,{onClick:function(){return t.props.setActiveTab("translations")},selected:"translations"===this.props.activeTab,text:"\u0422\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438"},i.a.createElement(_e.a,null)),i.a.createElement(S.TabbarItem,{onClick:function(){return t.props.setActiveTab("partner")},selected:"partner"===this.props.activeTab,text:"\u041f\u0430\u0440\u0442\u043d\u0435\u0440\u0430\u043c"},i.a.createElement(Ne.a,null)),i.a.createElement(S.TabbarItem,{onClick:function(){return t.props.setActiveTab("balance")},selected:"balance"===this.props.activeTab,text:"\u0411\u0430\u043b\u0430\u043d\u0441"},i.a.createElement(Le.a,null)),i.a.createElement(S.TabbarItem,{onClick:function(){return t.props.setActiveTab("menu")},selected:"menu"===this.props.activeTab,text:"\u041c\u0435\u043d\u044e"},i.a.createElement(Ae.a,null)))}):i.a.createElement(S.FixedLayout,{vertical:"top"},i.a.createElement(S.Tabs,{theme:"header",type:"buttons"},i.a.createElement(S.HorizontalScroll,null,i.a.createElement(S.TabsItem,{onClick:function(){return t.props.setActiveTab("translations")},selected:"translations"===this.props.activeTab},"\u0422\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438"),i.a.createElement(S.TabsItem,{onClick:function(){return t.props.setActiveTab("partner")},selected:"partner"===this.props.activeTab},"\u041f\u0430\u0440\u0442\u043d\u0435\u0440\u0441\u043a\u0430\u044f \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430"),i.a.createElement(S.TabsItem,{onClick:function(){return t.props.setActiveTab("balance")},selected:"balance"===this.props.activeTab},"\u0411\u0430\u043b\u0430\u043d\u0441"),i.a.createElement(S.TabsItem,{onClick:function(){return t.props.setActiveTab("account")},selected:"account"===this.props.activeTab},"\u0410\u043a\u043a\u0430\u0443\u043d\u0442")))),i.a.createElement(o.Fragment,null,i.a.createElement(S.PanelHeader,{noShadow:!0},"StreamVi"),e)}}]),t}(o.Component),Me={setActiveTab:ae},Be=Object(c.c)(function(e){return{activeTab:e.app.activeTab,isMobile:e.app.isMobile}},Me)(Ve),Ue=function(e){var t=e.channelId,a=e.getChannel,n=Re(t);return He({popup:n,getChannel:a}).then(Ge)},Re=function(e){var t=window.screenY+(window.outerHeight-400)/2.5,a=window.screenX+(window.outerWidth-500)/2,n=""===e?"/api/googleoauth":"/api/googleoauth?channel="+e;return window.open("".concat(window.location.protocol,"//streamvi.ru").concat(n),"_blank","menubar=no,toolbar=no,status=no,width=500,height=400,top="+t+",left="+a)},He=function(e){var t=e.popup,a=e.getChannel;return new Promise(function(e,n){var r=setInterval(function(){t&&!t.closed||clearInterval(r);try{"/success.html"===t.location.pathname&&e({popup:t,getChannel:a,interval:r})}catch(n){}},500)})},Ge=function(e){var t=e.popup,a=e.getChannel,n=e.interval;a(),clearInterval(n),t.close()},Fe={fb:"fb",twitch:"twitch",youtube:"googleoauth"},ze=function(e){var t=Ke(e);return We(t).then(Je)},Ke=function(e){var t=window.screenY+(window.outerHeight-400)/2.5,a=window.screenX+(window.outerWidth-500)/2,n="/api/".concat(Fe[e]);return window.open("".concat(window.location.protocol,"//streamvi.ru").concat(n),"_blank","menubar=no,toolbar=no,status=no,width=500,height=400,top="+t+",left="+a)},We=function(e){return new Promise(function(t){var a=setInterval(function(){e&&!e.closed||clearInterval(a);try{"/success.html"===e.location.pathname&&t({popup:e,interval:a})}catch(n){}},100)})},Je=function(e){var t=e.popup,a=e.interval;if(t&&a)return clearInterval(a),t.close(),!0},Ye=function(e,t,a){return i.a.createElement(S.PopoutWrapper,null,i.a.createElement(S.FormLayout,{onSubmit:function(e){return e.preventDefault()},className:"popup"},i.a.createElement(S.Div,{style:{textAlign:"center"}},e),i.a.createElement(S.Div,{style:{display:"flex"}},i.a.createElement(S.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:t},"\u041e\u043a"),i.a.createElement(S.Button,{size:"l",stretched:!0,level:"secondary",onClick:a},"\u041e\u0442\u043c\u0435\u043d\u0430"))))},qe=a(105),Xe=a.n(qe),$e=a(217),Qe=a.n($e),Ze=a(35),et=a(50),tt=a(292),at=a(487),nt=a(486),rt=a(49),ot=a.n(rt),it=function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(z.a)(this,Object(K.a)(t).call(this,e))).showInfo=function(){a.props.updateData(a.props.id),a.setState({show:!a.state.show})},a.changePrice=function(e){a.setState({price:e.target.value,disabled:!1})},a.rtmpUrl=function(e){var t=ke.a.parse(e.target.value);if(t.hostname&&t.path&&t.protocol){var n=Object(b.a)({},a.state.rtmp,{domain:t.hostname,query:t.path});t.port&&(n.port=t.port),a.setState({rtmp:n,isValidRtmpUrl:"valid"})}else a.setState({isValidRtmpUrl:"error"})},a.rtmpKey=function(e){if(""!==e.target.value.trim()){var t=Object(b.a)({},a.state.rtmp,{name:e.target.value});a.setState({rtmp:t,isValidRtmpKey:"valid"})}else a.setState({isValidRtmpKey:"error"})},a.saveChanges=function(){if(a.props.id){var e={group_id:a.props.id,price:a.state.price?a.state.price:0,sell:a.state.sell?1:0,action:"update"};a.state.rtmp&&(e.rtmp=JSON.stringify(a.state.rtmp)),a.props.data.name!==a.state.customChannelName&&(e.name=a.state.customChannelName),a.setState({disabled:!0}),a.props.saveChanges(e).then(function(e){"POPUP_SUCCESS"===e.type&&a.props.getUserChannels()})}},a.enableBroadcast=function(e){e.stopPropagation();var t=a.props.data,n=t.type,r=t.rtmp,o=t.active;if(a.props.id&&(a.props.numActiveChannels<a.props.tariff.amount&&0===+o||1===+o))if(!n||"vk"!==n&&"custom"!==n||r){var i={group_id:a.props.id,broadcast:+!o,owner:a.props.type};a.props.enableBroadcast(i).then(function(e){})}else a.props.type&&"owner"===a.props.type&&a.props.rtmpError("owner"),a.props.type&&"shared"===a.props.type&&a.props.rtmpError("shared");else a.props.numActiveChannels>=a.props.tariff.amount&&0===+o&&(a.props.paymentPopup(),a.props.appState({popout:"confirm"}))},a.deleteChannel=function(){a.props.id&&a.props.token&&a.props.deleteChannel(a.props.token,a.props.id).then(function(e){"SUCCESS"===e.type&&a.props.getUserChannels()}),a.setState({show:!a.state.show})},a.changeTimeStart=function(e){Object(tt.a)(a.state.timeEnd)<=Object(tt.a)(e)&&a.setState({timeEnd:new Date(e.getTime()+36e5)}),a.setState({timeStart:e,access:!1})},a.changeTimeEnd=function(e){Object(tt.a)(a.state.timeStart)>=Object(tt.a)(e)&&a.setState({timeStart:new Date(e.getTime()-36e5)}),a.setState({timeEnd:e,access:!1})},a.addUser=function(){var e={access:"add"};if(a.props.id&&a.state.vk_id){var t=ke.a.parse(a.state.vk_id).pathname.split("/");e.group_id=a.props.id,e.vk_id=1===t.length?t[0]:t[1],!a.state.unlim&&a.state.timeEnd>a.state.timeStart&&(e.time_start=Object(at.a)(a.state.timeStart),e.time_end=Object(at.a)(a.state.timeEnd)),a.setState({access:!0}),a.props.addUser(e).then(function(e){e&&a.setState({access:!1,vk_id:""})})}},a.timeNow=new Date,a.state={isValidRtmpUrl:"default",isValidRtmpKey:"default",rtmp:!(!e.data||!e.data.rtmp)&&e.data.rtmp,show:!0,sell:e.data&&e.data.sell?e.data.sell:null,enabledForMe:e.data&&e.data.active?!!e.data.active:null,price:e.data&&e.data.price?e.data.price:null,editAccess:!1,users:{},error:{},disabled:!1,vk_id:"",unlim:!0,minutesStep:15,timeStart:a.timeNow,timeEnd:a.timeNow,access:!1,isValidLink:"default",customChannelName:e.data&&e.data.name?a.props.data.name:""},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"componentWillMount",value:function(){this.props.data||this.props.setActiveTab("translations")}},{key:"render",value:function(){var e=this,t=this.props.data||{},a=!1,n=!1;if(t.rtmp){var r=t.rtmp;r.domain&&(a="rtmp://".concat(r.domain).concat(r.port?":"+r.port:"").concat(r.query)),r.name&&(n=r.name)}var l=this.state,s=l.timeStart,c=l.timeEnd,p=l.minutesStep,u=l.customChannelName,d=this.props,m=(d.activeTab,d.setActiveTab,d.appState,i.a.createElement("span",{className:"status ".concat(t.live?"live":"offline"),title:t.live?"\u0418\u0434\u0435\u0442 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u044f":"Offline"}));return this.props.titleOnly?i.a.createElement(S.Cell,{before:i.a.createElement(S.Avatar,{size:40,src:t.photo}),onClick:function(){e.props.setActiveTab("channel-settings"),e.showInfo()},size:"l",bottomContent:t.service},m," ",t.name):i.a.createElement(o.Fragment,null,"owner"===this.props.type||"shared"===this.props.type?i.a.createElement(S.List,null,i.a.createElement("div",null,this.state.show?i.a.createElement("div",null,i.a.createElement(S.Cell,{onClick:function(){window.open("https://vk.com/club".concat(t.id),"_blank")},before:i.a.createElement(S.Avatar,{size:40,src:t.photo}),size:"l",bottomContent:t.service},m," ",t.name),i.a.createElement(S.Cell,null,t&&t.owner?i.a.createElement(S.FormLayout,{className:"trnslatSet"},!t.type||"vk"!==t.type&&"ok"!==t.type&&"custom"!==t.type?null:i.a.createElement("div",null,i.a.createElement("div",{className:"title-wrapper"},i.a.createElement("span",{className:"trnslatSet-title"},"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438"),i.a.createElement("span",{className:"trnslatSet-title"},i.a.createElement(Qe.a,{onClick:function(){return e.props.deleteChannel(e.props.id)}}))),i.a.createElement(S.FormLayout,null,"custom"===t.type||"ok"===t.type?i.a.createElement(S.Input,{top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u043d\u0430\u043b\u0430",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",onChange:function(t){return e.setState({customChannelName:t.target.value,disabled:!1})},defaultValue:u}):null,i.a.createElement(S.Input,{top:"\u0410\u0434\u0440\u0435\u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430",placeholder:"RTMP URL",defaultValue:a||null,onChange:this.rtmpUrl,status:this.state.isValidRtmpUrl,bottom:"error"===this.state.isValidRtmpUrl?"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 rtmp-\u0441\u0435\u0440\u0432\u0435\u0440\u0430":null,type:"text"}),i.a.createElement(S.Input,{top:"\u041a\u043b\u044e\u0447 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438",placeholder:"RTMP KEY",onChange:this.rtmpKey,defaultValue:n||null,status:this.state.isValidRtmpKey,bottom:"error"===this.state.isValidRtmpKey?"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043a\u043b\u044e\u0447 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438":null,type:"text"}))),this.props.process,i.a.createElement(S.Div,{style:{display:"flex",justifyContent:"center",paddingTop:"0px"}},i.a.createElement(S.Button,{size:"l",stretched:!0,style:{maxWidth:"200px",paddingTop:"0px"},onClick:this.saveChanges,disabled:this.state.disabled||"valid"!==this.state.isValidRtmpUrl||"valid"!==this.state.isValidRtmpKey,className:"stvi-btn-main"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))):t.sharedTime?i.a.createElement(o.Fragment,null,i.a.createElement("span",{style:{display:"block",color:"green"}},"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f:"),t.sharedTime.unlim?i.a.createElement("span",{style:{display:"block",color:"green"}},"\u043d\u0435\u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u043e"):i.a.createElement("div",{style:{color:"green"}},Object(nt.a)(1e3*t.sharedTime.start,"dd.MM.yyyy HH:mm"),"\xa0\xa0-\xa0\xa0",Object(nt.a)(1e3*t.sharedTime.end,"dd.MM.yyyy HH:mm"))):null,i.a.createElement(S.Div,{style:{display:"flex",flexDirection:"row",alignItems:"center"}},i.a.createElement(S.Switch,{checked:!!t.active,onChange:this.enableBroadcast}),i.a.createElement("span",{style:{marginLeft:"15px"}},"\u0422\u0440\u0430\u043d\u0441\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c")))):null),this.props.tariff?i.a.createElement("div",null,i.a.createElement(S.Cell,{multiline:!0},i.a.createElement(S.Div,{className:"translation__item-header"},i.a.createElement("span",null,"\u0412\u044b\u0434\u0430\u0447\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u0430")),i.a.createElement(S.FormLayout,null,i.a.createElement(S.Input,{onChange:function(t){var a=-1!==t.target.value.search(/https:\/\/vk\.com\/[_\-\d\w]+/i)?"valid":"error";e.setState({vk_id:t.target.value,access:!1,isValidLink:a})},type:"text",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044c \u0412\u043a\u043e\u043d\u0442\u0430\u043a\u0442\u0435",value:this.state.vk_id?this.state.vk_id:"",status:this.state.isValidLink,bottom:"error"===this.state.isValidLink?"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u043f\u0440\u043e\u0444\u0438\u043b\u044f":null}),i.a.createElement(S.Checkbox,{defaultChecked:!this.state.unlim,onChange:function(){return e.setState({unlim:!e.state.unlim})}},"\u0412\u0440\u0435\u043c\u044f"),this.state.unlim?null:i.a.createElement("div",{className:"date-time"},i.a.createElement(Ze.c,{utils:et.a,locale:ot.a},i.a.createElement(Ze.b,{keyboard:!0,ampm:!1,label:"\u043e\u0442",onError:console.log,minDate:this.timeNow,value:s,onChange:this.changeTimeStart,format:"dd.MM.yyyy HH:mm",disableOpenOnEnter:!0,mask:[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/],minutesStep:p,cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430"}),i.a.createElement(Ze.b,{keyboard:!0,ampm:!1,label:"\u0434\u043e",onError:console.log,minDate:this.timeNow,value:c,onChange:this.changeTimeEnd,format:"dd.MM.yyyy HH:mm",disableOpenOnEnter:!0,mask:[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/],minutesStep:p,cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430"}))),i.a.createElement(S.Button,{disabled:this.state.access||"valid"!==this.state.isValidLink,onClick:function(t){t.preventDefault(),e.addUser()},level:"outline"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")),t.users?t.users.map(function(t,a){return i.a.createElement(S.Cell,{before:i.a.createElement(S.Avatar,{size:40,src:t.photo}),key:a,removable:!0,bottomContent:t.time_start&&t.time_end?Object(nt.a)(1e3*t.time_start,"dd.MM.yyyy HH:mm")+" \u2014 "+Object(nt.a)(1e3*t.time_end,"dd.MM.yyyy HH:mm"):"\u0432\u0440\u0435\u043c\u044f \u043d\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043e",size:"l",onRemove:function(){return e.props.removeUser(t.user_id,e.props.id)}},t.name+" "+t.surname)}):null)):null):i.a.createElement(S.List,null,this.state.show?i.a.createElement("div",null,t.time?i.a.createElement(S.Cell,{className:"content"},"available"===this.props.type?i.a.createElement("span",{style:{display:"block",color:"red"}},"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0435 \u0434\u043b\u044f \u043f\u043e\u043a\u0443\u043f\u043a\u0438 \u0432\u0440\u0435\u043c\u044f:"):i.a.createElement("span",{style:{display:"block",color:"green"}},"\u041e\u043f\u043b\u0430\u0447\u0435\u043d\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f:"),t.time.map(function(t,a){return i.a.createElement("div",{key:a,style:"available"===e.props.type?{color:"red"}:{color:"green"}},Object(nt.a)(1e3*t.start,"dd.MM.yyyy HH:mm"),"\xa0\xa0-\xa0\xa0",Object(nt.a)(1e3*t.end,"dd.MM.yyyy HH:mm"))})):null):null))}}]),t}(o.Component),lt={addUser:function(e){return function(t,a){a().app.updating||t({type:v});var n=!1,r=a().app.token||X.a.get("token");if(!r)return t({type:E}),new Promise(function(e){return e(n)});var o="".concat(window.location.protocol,"//").concat(window.location.host,"/api/groups"),i={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(Object(b.a)({},e,{token:r}))};return fetch(o,i).then(function(e){return!!e.ok&&e.json()}).then(function(e){return e&&(t({type:"USERS",payload:e}),n=!0),a().app.updating&&t({type:E}),n})}},appState:te,channelState:ce,enableBroadcast:function(e){return function(t,a){a().app.updating||t({type:v});var n=!1,r=a().app.token||X.a.get("token");if(!r)return t({type:E}),new Promise(function(e){return e(n)});var o="".concat(window.location.protocol,"//").concat(window.location.host,"/api/groups"),i={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(Object(b.a)({},e,{token:r}))};return fetch(o,i).then(function(e){return!!e.ok&&e.json()}).then(function(r){return r&&r.status&&"ok"===r.status&&(t({type:"BROADCAST",payload:e}),1===+e.broadcast?t({type:"CHANNEL_STATE",payload:{numActiveChannels:++a().channels.numActiveChannels}}):0===+e.broadcast&&t({type:"CHANNEL_STATE",payload:{numActiveChannels:--a().channels.numActiveChannels}}),n=!0),a().app.updating&&t({type:E}),n})}},getUserChannels:oe,removeUser:function(e,t){return function(a,n){n().app.updating||a({type:v});var r=!1,o=n().app.token||X.a.get("token");if(!o)return a({type:E}),new Promise(function(e){return e(r)});var i="".concat(window.location.protocol,"//").concat(window.location.host,"/api/groups"),l={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},body:JSON.stringify({user_id:e,group_id:t,access:"delete",token:o})};return fetch(i,l).then(function(e){return!!e.ok&&e.json()}).then(function(e){return e&&(a({type:"USERS",payload:e}),r=!0),n().app.updating&&a({type:E}),r})}},saveChanges:function(e){return function(t,a){a().app.updating||t({type:v});var n=a().app.token||X.a.get("token");if(!n)return new Promise(function(e){return e(t({type:"POPUP_FAILURE"}))});var r={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(Object(b.a)({},e,{token:n}))};return fetch("".concat(window.location.protocol,"//").concat(window.location.host,"/api/groups"),r).then(function(e){return e.ok?e.json():{status:!1}}).then(function(e){var a=e.status;return setTimeout(function(){return t({type:"CLEAR_STATUS"})},1500),t("ok"===a?{type:"POPUP_SUCCESS"}:{type:"POPUP_FAILURE"})})}},setActiveTab:ae,setPopup:ne},st=Object(c.c)(function(e){return{token:e.app.token,process:e.app.process,tariff:e.tariffs.tariff,numActiveChannels:e.channels.numActiveChannels}},lt)(it),ct=(a(450),function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(z.a)(this,Object(K.a)(t).call(this,e))).updateData=function(e){a.setState({channelId:e})},a.popout=function(){var e,t;switch(a.props.popup&&(e=a.props.popup.msg,t=a.props.popup.type),a.props.popout){case"hidden":return null;case"spinner":return i.a.createElement(S.ScreenSpinner,null);case"success":return a.resultPopup(!0);case"failure":return a.resultPopup();case"owner":return a.rtmpError("owner");case"shared":return a.rtmpError("shared");case"popup":return a.popup(e,t);case"copied":return a.copied();case"confirm":return Ye(a.popupMsg,a.confirmFn,function(){return a.props.setPopup("hidden")});default:return null}},a.deleteChannel=function(e){a.popupMsg="\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043a\u0430\u043d\u0430\u043b?",a.confirmFn=function(){return a.props.deleteChannel(a.props.token,e).then(function(e){"SUCCESS"===e.type&&a.props.getUserChannels().then(function(){a.props.setActiveTab("translations"),a.props.setPopup("hidden")})})},a.props.setPopup("confirm")},a.paymentPopup=function(){a.popupMsg="\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442 \u043b\u0438\u043c\u0438\u0442 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043a\u0430\u043d\u0430\u043b\u043e\u0432! \u0416\u0435\u043b\u0430\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0442\u0430\u0440\u0438\u0444?",a.confirmFn=function(){return a.props.setActiveTab("balance","/balance/tariff")},a.props.setPopup("confirm")},a.resultPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return setTimeout(function(){return a.props.setPopup("hidden")},2e3),i.a.createElement(S.Alert,{onClose:function(){return a.props.setPopup("hidden")}},i.a.createElement(S.Div,{style:e?{color:"green"}:{color:"red"}},e?"\u0423\u0441\u043f\u0435\u0448\u043d\u043e!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a \u2639"))},a.copied=function(){return setTimeout(function(){return a.props.setPopup("hidden")},2e3),i.a.createElement(S.Alert,{onClose:function(){return a.props.setPopup("hidden")}},i.a.createElement(S.Div,{style:{color:"green"}},"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e!"))},a.popup=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=a.props.appState;return setTimeout(function(){return n({popout:"hidden"})},2e3),i.a.createElement(S.Alert,{onClose:function(){return n({popout:"hidden"})}},i.a.createElement(S.Div,{style:{color:t?"green":"red",textAlign:"center"}},e))},a.rtmpError=function(e){return setTimeout(function(){return a.props.setPopup("hidden")},5e3),i.a.createElement(S.Alert,{onClose:function(){return a.props.setPopup("hidden")}},i.a.createElement(S.Div,{style:{color:"red"}},{owner:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 rtmp-\u0441\u0435\u0440\u0432\u0435\u0440\u0430!",shared:"\u0412\u043b\u0430\u0434\u0435\u043b\u0435\u0446 \u043a\u0430\u043d\u0430\u043b\u0430 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043b \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 rtmp-\u0441\u0435\u0440\u0432\u0435\u0440\u0430, \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u044f \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0430!"}[e]))},a.getChannel=function(){a.props.token&&(a.props.getUserChannels(),a.props.getAvailableChannels())},a.authorize=function(){var e=a.state.channelType;e&&"vk"!==e&&ze(e).then(a.getChannel)},a.addUserGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(a.props.token&&a.state.channelType){var t=a.state.channelId?a.state.channelId:"";if(console.log("this.state.channelId",a.state.channelId),e){if("youtube"===a.state.channelType){if(t){var n=ke.a.parse(t).pathname.split("/");t=1===n.length?n[0]:n[2]}Ue({channelId:t,getChannel:a.getChannel})}}else Z({method:"GET",url:"".concat(window.location.protocol,"//").concat(window.location.host,"/api/channel/add"),token:a.props.token,body:{type:a.state.channelType,channelId:t,token:a.props.token}}).then(function(){a.props.getUserChannels().then(function(){a.props.setActiveTab("channel-settings"),a.props.channelState({addedChannelId:!1})})})}},a.displayChannels=function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all"){case"owner":return a.props.owner_index.length>0?i.a.createElement(o.Fragment,null,a.props.owner_index.filter(function(e){return!!a.props.owner[e].live}).map(function(e){return i.a.createElement(S.Group,{key:e,title:"",className:"group-block"},i.a.createElement(st,{key:e,id:e,type:"owner",data:a.props.owner[e],rtmpError:a.props.setPopup,updateData:a.updateData,titleOnly:!0}))}),a.props.owner_index.filter(function(e){return!a.props.owner[e].live}).map(function(e){return i.a.createElement(S.Group,{key:e,title:"",className:"group-block"},i.a.createElement(st,{key:e,id:e,type:"owner",data:a.props.owner[e],rtmpError:a.props.setPopup,updateData:a.updateData,titleOnly:!0}))})):i.a.createElement(S.Cell,null,"\u0412\u044b \u043d\u0435 \u0434\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u043d\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u043a\u0430\u043d\u0430\u043b\u0430");case"shared":return a.props.shared_index.length>0?a.props.shared_index.map(function(e){return i.a.createElement(S.Group,{key:e,title:"",className:"group-block"},i.a.createElement(st,{key:e,id:e,type:"shared",data:a.props.shared[e],rtmpError:a.props.setPopup,channelSettings:a.state.channelSettings}))}):i.a.createElement(S.Cell,null,"\u041f\u043e\u0445\u043e\u0436\u0435 \u043d\u0435\u0442 \u043a\u0430\u043d\u0430\u043b\u043e\u0432 \u0441 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u043c \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u043c");case"purchased":return a.props.purchased_index.length>0?a.props.purchased_index.map(function(e){return i.a.createElement(S.Group,{key:e,title:"",className:"group-block"},i.a.createElement(st,{key:e,type:"purchased",data:a.props.purchased[e],id:e}))}):i.a.createElement(S.Cell,null,"\u041e\u043f\u043b\u0430\u0447\u0435\u043d\u043d\u044b\u0445 \u043a\u0430\u043d\u0430\u043b\u043e\u0432 \u043d\u0435\u0442");case"all":return i.a.createElement(o.Fragment,null,a.props.owner_index.filter(function(e){return a.props.owner[e].live}).map(function(e){return i.a.createElement(S.Group,{key:e,title:"",className:"group-block"},i.a.createElement(st,{key:e,id:e,type:"owner",data:a.props.owner[e],rtmpError:a.props.setPopup,updateData:a.updateData,titleOnly:!0}))}),a.props.shared_index.filter(function(e){return a.props.shared[e].live}).map(function(e){return i.a.createElement(S.Group,{key:e,title:"",className:"group-block"},i.a.createElement(st,{key:e,id:e,type:"shared",data:a.props.shared[e],rtmpError:a.props.setPopup,channelSettings:a.state.channelSettings}))}),a.props.owner_index.filter(function(e){return!a.props.owner[e].live}).map(function(e){return i.a.createElement(S.Group,{key:e,title:"",className:"group-block"},i.a.createElement(st,{key:e,id:e,type:"owner",data:a.props.owner[e],rtmpError:a.props.setPopup,updateData:a.updateData,titleOnly:!0}))}),a.props.shared_index.filter(function(e){return!a.props.shared[e].live}).map(function(e){return i.a.createElement(S.Group,{key:e,title:"",className:"group-block"},i.a.createElement(st,{key:e,id:e,type:"shared",data:a.props.shared[e],rtmpError:a.props.setPopup,channelSettings:a.state.channelSettings}))}),a.props.purchased_index.map(function(e){return i.a.createElement(S.Group,{key:e,title:"",className:"group-block"},i.a.createElement(st,{key:e,type:"purchased",data:a.props.purchased[e],id:e}))}));default:return i.a.createElement(S.Cell,null,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u0437 \u0432\u044b\u043f\u0430\u0434\u0430\u044e\u0449\u0435\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430")}},a.rtmpColsdHandler=function(){a.setState({rtmpColsd:!a.state.rtmpColsd})},a.state={display:"all",channelId:!1,channelType:!1,type:{vk:{name:"\u0412\u043a\u043e\u043d\u0442\u0430\u043a\u0442\u0435",logo:"/app/img/logo/vk.png",active:!0},youtube:{name:"YouTube",logo:"/app/img/logo/youtube.png",active:!0},fb:{name:"Facebook",logo:"/app/img/logo/fb.png"},ok:{name:"\u041e\u0434\u043d\u043e\u043a\u043b\u0430\u0441\u0441\u043d\u0438\u043a\u0438",logo:"/app/img/logo/ok.png"},twitch:{name:"Twitch",logo:"/app/img/logo/twitch.png",active:!0},custom:{name:"\u0421\u0432\u043e\u0439 RTMP-\u0441\u0435\u0440\u0432\u0435\u0440",logo:"/app/img/logo/custom.png"}},rtmpColsd:!0},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){document.title="\u0422\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438",console.log("this.props.pathname",this.props.pathname),console.log("this.state.channelId",this.state.channelId),this.props.pathname&&("/groups"!==this.props.pathname||this.state.channelType||this.props.setActiveTab("services"),"/channel-settings"!==this.props.pathname||this.state.channelId||this.props.setActiveTab("translations"))}},{key:"render",value:function(){var e=this,t=this.props,a=t.activeTab,n=t.setActiveTab,r=t.disabled,l=t.disabled_index,s=t.isMobile,c=t.updateStreamKey,p=this.state.channelType,u={paddingTop:s?10:60,paddingBottom:60,color:"gray"};return i.a.createElement(S.View,{activePanel:a,popout:this.popout()},i.a.createElement(S.Panel,{id:"translations"},i.a.createElement(Be,null),i.a.createElement(S.Group,{style:u,className:a},i.a.createElement(S.List,null,this.props.user.rtmp?i.a.createElement(S.Cell,null,i.a.createElement(S.Group,{className:this.state.rtmpColsd?"rtmp-wrapper collapsed":"rtmp-wrapper",onClick:this.rtmpColsdHandler},i.a.createElement("div",{className:"rtmp-wrapper__title"},i.a.createElement("span",{className:"title"},"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 rtmp-\u0441\u0435\u0440\u0432\u0435\u0440\u0430"),i.a.createElement(Ee.a,null)),i.a.createElement(S.FormLayout,{className:"input-copy"},i.a.createElement(S.Input,{top:"rtmp-\u0441\u0435\u0440\u0432\u0435\u0440 \u0434\u043b\u044f \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438",disabled:!0,value:this.props.user.rtmp.url}),i.a.createElement(Oe.a,{className:"input-copy__icon",text:this.props.user.rtmp.url,onCopy:function(){return e.props.setPopup("copied")}},i.a.createElement(we.a,{onClick:function(e){return e.stopPropagation()}}))),i.a.createElement(S.FormLayout,{className:"input-copy"},i.a.createElement(S.Input,{top:i.a.createElement("span",null,"\u041a\u043b\u044e\u0447 ",i.a.createElement(S.Button,{className:"get-new-key__button",level:"tertiary",onClick:function(e){e.stopPropagation(),c()}},"\u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439")),disabled:!0,value:this.props.user.rtmp.name}),i.a.createElement(Oe.a,{className:"input-copy__icon",text:this.props.user.rtmp.name,onCopy:function(){return e.props.setPopup("copied")}},i.a.createElement(we.a,{onClick:function(e){return e.stopPropagation()}}))))):null,i.a.createElement(S.Cell,null,i.a.createElement(S.Group,{className:"channels",title:i.a.createElement(o.Fragment,null,i.a.createElement("div",null,"\u041a\u0430\u043d\u0430\u043b\u044b"),i.a.createElement(S.Select,{defaultValue:this.state.display,onChange:function(t){return e.setState({display:t.target.value})}},i.a.createElement("option",{value:"all"},"\u0432\u0441\u0435"),i.a.createElement("option",{value:"owner"},"\u043c\u043e\u0438"),i.a.createElement("option",{value:"shared"},"\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435"),i.a.createElement("option",{value:"purchased"},"\u043f\u0440\u0438\u043e\u0431\u0440\u0435\u0442\u0435\u043d\u043d\u044b\u0435")),i.a.createElement(S.Button,{level:"tertiary",onClick:function(){n("services")}},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u043d\u0430\u043b"))},this.props.loaded?this.displayChannels(this.state.display):null))))),i.a.createElement(S.Panel,{id:"services"},i.a.createElement(S.PanelHeader,{theme:"alternate",left:i.a.createElement(S.HeaderButton,{onClick:function(){return n("translations")}},i.a.createElement(be.a,null)),addon:i.a.createElement(S.HeaderButton,{onClick:function(){return n("translations")}},"\u041d\u0430\u0437\u0430\u0434")},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0435\u0440\u0432\u0438\u0441"),i.a.createElement(S.Group,{style:{paddingTop:10,paddingBottom:10,color:"gray",height:"-webkit-fill-available"},className:a},i.a.createElement(S.List,null,i.a.createElement(S.Cell,null,i.a.createElement(S.Group,{title:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u044b"},i.a.createElement(S.List,null,Object.keys(this.state.type).map(function(t,a){return i.a.createElement(S.Cell,{key:a,before:i.a.createElement(S.Avatar,{type:"app",src:e.state.type[t].logo}),multiline:!1,onClick:function(){e.setState({channelType:t}),n("groups")}},e.state.type[t].name)}))))))),i.a.createElement(S.Panel,{id:"groups"},i.a.createElement(S.PanelHeader,{theme:"alternate",left:i.a.createElement(S.HeaderButton,{onClick:function(){return n("services")}},i.a.createElement(be.a,null)),addon:i.a.createElement(S.HeaderButton,{onClick:function(){return n("services")}},"\u041d\u0430\u0437\u0430\u0434")},"custom"===p||"ok"===p?"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043d\u043e\u0432\u043e\u0433\u043e \u043a\u0430\u043d\u0430\u043b\u0430":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u0440\u0443\u043f\u043f\u0443"),i.a.createElement(S.Group,{style:{paddingTop:10,paddingBottom:10,color:"gray"},className:a},i.a.createElement(S.List,null,i.a.createElement(S.Cell,null,!p||"custom"!==p&&"ok"!==p?i.a.createElement(S.Group,{title:p?"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043a\u0430\u043d\u0430\u043b\u044b/\u0433\u0440\u0443\u043f\u043f\u044b ".concat(this.state.type[p].name):"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u043a\u0430\u043d\u0430\u043b\u044b/\u0433\u0440\u0443\u043f\u043f\u044b"},i.a.createElement(S.List,null,p&&l[p]&&l[p].length>0?l[p].map(function(t){return i.a.createElement(S.Cell,{key:t,before:i.a.createElement(S.Avatar,{type:"app",src:r[t].photo}),multiline:!1,onClick:function(){e.setState({channelId:t},e.addUserGroup)}},r[t].name)}):p&&!this.props.user.token[p]?i.a.createElement(S.Div,null,i.a.createElement(S.Button,{onClick:this.authorize,disabled:!this.state.type[p].active},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0432 ",this.state.type[p].name)):p?i.a.createElement(S.Div,null,"\u041d\u0435\u0442 \u043a\u0430\u043d\u0430\u043b\u043e\u0432 \u0434\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f"):null)):i.a.createElement(mt,{channelType:p,updateData:this.updateData}))))),i.a.createElement(S.Panel,{id:"channel-settings"},i.a.createElement(S.PanelHeader,{theme:"alternate",left:i.a.createElement(S.HeaderButton,{onClick:function(){return n("translations")}},i.a.createElement(be.a,null))},"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043a\u0430\u043d\u0430\u043b\u0430"),i.a.createElement(st,{key:this.state.channelId,id:this.state.channelId,type:"owner",data:this.props.owner[this.state.channelId],rtmpError:this.props.setPopup,updateData:this.updateData,deleteChannel:this.deleteChannel,paymentPopup:this.paymentPopup})))}}]),t}(o.Component)),pt={appState:te,deleteChannel:function(e,t){return function(a){a({type:"START"});var n={action:"delete",group_id:t,token:e},r={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(e)},body:Q.a.stringify(n)};return fetch("".concat(window.location.protocol,"//").concat(window.location.host,"/api/groups"),r).then(function(e){if(e.ok)return e.json()}).then(function(e){return setTimeout(function(){return a({type:"CLEAR_STATUS"})},1500),e.status&&"ok"===e.status?a({type:"SUCCESS"}):a({type:"FAILURE"})})}},setPopup:ne,getUserChannels:oe,getAvailableChannels:le,setActiveTab:ae,channelState:ce,updateStreamKey:function(){return function(e,t){t().app.updating||e({type:v});var a=!1,n=t().app.token||X.a.get("token");if(!n)return e({type:E}),new Promise(function(e){return e(a)});var r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n})},o="".concat(window.location.protocol,"//").concat(window.location.host,"/api/key");return fetch(o,r).then(function(e){return e.ok?e.json():{data:{status:!1}}}).then(function(n){if(console.log(n),n.rtmp){var r=t().app.user,o=n.rtmp;e({type:"SET_STATE",payload:{user:Object(b.a)({},r,{rtmp:o})}}),e({type:"POPUP_SUCCESS"}),a=!0}else e({type:"POPUP_FAILURE"});return 1===t().app.updating&&e({type:E}),a})}}},ut=Object(c.c)(function(e){return{token:e.app.token,user:e.app.user,activePanel:e.app.activePanel,activeTab:e.app.activeTab,popout:e.app.popout,popup:e.app.popup,owner:e.channels.owner,owner_index:e.channels.owner_index,addedChannelId:e.channels.addedChannelId,shared:e.channels.shared,shared_index:e.channels.shared_index,disabled:e.channels.disabled,disabled_index:e.channels.disabled_index,available:e.channels.available,available_index:e.channels.available_index,purchased:e.channels.purchased,purchased_index:e.channels.purchased_index,loaded:e.channels.loaded,pathname:e.router.location.pathname,isMobile:e.app.isMobile}},pt)(ct),dt=function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(z.a)(this,Object(K.a)(t).call(this,e))).setRtmp=function(e){var t=e.target.value.trim();a.setState({rtmp:t}),t.match(/^rtmp:\/\/[\S]+\/[\S]*$/i)?a.setState({rtmpStatus:"valid"}):a.setState({rtmpStatus:"error"})},a.setKey=function(e){var t=e.target.value.trim();a.setState({key:t}),""!==t.trim()?a.setState({keyStatus:"valid"}):a.setState({keyStatus:"error"})},a.addCustomRtmp=function(){var e=a.state.type;if("valid"===a.state.rtmpStatus&&"error"!==a.state.rtmpStatus){var t=ke.a.parse(a.state.rtmp),n={};t.hostname&&(n.domain=t.hostname),t.port&&(n.port=t.port),t.path&&(n.query=t.path),n.name=a.state.key;var r={rtmp:n,type:e};""!==a.state.name.trim()&&(r.name=a.state.name.trim()),a.props.addCustomRtmp(r).then(function(){var e=a.props,t=e.addedChannelId,n=e.channelState,r=e.setActiveTab,o=e.updateData;t?(o(t),r("channel-settings"),n({addedChannelId:!1})):r("translations")})}},a.state={rtmp:"",rtmpStatus:"default",key:"",keyStatus:"default",name:"",typeName:e.channelType&&"ok"===e.channelType?"\u041e\u0434\u043d\u043e\u043a\u043b\u0430\u0441\u0441\u043d\u0438\u043a\u0438":"\u0421\u0432\u043e\u0439 RTMP-\u0441\u0435\u0440\u0432\u0435\u0440",type:e.channelType?e.channelType:"custom"},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(S.Group,{title:this.state.typeName},i.a.createElement(S.FormLayout,null,i.a.createElement(S.Input,{top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:this.state.name,placeholder:"\u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c\u0441\u044f \u0432 \u0441\u043f\u0438\u0441\u043a\u0435 \u0432\u0430\u0448\u0438\u0445 \u043a\u0430\u043d\u0430\u043b\u043e\u0432",onChange:function(t){return e.setState({name:t.target.value})}}),i.a.createElement(S.Input,{top:"rtmp-\u0441\u0435\u0440\u0432\u0435\u0440 \u0434\u043b\u044f \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438",value:this.state.rtmp,placeholder:"\u0410\u0434\u0440\u0435\u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430",onChange:this.setRtmp,status:this.state.rtmpStatus,bottom:"error"===this.state.rtmpStatus?"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 rtmp-\u0441\u0435\u0440\u0432\u0435\u0440\u0430":null}),i.a.createElement(S.Input,{value:this.state.key,placeholder:"\u041a\u043b\u044e\u0447",onChange:this.setKey,status:this.state.keyStatus,bottom:"error"===this.state.keyStatus?"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447":null}),i.a.createElement(S.Button,{onClick:this.addCustomRtmp,disabled:!("valid"===this.state.rtmpStatus&&"valid"===this.state.keyStatus)},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")))}}]),t}(o.Component),mt=Object(c.c)(function(e){return{addedChannelId:e.channels.addedChannelId}},{addCustomRtmp:function(e){return function(t,a){a().app.updating||t({type:v});var n=a().app.token||X.a.get("token");if(!n)return setTimeout(function(){return t({type:"CLEAR_STATUS"})},1500),new Promise(function(e){return e(t({type:"POPUP_FAILURE"}))});var r={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(Object(b.a)({},e,{token:n,action:"add_rtmp"}))};return fetch("".concat(window.location.protocol,"//").concat(window.location.host,"/api/groups"),r).then(function(e){return!!e.ok&&e.json()}).then(function(e){e&&(t({type:"USER_CHANNELS",payload:re(e)}),e.addedChannelId&&t({type:"CHANNEL_STATE",payload:{addedChannelId:e.addedChannelId}})),1===a().app.updating&&t({type:E})})}},setActiveTab:ae,channelState:ce})(dt),ht=ut,ft=a(226),yt=a.n(ft),bt=a(227),vt=a.n(bt),Et=a(228),gt=a.n(Et),kt=function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(z.a)(this,(e=Object(K.a)(t)).call.apply(e,[this].concat(r)))).logout=function(){X.a.remove("token"),a.props.logout(),window.location.assign("/")},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this.props.user;return e&&!this.props.vkApp?i.a.createElement(S.Div,{className:"user"},i.a.createElement(S.Cell,{style:{padding:"0px 15px"},before:i.a.createElement(S.Avatar,{src:e.photo}),asideContent:i.a.createElement(S.Button,{onClick:this.logout,level:"outline",style:{marginLeft:"12px"}},"\u0412\u044b\u0439\u0442\u0438")},e.first_name+" "+e.last_name)):null}}]),t}(o.Component),St={logout:function(){return function(e){return e({type:"LOGOUT"})}}},wt=Object(c.c)(function(e){return{user:e.app.user,vkApp:e.app.vkApp}},St)(kt),Ct=a(229),Ot=a.n(Ct),Tt=(a(142),function(e){function t(){return Object(G.a)(this,t),Object(z.a)(this,Object(K.a)(t).apply(this,arguments))}return Object(W.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this,t=+this.props.id,a=this.props.video,n=a.preview,r=a.name,o=a.checked;return i.a.createElement("div",{className:"video-item"},i.a.createElement("div",{className:"preview",onClick:function(){return e.props.selectVideo(t)}},i.a.createElement(S.Checkbox,{checked:!!o,onChange:function(){return e.props.selectVideo(t)}}),i.a.createElement("img",{src:"/upload/thumbnails/"+n,alt:""})),i.a.createElement(S.Cell,{asideContent:i.a.createElement("div",{onClick:function(){return e.props.editVideo(t)}},i.a.createElement(Ot.a,null))},r))}}]),t}(o.Component)),At={editVideo:he,selectVideo:fe},jt=Object(c.c)(function(e,t){return{video:e.videos.video[t.id]}},At)(Tt),_t=function(e){function t(){return Object(G.a)(this,t),Object(z.a)(this,Object(K.a)(t).apply(this,arguments))}return Object(W.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this.props,t=e.showAlbum,a=e.selectAlbum,n=this.props.data,r=n.id,o=n.name,l=n.preview,s=n.countVideo,c=n.checked;return i.a.createElement("div",{className:"album"},i.a.createElement("div",{className:"preview"},i.a.createElement(S.Checkbox,{onClick:function(){return a(+r)},defaultChecked:!!c}),i.a.createElement("div",{className:"quantity"},s),i.a.createElement("img",{src:"/upload/thumbnails/"+l,onClick:function(){return t(+r)},alt:""})),i.a.createElement("div",{className:"album_name",onClick:function(){return t(+r)}},o))}}]),t}(i.a.Component),Pt=function(e){function t(){var e;return Object(G.a)(this,t),(e=Object(z.a)(this,Object(K.a)(t).call(this))).popout=function(){switch(e.props.popout){case"hidden":return null;case"spinner":return i.a.createElement(S.ScreenSpinner,null);case"formAddAlbum":return e.formAddAlbum;case"formEditAlbum":return e.formEditAlbum();case"formAddVideo":return e.formAddVideo;case"formEditVideo":return e.formEditVideo();default:return null}},e.formAddAlbum=i.a.createElement(S.PopoutWrapper,{v:"center",h:"center"},i.a.createElement(S.FormLayout,{className:"popup"},i.a.createElement(S.Input,{top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",alignment:"left",onChange:function(t){e.setState({newAlbum:t.target.value})}}),i.a.createElement(S.Div,{style:{display:"flex"}},i.a.createElement(S.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:function(){return e.addAlbum()}},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),i.a.createElement(S.Button,{size:"l",stretched:!0,level:"secondary",onClick:function(){e.setState({newAlbum:!1}),e.props.setPopup("hidden")}},"\u041e\u0442\u043c\u0435\u043d\u0430")))),e.formEditAlbum=function(){if(e.state.albumId){var t=e.state.albumId,a=e.props.album[t];return i.a.createElement(S.PopoutWrapper,{v:"center",h:"center"},i.a.createElement(S.FormLayout,{className:"popup"},i.a.createElement(S.Input,{top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",defaultValue:a.name,alignment:"left",onChange:function(a){var n={id:t,name:a.target.value};e.setState({editAlbum:n})}}),i.a.createElement(S.Link,{onClick:function(){e.deleteAlbum(),e.props.setPopup("hidden"),e.setState({showAlbum:"all"})},style:{marginLeft:20}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),i.a.createElement(S.Div,{style:{display:"flex"}},i.a.createElement(S.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:function(){e.editAlbum(),e.props.setPopup("hidden")}},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),i.a.createElement(S.Button,{size:"l",stretched:!0,level:"secondary",onClick:function(){e.setState({editAlbum:!1}),e.props.setPopup("hidden")}},"\u041e\u0442\u043c\u0435\u043d\u0430"))))}return null},e.formAddVideo=i.a.createElement(S.PopoutWrapper,null,i.a.createElement(S.FormLayout,{onSubmit:function(t){return e.addVideo(t)},getRef:function(t){return e.newVideoForm=t},className:"popup"},i.a.createElement(S.File,{name:"video",before:i.a.createElement(gt.a,null),size:"xl",level:"2"}),i.a.createElement(S.Input,{top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435, \u0435\u0441\u043b\u0438 \u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c, \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u043f\u043e\u0434 \u0438\u043c\u0435\u043d\u0435\u043c \u0444\u0430\u0439\u043b\u0430",alignment:"left",name:"display_name"}),i.a.createElement(S.Div,{style:{display:"flex"}},i.a.createElement(S.Button,{size:"l",stretched:!0,style:{marginRight:8}},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"),i.a.createElement(S.Button,{size:"l",stretched:!0,level:"secondary",onClick:function(){return e.props.setPopup("hidden")}},"\u041e\u0442\u043c\u0435\u043d\u0430")))),e.formEditVideo=function(){var t=e.props.videoId;if(t){var a=e.props,n=a.video,r=a.album,o=a.album_index;return i.a.createElement(S.PopoutWrapper,{v:"center",h:"center"},i.a.createElement(S.FormLayout,{className:"popup"},i.a.createElement(S.Input,{top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",defaultValue:n[t].name,alignment:"left",name:"display_name",onChange:function(t){return e.setState({newVideoName:t.target.value})}}),i.a.createElement(S.Select,{top:"\u0410\u043b\u044c\u0431\u043e\u043c",placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0430\u043b\u044c\u0431\u043e\u043c",defaultValue:n[t].album?n[t].album:null,name:"album",alignment:"left",onChange:function(t){return e.setState({newVideoAlbum:t.target.value})}},o.map(function(e){return i.a.createElement("option",{key:e,value:e},r[e].name)})),i.a.createElement(S.Link,{onClick:function(){return e.deleteVideo(t)},style:{marginLeft:20}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),i.a.createElement(S.Div,{style:{display:"flex"}},i.a.createElement(S.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:e.editVideo},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),i.a.createElement(S.Button,{size:"l",stretched:!0,level:"secondary",onClick:function(){e.setState({newVideoAlbum:!1,newVideoName:!1}),e.props.editVideo(!1),e.props.setPopup("hidden")}},"\u041e\u0442\u043c\u0435\u043d\u0430"))))}return null},e.showAlbum=function(t){e.setState({showAlbum:t,albumId:t}),e.props.setActiveTab("video","/video/album/"+t)},e.showAll=function(){e.setState({showAlbum:"all",albumId:!1}),e.props.setActiveTab("video")},e.startBroadcast=function(){return e.setState({showAlbum:"broadcast"})},e.addAlbum=function(){e.state.newAlbum&&e.props.addAlbum(e.state.newAlbum)},e.editAlbum=function(){e.state.editAlbum&&e.state.editAlbum.name.trim()!==e.props.album[e.state.editAlbum.id].name&&e.props.editAlbum(e.state.editAlbum.id,e.state.editAlbum.name)},e.deleteAlbum=function(){e.props.deleteAlbum(e.state.showAlbum)},e.addVideo=function(t){if(t.preventDefault(),e.props.token&&e.newVideoForm){var a=new FormData(e.newVideoForm);a.append("token",e.props.token),a.append("action","upload"),e.props.addVideo(e.props.token,a)}},e.editVideo=function(){var t=e.props.videoId;if(t||e.props.setPopup("hidden"),void 0!==e.props.token){var a=e.state.newVideoName?e.state.newVideoName:e.props.video[t].name,n=0;void 0===e.state.newVideoAlbum?e.props.video[t].album&&(n=e.props.video[t].album):""!==e.state.newVideoAlbum&&(n=e.state.newVideoAlbum);var r={id:t,display_name:a,album:n,action:"update"};e.props.editVideoApi(r).then(e.props.getAlbums)}},e.deleteVideo=function(t){e.props.deleteVideo(t).then(e.props.getAlbums)},e.selectChannel=function(t){var a=e.state.selectedChannels.indexOf(t);-1===a?e.setState({selectedChannels:[].concat(Object(Y.a)(e.state.selectedChannels),[t])}):e.setState({selectedChannels:[].concat(Object(Y.a)(e.state.selectedChannels.slice(0,a)),Object(Y.a)(e.state.selectedChannels.slice(a+1)))})},e.selectStream=function(t){var a=e.state.selectedStreams.indexOf(t);-1===a?e.setState({selectedStreams:[].concat(Object(Y.a)(e.state.selectedStreams),[t])}):e.setState({selectedStreams:[].concat(Object(Y.a)(e.state.selectedStreams.slice(0,a)),Object(Y.a)(e.state.selectedStreams.slice(a+1)))})},e.setVideos2Streams=function(){if(e.props.token&&e.props.selectedVideos&&e.state.selectedStreams&&e.props.selectedVideos.length>0&&e.state.selectedStreams.length>0){var t=e.props.token,a={action:"video2stream",token:t,videos:e.props.selectedVideos.join(","),channels:e.state.selectedChannels.join(","),streams:e.state.selectedStreams.join(",")};e.props.setVideos2Streams(t,a)}},e.changeTimeStart=function(t){Object(tt.a)(e.state.timeEnd)<=Object(tt.a)(t)&&e.setState({timeEnd:new Date(t.getTime()+36e5)}),e.setState({timeStart:t}),e.setState({changed:!0})},e.changeTimeEnd=function(t){Object(tt.a)(e.state.timeStart)>=Object(tt.a)(t)&&e.setState({timeStart:new Date(t.getTime()-36e5)}),e.setState({timeEnd:t}),e.setState({changed:!0})},e.timeNow=new Date,e.state={showAlbum:"all",selectedChannels:[],selectedStreams:[],timeStart:e.timeNow,timeEnd:e.timeNow,changed:!1,minutesStep:15},e}return Object(W.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.title="\u0412\u0438\u0434\u0435\u043e",this.props.updated||(this.props.getVideos(),this.props.getAlbums().then(function(t){if(t&&e.props.album_index.length>0){var a=e.props.match.params.id;a&&"number"===typeof+a&&e.props.album[a]&&e.setState({albumId:a,showAlbum:a})}}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.video,n=t.video_index,r=t.album,l=t.album_index;return i.a.createElement(S.View,{activePanel:this.props.activeTab,popout:this.popout()},i.a.createElement(S.Panel,{id:this.props.activeTab},i.a.createElement(Be,null),i.a.createElement(S.Group,{style:{paddingTop:60,paddingBottom:60,color:"gray"},className:this.props.activeTab},this.props.user?i.a.createElement(wt,null):null,"all"!==this.state.showAlbum?i.a.createElement(S.Div,null,i.a.createElement(S.Link,{onClick:this.showAll},"\u041a \u0441\u043f\u0438\u0441\u043a\u0443 \u0430\u043b\u044c\u0431\u043e\u043c\u043e\u0432")):null,"broadcast"!==this.state.showAlbum?i.a.createElement(S.Div,null,i.a.createElement(S.Button,{before:i.a.createElement(yt.a,null),size:"l",onClick:function(){return e.props.setPopup("formAddVideo")},style:{marginRight:5}},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u0438\u0434\u0435\u043e"),"all"===this.state.showAlbum?i.a.createElement(S.Button,{before:i.a.createElement(vt.a,null),size:"l",onClick:function(){return e.props.setPopup("formAddAlbum")}},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u043b\u044c\u0431\u043e\u043c"):null):null,"broadcast"===this.state.showAlbum?i.a.createElement(S.Div,null,i.a.createElement(S.FormLayout,null,i.a.createElement(S.Header,null,"\u0422\u0440\u0430\u043d\u0441\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0438\u0434\u0435\u043e"),this.props.owner_index&&this.props.owner_index.length>0?i.a.createElement(o.Fragment,null,i.a.createElement(S.Header,{level:"2"},"\u041c\u043e\u0438 \u043a\u0430\u043d\u0430\u043b\u044b"),this.props.owner_index.map(function(t){return i.a.createElement(S.Cell,{key:t,before:i.a.createElement(S.Avatar,{type:"image",src:e.props.owner[t].photo}),asideContent:i.a.createElement(S.Checkbox,{onClick:function(){return e.selectChannel(t)},disabled:!0}),size:"l",multiline:!0,description:e.props.owner[t].time?"\u041f\u0440\u043e\u0434\u0430\u043d\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f":null,bottomContent:e.props.owner[t].time&&e.props.owner[t].time.length>0?e.props.owner[t].time.map(function(t,a){return i.a.createElement("div",{key:a,style:{display:"flex",alignItems:"center"}},Object(nt.a)(1e3*t.start,"dd.MM.yy HH:mm"),"\xa0\xa0-\xa0\xa0",Object(nt.a)(1e3*t.end,"dd.MM.yy HH:mm"),i.a.createElement(S.Checkbox,{onClick:function(){return e.selectStream(t.id)}}))}):null},e.props.owner[t].name)})):null,this.props.purchased_index&&this.props.purchased_index.length>0?i.a.createElement(o.Fragment,null,i.a.createElement(S.Header,{level:"2"},"\u041a\u0443\u043f\u043b\u0435\u043d\u043d\u044b\u0435 \u043a\u0430\u043d\u0430\u043b\u044b"),this.props.purchased_index.map(function(t){return i.a.createElement(S.Cell,{key:t,before:i.a.createElement(S.Avatar,{type:"image",src:e.props.purchased[t].photo}),asideContent:i.a.createElement(S.Checkbox,{disabled:!0,onClick:function(){return e.selectChannel(t)}}),size:"l",multiline:!0,description:e.props.purchased[t].time?"\u041a\u0443\u043f\u043b\u0435\u043d\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f":null,bottomContent:e.props.purchased[t].time&&e.props.purchased[t].time.length>0?e.props.purchased[t].time.map(function(t,a){return i.a.createElement("div",{key:a,style:{display:"flex",alignItems:"center"}},Object(nt.a)(1e3*t.start,"dd.MM.yy HH:mm"),"\xa0\xa0-\xa0\xa0",Object(nt.a)(1e3*t.end,"dd.MM.yy HH:mm"),i.a.createElement(S.Checkbox,{onClick:function(){return e.selectStream(t.id)}}))}):null},e.props.purchased[t].name)})):null,i.a.createElement(S.Checkbox,{onClick:function(){return e.setState({toLoop:!e.state.toLoop})},defaultChecked:!!this.state.toLoop},"\u0417\u0430\u0446\u0438\u043a\u043b\u0438\u0442\u044c"),i.a.createElement(S.Checkbox,{onClick:function(){return e.setState({setTime:!e.state.setTime})},defaultChecked:!!this.state.setTime},"\u0423\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0440\u0435\u043c\u044f"),this.state.setTime?i.a.createElement("div",{className:"date-time"},i.a.createElement(Ze.c,{utils:et.a,locale:ot.a},i.a.createElement(Ze.b,{keyboard:!0,ampm:!1,label:"\u043e\u0442",onError:console.log,minDate:this.timeNow,value:this.state.timeStart,onChange:this.changeTimeStart,format:"dd.MM.yyyy HH:mm",disableOpenOnEnter:!0,mask:[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/],minutesStep:this.state.minutesStep,cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430"}),i.a.createElement(Ze.b,{keyboard:!0,ampm:!1,label:"\u0434\u043e",onError:console.log,minDate:this.timeNow,value:this.state.timeEnd,onChange:this.changeTimeEnd,format:"dd.MM.yyyy HH:mm",disableOpenOnEnter:!0,mask:[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/],minutesStep:this.state.minutesStep,cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430"}))):null,i.a.createElement(S.Checkbox,{onClick:function(){return e.setState({block:!e.state.block})},defaultChecked:!!this.state.block},"\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u0434\u0440\u0443\u0433\u0438\u0445 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0439"),this.props.process,i.a.createElement(S.Div,{style:{display:"flex"}},i.a.createElement(S.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:this.setVideos2Streams},"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c"),i.a.createElement(S.Button,{size:"l",stretched:!0,level:"secondary",onClick:this.showAll},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c")))):"all"===this.state.showAlbum?i.a.createElement("div",null,i.a.createElement(S.Group,{title:"\u0410\u043b\u044c\u0431\u043e\u043c\u044b"},i.a.createElement(S.Div,null,l.map(function(t){return i.a.createElement(_t,{key:t,data:r[t],showAlbum:e.showAlbum,selectAlbum:e.props.selectAlbum})}))),i.a.createElement(S.Group,{title:"\u0412\u0438\u0434\u0435\u043e"},i.a.createElement(S.Div,null,n.map(function(e){return i.a.createElement(jt,{key:e,id:e})})))):i.a.createElement(S.Group,null,i.a.createElement(S.Cell,{asideContent:i.a.createElement(S.Button,{size:"l",onClick:function(){return e.props.setPopup("formEditAlbum")}},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c")},i.a.createElement("h2",null,r[this.state.showAlbum].name)),i.a.createElement(S.Div,null,n.filter(function(t){return a[t].album&&+a[t].album===+e.state.showAlbum}).map(function(e){return i.a.createElement(jt,{key:e,id:e})}))),"broadcast"!==this.state.showAlbum?i.a.createElement(S.FixedLayout,{className:"fixedfooter",vertical:"bottom"},i.a.createElement(S.Cell,{className:"container",asideContent:"\u0412\u044b\u0431\u0440\u0430\u043d\u043e: ".concat(this.props.selectedVideos.length)},i.a.createElement(S.Button,{onClick:this.startBroadcast,size:"l"},"\u0422\u0440\u0430\u043d\u0441\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c"))):null)))}}]),t}(o.Component),xt={addAlbum:function(e){return function(t,a){var n=!1;a().app.updating||t({type:v});var r=a().app.token||X.a.get("token");if(!r)return a().app.updating&&t({type:E}),n;var o={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(r)},body:Q.a.stringify({token:r,name:e})},i="".concat(window.location.protocol,"//").concat(window.location.host,"/api/albums");return fetch(i,o).then(function(e){return!!e.ok&&e.json()}).then(function(e){if(e.items){var r=e.items,o=Object.keys(e.items).sort(function(e,t){return t-e});t({type:"ALBUMS",payload:{albums:r,albums_index:o}}),n=!0}return a().app.updating&&t({type:E}),n})}},addVideo:function(e,t){return function(a){a({type:v}),"Bearer ".concat(e);var n={method:"POST",body:t};return fetch("".concat(window.location.protocol,"//").concat(window.location.host,"/api/videos"),n).then(function(e){if(e.ok)return e.json()}).then(function(e){if(e.items){var t=e.items,n=Object.keys(t).sort(function(e,t){return t-e});a({type:"VIDEOS",payload:{video:t,video_index:n}})}return a({type:E})})}},editVideo:he,editVideoApi:function(e){return function(t,a){t({type:v});var n=a().app.token||X.a.get("token");if(!n)return t({type:E});var r=e;r.token=n;var o={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(n)},body:Q.a.stringify(r)};return fetch("".concat(window.location.protocol,"//").concat(window.location.host,"/api/videos"),o).then(function(e){if(e.ok)return e.json()}).then(function(e){if(e.items){var a=e.items,n=Object.keys(a).sort(function(e,t){return t-e});t({type:"VIDEOS",payload:{video:a,video_index:n}})}return t({type:E})})}},deleteVideo:function(e){return function(t,a){t({type:v});var n=a().app.token||X.a.get("token");return n?Z({method:"GET",url:"".concat(window.location.protocol,"//").concat(window.location.host,"/api/videos"),token:n,body:{token:n,id:e,action:"delete"}}).then(function(e){if(e.items){var a=e.items,n=Object.keys(a).sort(function(e,t){return t-e});t({type:"VIDEOS",payload:{video:a,video_index:n}})}return t({type:E})}):t({type:E})}},deleteAlbum:function(e){return function(t,a){var n=!1;a().app.updating||t({type:v});var r=a().app.token||X.a.get("token");if(!r)return a().app.updating&&t({type:E}),n;var o={method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/x-www-form-urlencoded"},body:Q.a.stringify({token:r,id:e,action:"delete"})},i="".concat(window.location.protocol,"//").concat(window.location.host,"/api/albums");return fetch(i,o).then(function(e){return!!e.ok&&e.json()}).then(function(e){if(e.items){var r=e.items,o=Object.keys(e.items).sort(function(e,t){return t-e});t({type:"ALBUMS",payload:{albums:r,albums_index:o}}),n=!0}return a().app.updating&&t({type:E}),n})}},editAlbum:function(e,t){return function(a,n){var r=!1;n().app.updating||a({type:v});var o=n().app.token||X.a.get("token");if(!o)return n().app.updating&&a({type:E}),r;Z({method:"GET",url:"".concat(window.location.protocol,"//").concat(window.location.host,"/api/albums"),token:o,body:{token:o,id:e,name:t}}).then(function(e){if(e.items){var t=e.items,o=Object.keys(e.items).sort(function(e,t){return t-e});a({type:"ALBUMS",payload:{albums:t,albums_index:o}}),r=!0}return n().app.updating&&a({type:E}),r})}},getAlbums:function(){return function(e,t){var a=!1;t().app.updating||e({type:v});var n=t().app.token||X.a.get("token");if(!n)return t().app.updating&&e({type:E}),new Promise(function(e){return e(a)});var r={method:"GET",headers:{Authorization:"Bearer ".concat(n)}},o="".concat(window.location.protocol,"//").concat(window.location.host,"/api/albums?token=").concat(n);return fetch(o,r).then(function(e){return!!e.ok&&e.json()}).then(function(n){if(n&&n.items){var r=n.items,o=Object.keys(n.items).sort(function(e,t){return t-e});e({type:"ALBUMS",payload:{albums:r,albums_index:o}}),a=!0}return t().app.updating&&e({type:E}),a})}},getVideos:function(){return function(e,t){var a=!1;t().app.updating||e({type:v});var n=t().app.token||X.a.get("token");return n?Z({method:"GET",url:"".concat(window.location.protocol,"//").concat(window.location.host,"/api/videos"),token:n,body:{token:n}}).then(function(n){if(n.items){var r=n.items,o=Object.keys(r).sort(function(e,t){return t-e});e({type:"VIDEOS",payload:{video:r,video_index:o}}),a=!0}return t().app.updating&&e({type:E}),a}):(t().app.updating&&e({type:E}),a)}},setPopup:ne,selectAlbum:function(e){return function(t,a){t({type:v});var n=!a().albums.albums[e].checked;t({type:"SELECT_ALBUM",payload:+e});var r=a().videos,o=r.video,i=r.selectedVideos;for(var l in o)if(o[l].album&&+o[l].album===+e){o[l].checked=n;var s=i.indexOf(+l);n?-1===s&&i.push(+l):-1!==s&&(i=[].concat(Object(Y.a)(i.slice(0,s)),Object(Y.a)(i.slice(s+1))))}return setTimeout(function(){return t({type:E})},0),t({type:"SELECT_VIDEOS",payload:{video:o,selectedVideos:i}})}},selectVideo:fe,setVideos2Streams:function(e,t){return function(a){a({type:"START"});var n="".concat(window.location.protocol,"//").concat(window.location.host,"/api/videos"),r={method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/x-www-form-urlencoded"},body:Q.a.stringify(t)};return fetch(n,r).then(function(e){if(e.ok)return e.json()}).then(function(e){return setTimeout(function(){return a({type:"CLEAR_STATUS"})},1500),e.status&&"ok"==e.status?a({type:"SUCCESS"}):a({type:"FAILURE"})})}},setActiveTab:ae},Dt=Object(c.c)(function(e){return{token:e.app.token,user:e.app.user,process:e.app.process,activeTab:e.app.activeTab,popout:e.app.popout,videoId:e.videos.videoId,video:e.videos.video,video_index:e.videos.video_index,selectedVideos:e.videos.selectedVideos,updated:e.videos.updated,album:e.albums.albums,album_index:e.albums.albums_index,owner:e.channels.owner,owner_index:e.channels.owner_index,purchased:e.channels.purchased,purchased_index:e.channels.purchased_index}},xt)(Pt),Nt=a(112),It=a(291),Lt=function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(z.a)(this,Object(K.a)(t).call(this,e))).selectChannel=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?(a.getStreamTime(e),a.setState({select:!a.state.select,id:e})):a.setState({select:!a.state.select,id:!a.state.id})},a.buyStreamTime=function(e){e.preventDefault(),a.setState({disabled:!0});var t=[];if(Object(tt.a)(a.state.timeStart)>=Object(tt.a)(a.state.timeEnd)&&(t=[].concat(Object(Y.a)(t),["\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u0432\u0440\u0435\u043c\u044f"])),a.props.token&&0==t.length){var n=a.props.token,r={group_id:a.state.id,time_start:Object(at.a)(a.state.timeStart),time_end:Object(at.a)(a.state.timeEnd),token:a.props.token,action:"buy"};a.props.buyStreamTime(n,r).then(function(){a.props.getUserChannels().then(a.props.soldStreams),a.props.getPurchasedChannels().then(a.props.purchasedStreams)}).then(a.props.searchChannels(n)).then(a.getStreamTime(a.state.id)).then(a.setState({disabled:!1,error:!1}))}else a.setState({error:t})},a.getStreamTime=function(e){a.setState({disabled:!1,availableTime:i.a.createElement("p",{style:{color:"green"}},"\u0422\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0439 \u043d\u0435 \u0437\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043e")});var t=a.props.found[e].time;if(t){var n=t.filter(function(e){return 1e3*+e.start>Object(tt.a)(a.state.startOfDay)&&1e3*+e.start<Object(tt.a)(a.state.endOfDay)});n.length>0&&a.setState({availableTime:i.a.createElement("div",{style:{color:"red"}},i.a.createElement("div",null,"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0435 \u0434\u043b\u044f \u043f\u043e\u043a\u0443\u043f\u043a\u0438 \u0432\u0440\u0435\u043c\u044f"),n.map(function(e,t){return i.a.createElement("div",{key:t},Object(nt.a)(1e3*e.start,"dd.MM.yyyy HH:mm"),"\xa0\xa0-\xa0\xa0",Object(nt.a)(1e3*e.end,"dd.MM.yyyy HH:mm"))}))})}},a.setStreamDate=function(e){a.setState({disabled:!1,availableTime:i.a.createElement("p",{style:{color:"green"}},"\u0422\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0439 \u043d\u0435 \u0437\u0430\u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043e"),startOfDay:Object(Nt.a)(e),endOfDay:Object(It.a)(e)});var t=a.props.found[a.state.id].time;if(t&&a.state.id){var n=t.filter(function(t){return 1e3*+t.start>Object(tt.a)(Object(Nt.a)(e))&&1e3*+t.start<Object(tt.a)(Object(It.a)(e))});n.length>0&&a.setState({availableTime:i.a.createElement("div",{style:{color:"red"}},i.a.createElement("div",null,"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0435 \u0434\u043b\u044f \u043f\u043e\u043a\u0443\u043f\u043a\u0438 \u0432\u0440\u0435\u043c\u044f"),n.map(function(e,t){return i.a.createElement("div",{key:t},Object(nt.a)(1e3*e.start,"dd.MM.yyyy HH:mm"),"\xa0\xa0-\xa0\xa0",Object(nt.a)(1e3*e.end,"dd.MM.yyyy HH:mm"))}))})}},a.changeTimeStart=function(e){Object(tt.a)(a.state.timeEnd)<=Object(tt.a)(e)&&a.setState({timeEnd:new Date(e.getTime()+36e5)}),a.setState({timeStart:e}),a.setState({disabled:!1})},a.changeTimeEnd=function(e){Object(tt.a)(a.state.timeStart)>=Object(tt.a)(e)&&a.setState({timeStart:new Date(e.getTime()-36e5)}),a.setState({timeEnd:e}),a.setState({disabled:!1})},a.getSum=function(){var e=a.state,t=e.timeStart,n=e.timeEnd,r=e.id,o=a.props.found[r].price,l=0;return r?(l=Math.ceil((Object(tt.a)(n)-Object(tt.a)(t))/36e5*+o))<0?i.a.createElement("div",{style:{color:"red"}},"\u0412\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0438 \u043a\u043e\u043d\u0446\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e!"):i.a.createElement("div",null,l," \u0440\u0443\u0431."):i.a.createElement("div",null,"0 \u0440\u0443\u0431.")},a.list=function(){return a.props.found_index&&a.props.found_index.length>0?a.props.found_index.map(function(e){return i.a.createElement(S.Cell,{before:i.a.createElement(S.Avatar,{size:40,src:a.props.found[e].photo}),onClick:function(){return a.selectChannel(e)},size:"l",key:e,asideContent:a.props.found[e].price+" \u0440\u0443\u0431 / \u0447\u0430\u0441",className:"channel"},a.props.found[e].name)}):null},a.timeNow=new Date,a.state={select:!1,id:0,price:0,startOfDay:Object(Nt.a)(a.timeNow),endOfDay:Object(It.a)(a.timeNow),timeStart:a.timeNow,timeEnd:a.timeNow,changed:!1,disabled:!1,availableTime:null,minutesStep:15},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this,t=this.props.found,a=this.state,n=a.id,r=a.timeStart,o=a.timeEnd,l=a.startOfDay,s=a.minutesStep;return i.a.createElement(S.Div,null,this.state.select?i.a.createElement(S.List,{className:"select-translation"},i.a.createElement(S.Cell,{onClick:function(){return e.selectChannel()},asideContent:i.a.createElement(Xe.a,null)},"\u041f\u043e\u043a\u0443\u043f\u043a\u0430 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438"),i.a.createElement(S.Cell,{before:i.a.createElement(S.Avatar,{size:40,src:t[n].photo}),size:"l",asideContent:t[n].price+" \u0440\u0443\u0431/\u0447\u0430\u0441"},t[n].name),i.a.createElement(S.FormLayout,{onSubmit:this.buyStreamTime,getRef:function(t){return e.formBuyTime=t}},i.a.createElement("div",{className:"broadcast-date"},i.a.createElement(Ze.c,{utils:et.a,locale:ot.a},i.a.createElement(Ze.a,{value:l,onChange:this.setStreamDate,minDate:new Date,format:"dd.MM.yyyy",ref:function(t){return e.dateBroadcast=t},keyboard:!0,name:"date",cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430"}))),i.a.createElement("div",{className:"free-time"},this.state.id?this.state.availableTime:null),i.a.createElement(S.FormLayoutGroup,{top:"\u0418\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438"},i.a.createElement("div",{className:"date-time"},i.a.createElement(Ze.c,{utils:et.a,locale:ot.a},i.a.createElement(Ze.b,{keyboard:!0,ampm:!1,label:"\u043e\u0442",onError:console.log,minDate:this.timeNow,value:r,onChange:this.changeTimeStart,format:"dd.MM.yyyy HH:mm",disableOpenOnEnter:!0,mask:[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/],minutesStep:s,cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430"}),i.a.createElement(Ze.b,{keyboard:!0,ampm:!1,label:"\u0434\u043e",onError:console.log,minDate:this.timeNow,value:o,onChange:this.changeTimeEnd,format:"dd.MM.yyyy HH:mm",disableOpenOnEnter:!0,mask:[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/],minutesStep:s,cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430"})))),i.a.createElement("div",{className:"summ"},i.a.createElement("h4",null,"\u0421\u0443\u043c\u043c\u0430: "),this.getSum()),i.a.createElement("input",{type:"hidden",name:"group_id",value:n}),this.props.process,i.a.createElement(S.Button,{size:"xl",disabled:this.state.disabled},"\u0417\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c"))):this.list())}}]),t}(o.Component),Vt={buyStreamTime:function(e,t){return function(a){a({type:"START"});var n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(e)},body:Q.a.stringify(t)};return fetch("".concat(window.location.protocol,"//").concat(window.location.host,"/api/market"),n).then(function(e){if(e.ok)return e.json()}).then(function(e){if(setTimeout(function(){return a({type:"CLEAR_STATUS"})},1500),e.status){if("ok"===e.status)return a({type:"SUCCESS"});if("error"===e.status)return a({type:"FAILURE",payload:e.message})}return a({type:"FAILURE"})})}},searchChannels:pe,getUserChannels:oe,soldStreams:ue,getPurchasedChannels:se,purchasedStreams:de},Mt=Object(c.c)(function(e){return{found:e.channels.found,found_index:e.channels.found_index,token:e.app.token,process:e.app.process}},Vt)(Lt),Bt=(a(453),function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(z.a)(this,Object(K.a)(t).call(this,e))).searchTranslationClick=function(){a.setState({show:!0})},a.searchChannels=function(e){if(e.preventDefault(),a.props.token&&a.formSearchChannels){var t={action:"search",token:a.props.token};a.state.changed&&(t.time_start=Object(at.a)(a.state.timeStart),t.time_end=Object(at.a)(a.state.timeEnd)),""!==a.state.name.trim()&&(t.name=a.state.name),a.props.searchChannels(a.props.token,t).then(a.setState({show:!0}))}},a.changeTimeStart=function(e){Object(tt.a)(a.state.timeEnd)<=Object(tt.a)(e)&&a.setState({timeEnd:new Date(e.getTime()+36e5)}),a.setState({timeStart:e}),a.setState({changed:!0})},a.changeTimeEnd=function(e){Object(tt.a)(a.state.timeStart)>=Object(tt.a)(e)&&a.setState({timeStart:new Date(e.getTime()-36e5)}),a.setState({timeEnd:e}),a.setState({changed:!0})},a.popout={hidden:null,spinner:i.a.createElement(S.ScreenSpinner,null)},a.timeNow=new Date,a.state={show:!1,name:"",timeStart:a.timeNow,timeEnd:a.timeNow,changed:!1,minutesStep:15},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){document.title="\u0411\u0438\u0440\u0436\u0430"}},{key:"render",value:function(){var e=this;return i.a.createElement(S.View,{activePanel:this.props.activeTab,popout:this.popout[this.props.popout]},i.a.createElement(S.Panel,{id:this.props.activeTab},i.a.createElement(Be,null),i.a.createElement(S.Group,{style:{paddingTop:60,paddingBottom:60,color:"gray"},className:this.props.activeTab},this.props.user?i.a.createElement(wt,null):null,i.a.createElement(S.Div,null,i.a.createElement(S.FormLayout,{onSubmit:this.searchChannels,getRef:function(t){return e.formSearchChannels=t}},i.a.createElement(S.Input,{className:"search",type:"text",onChange:function(t){return e.setState({name:t.target.value})},placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e"}),i.a.createElement(S.FormLayoutGroup,{top:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0439 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b"},i.a.createElement("div",{className:"date-time"},i.a.createElement(Ze.c,{utils:et.a,locale:ot.a},i.a.createElement(Ze.b,{keyboard:!0,ampm:!1,label:"\u043e\u0442",onError:console.log,minDate:this.timeNow,value:this.state.timeStart,onChange:this.changeTimeStart,format:"dd.MM.yyyy HH:mm",disableOpenOnEnter:!0,mask:[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/],minutesStep:this.state.minutesStep,cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430"}),i.a.createElement(Ze.b,{keyboard:!0,ampm:!1,label:"\u0434\u043e",onError:console.log,minDate:this.timeNow,value:this.state.timeEnd,onChange:this.changeTimeEnd,format:"dd.MM.yyyy HH:mm",disableOpenOnEnter:!0,mask:[/\d/,/\d/,".",/\d/,/\d/,".",/\d/,/\d/,/\d/,/\d/," ",/\d/,/\d/,":",/\d/,/\d/],minutesStep:this.state.minutesStep,cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430"})))),i.a.createElement(S.Button,{size:"xl"},"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c"))),this.state.show?i.a.createElement(Mt,null):null)))}}]),t}(o.Component)),Ut={searchChannels:pe},Rt=Object(c.c)(function(e){return{token:e.app.token,user:e.app.user,popout:e.app.popout,activeTab:e.app.activeTab}},Ut)(Bt),Ht=(a(455),a(230)),Gt=a.n(Ht),Ft=function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(z.a)(this,Object(K.a)(t).call(this,e))).shedulerSwitch=function(){a.state.shedulerSwitch?a.setState({shedulerSwitch:!1,events:a.props.purchasedStreams().payload,defaultValue:0}):a.setState({shedulerSwitch:!0,events:a.props.soldStreams().payload,defaultValue:0})},a.showChannel=function(e){var t=e.target.value;a.state.shedulerSwitch?a.setState({defaultValue:t,events:a.props.soldStreams(t).payload}):a.setState({defaultValue:t,events:a.props.purchasedStreams(t).payload})},a.popout={closed:null,spinner:i.a.createElement(S.ScreenSpinner,null)},a.state={events:e.soldStreams().payload,shedulerSwitch:!0,defaultView:"month",defaultValue:0},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){document.title="\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}},{key:"render",value:function(){var e=this;return i.a.createElement(S.View,{activePanel:this.props.activeTab,popout:this.popout[this.props.popout]},i.a.createElement(S.Panel,{id:this.props.activeTab},i.a.createElement(Be,null),i.a.createElement(S.Group,{style:{paddingTop:60,paddingBottom:60,color:"gray"},className:this.props.activeTab},this.props.user?i.a.createElement(wt,null):null,i.a.createElement(S.Div,null,i.a.createElement(S.Button,{style:{marginRight:5},level:this.state.shedulerSwitch?"primary":"outline",onClick:this.shedulerSwitch},"\u041c\u043e\u0438 \u043a\u0430\u043d\u0430\u043b\u044b"),i.a.createElement(S.Button,{level:this.state.shedulerSwitch?"outline":"primary",onClick:this.shedulerSwitch},"\u041c\u043e\u0438 \u0442\u0440\u0430\u043d\u0441\u043b\u044f\u0446\u0438\u0438")),i.a.createElement(S.Div,null,i.a.createElement(S.Select,{defaultValue:this.state.defaultValue,name:"album",alignment:"left",onChange:function(t){return e.showChannel(t)}},i.a.createElement("option",{key:0,value:0},"\u0412\u0441\u0435"),this.state.shedulerSwitch?this.props.owner_index.map(function(t){return i.a.createElement("option",{key:t,value:t},e.props.owner[t].name)}):this.props.purchased_index.map(function(t){return i.a.createElement("option",{key:t,value:t},e.props.purchased[t].name)}))),this.props.loadData?i.a.createElement(w,null):i.a.createElement(S.Div,null,i.a.createElement(Gt.a,{id:"GPL-My-Project-Is-Open-Source",locale:"ru",header:{left:"prev,today,next",center:"title",right:"agendaDay,agendaWeek,month"},buttonText:{today:"\u0441\u0435\u0433\u043e\u0434\u043d\u044f",month:"\u043c\u0435\u0441\u044f\u0446",week:"\u043d\u0435\u0434\u0435\u043b\u044f",day:"\u0434\u0435\u043d\u044c"},editable:!1,defaultView:this.state.defaultView,allDaySlot:!1,selectHelper:!0,droppable:!0,slotLabelFormat:"HH:mm",defaultDate:new Date,navLinks:!0,eventLimit:!0,events:this.state.events,timeFormat:"HH:mm",eventLimitText:"\u0435\u0449\u0451",dayPopoverFormat:"dddd, DD.MM.YY",selectable:!0,select:function(e,t,a,n){return console.log(e,t,a,n)}})))))}}]),t}(o.Component),zt={soldStreams:ue,purchasedStreams:de},Kt=Object(c.c)(function(e){return{token:e.app.token,user:e.app.user,loadData:e.app.loadData,popout:e.app.popout,process:e.app.process,activeTab:e.app.activeTab,owner:e.channels.owner,owner_index:e.channels.owner_index,purchased:e.channels.purchased,purchased_index:e.channels.purchased_index}},zt)(Ft),Wt=(a(474),function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(z.a)(this,(e=Object(K.a)(t)).call.apply(e,[this].concat(r)))).popout=function(){switch(a.props.popout){case"hidden":return null;case"success":return a.popup();default:return null}},a.popup=function(){return setTimeout(function(){return a.props.setPopup("hidden")},1e3),i.a.createElement(S.Alert,{onClose:function(){return a.props.setPopup("hidden")}},i.a.createElement(S.Div,{style:{color:"green"}},"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e!"))},a.copyLink=function(){a.props.setPopup("success")},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){document.title="\u041f\u0430\u0440\u0442\u043d\u0435\u0440\u0441\u043a\u0430\u044f \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430",this.props.getReferrals()}},{key:"render",value:function(){var e=this.props,t=e.activeTab,a=(e.popout,e.profit),n=e.referrals,r=e.user,o={paddingTop:e.isMobile?10:60,paddingBottom:60,color:"gray"},l="".concat(window.location.protocol,"//").concat(window.location.host,"/p/").concat(r.ref_id);return i.a.createElement(S.View,{activePanel:t,popout:this.popout()},i.a.createElement(S.Panel,{id:t},i.a.createElement(Be,null),i.a.createElement(S.Group,{style:o,className:t},r?i.a.createElement(wt,null):null,i.a.createElement(S.Div,null,i.a.createElement(S.Group,{title:"\u0412\u0430\u0448\u0430 \u0441\u0441\u044b\u043b\u043a\u0430 \u0434\u043b\u044f \u043f\u0440\u0438\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u043e\u0432"},i.a.createElement(S.Div,{className:"input-copy"},i.a.createElement(S.Input,{id:"reflink",disabled:!0,value:l}),i.a.createElement(Oe.a,{text:l,onCopy:this.copyLink},i.a.createElement(we.a,null)))),i.a.createElement(S.Group,{title:"\u0411\u043e\u043d\u0443\u0441 \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u043c"},i.a.createElement(S.Div,null,"\u041f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u043e \u0412\u0430\u0448\u0435\u0439 \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u0441\u043a\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435 \u043a\u043b\u0438\u0435\u043d\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0431\u043e\u043d\u0443\u0441 - 300 \u0440\u0443\u0431 \u043d\u0430 \u0431\u0430\u043b\u0430\u043d\u0441 \u0441\u0432\u043e\u0435\u0433\u043e \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430.",i.a.createElement("br",null),"\u0412\u044b\u0441\u043e\u043a\u0430\u044f \u043a\u043e\u043c\u0438\u0441\u0441\u0441\u0438\u044f \u0432 \u0440\u0430\u0437\u043c\u0435\u0440\u0435 30% \u043e\u0442 \u0432\u0441\u0435\u0445 \u043f\u043b\u0430\u0442\u0435\u0436\u0435\u0439 \u043f\u0440\u0438\u0432\u043b\u0435\u0447\u0435\u043d\u043d\u044b\u0445 \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u043e\u0432.")),i.a.createElement(S.Group,{title:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"},i.a.createElement(S.Div,null,"\u0414\u0435\u0442\u0430\u043b\u044c\u043d\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0447\u0438\u0441\u043b\u0443 \u0440\u0435\u0444\u0435\u0440\u0430\u043b\u043e\u0432 \u0438 \u0437\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u043c \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c.")),i.a.createElement(S.Group,{title:"\u041f\u0430\u0440\u0442\u043d\u0435\u0440\u044b: ".concat(r.partners)}),i.a.createElement(S.Group,{title:"\u0417\u0430\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043e: ".concat(Math.floor(a)," \u20bd")},n&&n.length>0?i.a.createElement(S.List,null,n.map(function(e,t){return i.a.createElement(S.Cell,{before:"".concat(Math.floor(e.sum)," \u20bd"),size:"l",multiline:!0,key:t,asideContent:Object(nt.a)(1e3*e.date,"dd.MM.yyyy"),bottomContent:e.description},e.name," ",e.fename)})):null)))))}}]),t}(o.Component)),Jt={getReferrals:function(){return function(e,t){var a=!1;0===t().app.updating&&e({type:v});var n=t().app.token||X.a.get("token");if(!n)return 1===t().app.updating&&e({type:E}),new Promise(function(e){return e(!1)});var r={method:"GET",headers:{Authorization:"Bearer ".concat(n)}},o="".concat(window.location.protocol,"//").concat(window.location.host,"/api/balance?").concat(Q.a.stringify({token:n}));return fetch(o,r).then(function(e){return e.ok?e.json():{data:{status:!1}}}).then(function(n){if("ok"===n.status){var r=n.referrals,o=n.profit,i=n.balance;e({type:"REFERRALS",payload:{balance:i,referrals:r,profit:o}}),a=!0}return 1===t().app.updating&&e({type:E}),a})}},setPopup:ne},Yt=Object(c.c)(function(e){return{activeTab:e.app.activeTab,popout:e.app.popout,user:e.app.user,referrals:e.balance.referrals,profit:e.balance.profit,isMobile:e.app.isMobile}},Jt)(Wt),qt=a(115),Xt=a(231),$t=a.n(Xt),Qt=(a(210),function(e){function t(){return Object(G.a)(this,t),Object(z.a)(this,Object(K.a)(t).apply(this,arguments))}return Object(W.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){return this.props.loaded&&this.props.history&&this.props.history.length>0?i.a.createElement("table",null,i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"\u0414\u0430\u0442\u0430"),i.a.createElement("th",null,"\u0421\u0443\u043c\u043c\u0430"),i.a.createElement("th",null,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"))),i.a.createElement("tbody",null,this.props.history.map(function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,Object(nt.a)(1e3*e.date,"dd.MM.yyyy")),i.a.createElement("td",null,i.a.createElement("span",{style:"+"===e.type?{color:"green"}:{color:"red"}},e.type),Math.floor(e.sum)),i.a.createElement("td",null,e.description))}))):null}}]),t}(o.Component)),Zt={balanceHistory:function(){return function(e,t){var a=!1,n=t().app.token||X.a.get("token");if(!n)return new Promise(function(e){return e(!1)});var r={method:"GET",headers:{Authorization:"Bearer ".concat(n)}},o="".concat(window.location.protocol,"//").concat(window.location.host,"/api/balance?").concat(Q.a.stringify({token:n}));return fetch(o,r).then(function(e){return e.ok?e.json():{data:{status:!1}}}).then(function(t){if("ok"===t.status){var n=t.balance;e({type:"BALANCE",payload:{balance:n}}),a=!0}return a})}}},ea=Object(c.c)(function(e){return{history:e.balance.history,loaded:e.balance.loaded}},Zt)(Qt),ta=function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(z.a)(this,Object(K.a)(t).call(this,e))).popout=function(){switch(a.props.popout){case"hidden":return null;case"spinner":return i.a.createElement(S.ScreenSpinner,null);case"prolong":return a.prolongPopup();case"success":return a.resultPopup(!0);case"failure":return a.resultPopup();case"message":return a.resultPopup(a.props.message);default:return null}},a.prolongPopup=function(){return i.a.createElement(S.Alert,{onClose:function(){return a.props.setPopup("hidden")}},i.a.createElement(S.Div,null,i.a.createElement(S.Div,null,"\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u0442\u0430\u0440\u0438\u0444 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0434\u043b\u0435\u043d \u043d\u0430 1 \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u043d\u044b\u0435\u0439 \u043c\u0435\u0441\u044f\u0446"),i.a.createElement(S.Div,{style:{display:"flex"}},i.a.createElement(S.Button,{size:"l",stretched:!0,style:{marginRight:8},onClick:a.props.prolongTariff},"\u041e\u043a"),i.a.createElement(S.Button,{size:"l",stretched:!0,level:"secondary",onClick:function(){return a.props.setPopup("hidden")}},"\u041e\u0442\u043c\u0435\u043d\u0430"))))},a.resultPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return setTimeout(function(){return a.props.setPopup("hidden")},3e3),i.a.createElement(S.Alert,{onClose:function(){return a.props.setPopup("hidden")}},i.a.createElement(S.Div,{style:e?{color:"green"}:{color:"red"}},!0===e?"\u0423\u0441\u043f\u0435\u0448\u043d\u043e!":!1===e?"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a \u2639":e))},a.channelCount=function(e){var t=!0;a.props.tariff?a.props.tariff&&+a.props.tariff.amount!==+e&&(t=!1):t=!1;var n=+e>2?(+e-2)*a.state.discount:0;n>a.state.maxDiscount&&(n=a.state.maxDiscount);var r=Math.ceil(a.state.price*(1+(+e-2)*(1-n/100)));a.setState({disabled:t,newAmount:+e,totalPrice:r,needPayment:a.props.balance<r?r-Math.floor(a.props.balance):0})},a.changeTariff=function(){if(a.state.needPayment&&a.state.needPayment>0)void 0===localStorage.balance&&void 0===localStorage.payment&&void 0===localStorage.newAmount&&(localStorage.balance=a.props.balance,localStorage.payment=a.state.needPayment,localStorage.newAmount=a.state.newAmount),a.setState({payment:a.state.needPayment}),a.props.setActiveTab("balance","/balance/payment"),a.checkPayment().then(function(){a.props.setActiveTab("balance","/balance/tariff")});else{var e=localStorage.newAmount?localStorage.newAmount:a.state.newAmount;a.props.changeTariff(e).then(function(e){e&&a.setState({disabled:!0}),void 0!==localStorage.balance&&void 0!==localStorage.payment&&void 0!==localStorage.newAmount&&(delete localStorage.balance,delete localStorage.payment,delete localStorage.newAmount),a.props.getTariff().then(function(e){e?a.channelCount(a.props.tariff.amount):a.channelCount(a.state.newAmount)})})}},a.doPayment=function(){"yandex"===a.state.paymentSystem?a.state.form.submit():"vkpay"===a.state.paymentSystem&&H.a.send("VKWebAppOpenPayForm",{app_id:6958212,action:"pay-to-group",params:{amount:a.state.payment,description:"\u043f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0431\u0430\u043b\u0430\u043d\u0441\u0430",group_id:158819144}})},a.checkPayment=function(){if(void 0!==localStorage.balance&&void 0!==localStorage.payment&&void 0!==localStorage.newAmount)return new Promise(function(e){var t=setInterval(function(){a.props.getBalance().then(function(t){t&&+a.props.balance>=+localStorage.balance+ +localStorage.payment&&(a.setState({needPayment:0},a.changeTariff),a.state.intervalId&&clearInterval(a.state.intervalId),e(!0))})},1e3);a.setState({intervalId:t})})},a.state={changeTariff:"/balance/tariff"===e.pathname,newAmount:2,price:150,totalPrice:0,balance:100,maxDiscount:51,discount:3,disabled:!0,payment:0,paymentSystem:"yandex",receiver:41001135399963,pathname:e.pathname,form:!1},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.title="\u0411\u0430\u043b\u0430\u043d\u0441",this.props.getTariff().then(function(t){t?e.channelCount(e.props.tariff.amount):e.channelCount(e.state.newAmount)}),this.checkPayment()}},{key:"render",value:function(){var e=this,t=this.props,a=t.tariff,n=t.isMobile,r=this.state.needPayment,l="\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0442\u0430\u0440\u0438\u0444";l=a?r&&r>0?"\u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0431\u0430\u043b\u0430\u043d\u0441 \u0438 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0442\u0430\u0440\u0438\u0444":"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0442\u0430\u0440\u0438\u0444":r&&r>0?"\u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0431\u0430\u043b\u0430\u043d\u0441 \u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0442\u0430\u0440\u0438\u0444":"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0442\u0430\u0440\u0438\u0444";var s={paddingTop:n?5:60,paddingBottom:60,color:"gray"};return i.a.createElement(S.View,{activePanel:this.props.activeTab,popout:this.popout()},i.a.createElement(S.Panel,{id:this.props.activeTab},i.a.createElement(Be,null),i.a.createElement(S.Group,{style:s,className:this.props.activeTab},i.a.createElement(S.List,{style:{paddingBottom:n?"60px":"0px"}},i.a.createElement(S.Cell,null,i.a.createElement(S.Div,null,"/balance"===this.props.pathname?i.a.createElement(S.Cell,null,i.a.createElement(S.Group,{title:"\u0412\u0430\u0448 \u0431\u0430\u043b\u0430\u043d\u0441"},i.a.createElement(S.Cell,null,Math.floor(this.props.balance)," \u20bd"),i.a.createElement(S.Div,{className:"balance-button"},i.a.createElement(S.Button,{before:"",size:"l",onClick:function(){return e.props.setActiveTab("balance","/balance/payment")}},"\u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c"))),i.a.createElement(S.Group,{title:"\u0422\u0430\u0440\u0438\u0444"},i.a.createElement(S.List,null,this.props.tariff?i.a.createElement(o.Fragment,null,i.a.createElement(S.Cell,null,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u0430\u043d\u0430\u043b\u043e\u0432: ",this.props.tariff.amount),i.a.createElement(S.Cell,null,"\u0422\u0430\u0440\u0438\u0444 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u0435\u043d \u0434\u043e ",Object(nt.a)(1e3*this.props.tariff.end,"dd.MM.yyyy"))):i.a.createElement(S.Cell,{multiline:!0},"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0442\u0430\u0440\u0438\u0444\u043e\u0432"),i.a.createElement(S.Div,{className:"balance-button"},i.a.createElement(S.Button,{before:"",size:"l",onClick:function(){return e.props.setActiveTab("balance","/balance/tariff")},style:{marginRight:5}},this.props.tariff?"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c":"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c"),this.props.tariff?i.a.createElement(S.Button,{before:"",size:"l",onClick:function(){return e.props.setPopup("prolong")}},"\u041f\u0440\u043e\u0434\u043b\u0438\u0442\u044c"):null))),i.a.createElement(S.Group,{title:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439"},i.a.createElement(S.Cell,{multiline:!0},i.a.createElement(ea,null)))):null,"/balance/tariff"===this.props.pathname?i.a.createElement(S.Div,null,i.a.createElement(S.Cell,null,i.a.createElement(qt.a,{className:"back-link",to:"/balance"},"\u041d\u0430\u0437\u0430\u0434")),i.a.createElement(S.Group,{title:"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0442\u0430\u0440\u0438\u0444\u0430"},i.a.createElement(S.Cell,{multiline:!0},i.a.createElement(S.Div,{className:"total_price"},"\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u0431\u0430\u043b\u0430\u043d\u0441 ",i.a.createElement("span",null,Math.floor(this.props.balance))," \u20bd"),i.a.createElement(S.Div,null,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u0430\u043d\u0430\u043b\u043e\u0432: ",this.state.newAmount),i.a.createElement(S.Div,null,i.a.createElement($t.a,{classes:{thumb:"slider-thumb",track:"slider-track"},value:+this.state.newAmount,min:2,max:100,step:1,onChange:function(t,a){return e.channelCount(a)}})),i.a.createElement(S.Div,null,"\u041a\u0430\u0436\u0434\u044b\u0439 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u043a\u0430\u043d\u0430\u043b \u0443\u043c\u0435\u043d\u044c\u0448\u0430\u0435\u0442 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043d\u0430 3%! *"),i.a.createElement(S.Div,{className:"total_price"},"\u0418\u0442\u043e\u0433\u043e ",i.a.createElement("span",null,this.state.totalPrice)," \u20bd"),i.a.createElement(S.Div,null,i.a.createElement(S.Button,{disabled:this.state.disabled,size:"l",onClick:this.changeTariff},l)),i.a.createElement(S.Div,null,"* \u041f\u0440\u0438 \u0434\u043e\u0441\u0440\u043e\u0447\u043d\u043e\u043c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0442\u0430\u0440\u0438\u0444\u0430 \u043d\u0430 \u0431\u0430\u043b\u0430\u043d\u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0441\u0443\u043c\u043c\u0430 \u0437\u0430 \u043d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043f\u0435\u0440\u0438\u043e\u0434")))):null,"/balance/payment"===this.props.pathname?i.a.createElement(S.Div,null,i.a.createElement(S.Cell,null,i.a.createElement(qt.a,{className:"back-link",to:"/balance"},"\u041d\u0430\u0437\u0430\u0434")),i.a.createElement(S.Group,{title:"\u041f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0431\u0430\u043b\u0430\u043d\u0441\u0430"},i.a.createElement(S.Cell,null,"\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u0431\u0430\u043b\u0430\u043d\u0441: ",Math.floor(this.props.balance)," \u20bd"),i.a.createElement(S.Cell,null,i.a.createElement(S.Div,{className:"money-count-title"},"\u0421\u0443\u043c\u043c\u0430 \u043f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0432 \u0440\u0443\u0431\u043b\u044f\u0445"),i.a.createElement(S.Input,{value:String(this.state.payment),onChange:function(t){return e.setState({payment:t.target.value})}})),i.a.createElement(S.Group,{title:"\u041f\u043b\u0430\u0442\u0435\u0436\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430"},i.a.createElement(S.Cell,{multiline:!0},i.a.createElement(S.Tabs,{type:"buttons"},i.a.createElement(S.TabsItem,{onClick:function(){return e.setState({paymentSystem:"yandex"})},selected:"yandex"===this.state.paymentSystem},"\u042f\u043d\u0434\u0435\u043a\u0441.\u0414\u0435\u043d\u044c\u0433\u0438"),i.a.createElement(S.TabsItem,{onClick:function(){e._form=!1,e.setState({paymentSystem:"unitpay",form:!1})},selected:"unitpay"===this.state.paymentSystem},"Unitpay"),this.props.vkApp?i.a.createElement(S.TabsItem,{onClick:function(){e._form=!1,e.setState({paymentSystem:"vkpay",form:!1})},selected:"vkpay"===this.state.paymentSystem},"VK Pay"):null),"yandex"===this.state.paymentSystem?i.a.createElement(S.Div,{className:"payment-system"},i.a.createElement("form",{target:"_blank",method:"POST",action:"https://money.yandex.ru/quickpay/confirm.xml",ref:function(t){e.state.form||e.setState({form:t})}},i.a.createElement("input",{type:"hidden",name:"receiver",defaultValue:this.state.receiver}),i.a.createElement("input",{type:"hidden",name:"quickpay-form",value:"donate"}),i.a.createElement("input",{type:"hidden",name:"targets",value:"\u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u044f"}),i.a.createElement(S.Radio,{name:"paymentType",value:"PC",defaultChecked:!0},"\u042f\u043d\u0434\u0435\u043a\u0441.\u0414\u0435\u043d\u044c\u0433\u0430\u043c\u0438"),i.a.createElement(S.Radio,{name:"paymentType",value:"AC"},"\u0411\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0439 \u043a\u0430\u0440\u0442\u043e\u0439"),i.a.createElement("input",{type:"hidden",name:"sum",defaultValue:this.state.payment}),i.a.createElement("input",{type:"hidden",name:"label",defaultValue:this.props.user.user_id}),i.a.createElement("input",{type:"hidden",name:"successURL",value:"http://streamvi.ru/balance"}))):i.a.createElement(S.Div,{className:"payment-system"}),i.a.createElement(S.Button,{disabled:!(("yandex"===this.state.paymentSystem&&this.state.form||"vkpay"===this.state.paymentSystem&&this.props.vkApp)&&this.state.payment>0),size:"l",onClick:this.doPayment},"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u043e\u043f\u043b\u0430\u0442\u0435"))))):null))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a={},n={};return"/balance/tariff"===e.pathname!==t.changeTariff&&(a=Object(b.a)({},a,{changeTariff:!t.changeTariff})),Object.keys(n).length>0&&e.tariffState(n),Object.keys(a).length>0?a:null}}]),t}(o.Component),aa={changeTariff:function(e){return function(t,a){var n=!1;0===a().app.updating&&t({type:v});var r=a().app.token||X.a.get("token");if(!r)return 1===a().app.updating&&t({type:E}),new Promise(function(e){return e(!1)});var o={method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({token:r,amount:e})},i="".concat(window.location.protocol,"//").concat(window.location.host,"/api/tariffs");return fetch(i,o).then(function(e){return e.ok?e.json():{data:{status:!1}}}).then(function(e){if("ok"===e.status){var r=e.tariff,o=e.balance;t({type:"TARIFF",payload:{tariff:r}}),t({type:"BALANCE",payload:{balance:o}}),t({type:"POPUP_MESSAGE",payload:{message:"\u0422\u0430\u0440\u0438\u0444 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d!"}}),n=!0}else e.message&&t({type:"POPUP_MESSAGE",payload:{message:e.message}});return 1===a().app.updating&&t({type:E}),n})}},getBalance:function(){return function(e,t){var a=!1,n=t().app.token||X.a.get("token");if(!n)return new Promise(function(e){return e(!1)});var r={method:"GET",headers:{Authorization:"Bearer ".concat(n)}},o="".concat(window.location.protocol,"//").concat(window.location.host,"/api/balance?").concat(Q.a.stringify({token:n}));return fetch(o,r).then(function(e){return e.ok?e.json():{data:{status:!1}}}).then(function(t){if("ok"===t.status){var n=t.balance,r=t.history;e({type:"BALANCE",payload:{balance:n,history:r,loaded:!0}}),a=!0}return a})}},getTariff:me,prolongTariff:function(){return function(e,t){var a=!1;0===t().app.updating&&e({type:v});var n=t().app.token||X.a.get("token");if(!n)return 1===t().app.updating&&e({type:E}),new Promise(function(e){return e(!1)});var r={method:"POST",headers:{Authorization:"Bearer ".concat(n)},body:JSON.stringify({token:n,action:"prolong"})},o="".concat(window.location.protocol,"//").concat(window.location.host,"/api/tariffs");return fetch(o,r).then(function(e){return e.ok?e.json():{data:{status:!1}}}).then(function(n){if("ok"===n.status){var r=n.tariff,o=n.balance;e({type:"TARIFF",payload:{tariff:r}}),e({type:"BALANCE",payload:{balance:o}}),e({type:"POPUP_SUCCESS"}),a=!0}else n.message&&e({type:"POPUP_MESSAGE",payload:{message:n.message}});return 1===t().app.updating&&e({type:E}),a})}},setActiveTab:ae,setPopup:ne,tariffState:function(e){return function(t){return t({type:"TARIFF",payload:e})}}},na=Object(c.c)(function(e){return{activeTab:e.app.activeTab,popout:e.app.popout,user:e.app.user,message:e.app.message,balance:e.balance.balance,tariff:e.tariffs.tariff,order:e.tariffs.order,pathname:e.router.location.pathname,vkApp:e.app.vkApp,isMobile:e.app.isMobile}},aa)(ta),ra=(a(479),function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(z.a)(this,Object(K.a)(t).call(this,e))).popout=function(){switch(a.props.popout){case"hidden":return null;case"spinner":return i.a.createElement(S.ScreenSpinner,null);default:return null}},a.state={},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){document.title="\u0410\u043a\u043a\u0430\u0443\u043d\u0442"}},{key:"render",value:function(){return i.a.createElement(S.View,{activePanel:this.props.activeTab,popout:this.popout()},i.a.createElement(S.Panel,{id:this.props.activeTab},i.a.createElement(Be,null),i.a.createElement(S.Group,{style:{paddingTop:60,paddingBottom:60,color:"gray"},className:this.props.activeTab},i.a.createElement(S.List,null,this.props.user?i.a.createElement(wt,null):null))))}}]),t}(o.Component)),oa=Object(c.c)(function(e){return{user:e.app.user,activeTab:e.app.activeTab}},{})(ra),ia=(a(481),function(e){function t(){return Object(G.a)(this,t),Object(z.a)(this,Object(K.a)(t).apply(this,arguments))}return Object(W.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this.props,t=e.activeTab,a=e.setActiveTab;e.user,e.isMobile;return i.a.createElement(S.View,{activePanel:t},i.a.createElement(S.Panel,{id:t},i.a.createElement(Be,null),i.a.createElement(S.Div,{className:t},i.a.createElement(S.Group,null,i.a.createElement(S.List,null,i.a.createElement(S.Cell,{expandable:!0,before:i.a.createElement(Le.a,null)},"\u0411\u0438\u0440\u0436\u0430"),i.a.createElement(S.Cell,{expandable:!0,before:i.a.createElement(Ne.a,null)},"\u0412\u0438\u0434\u0435\u043e"),i.a.createElement(S.Cell,{expandable:!0,before:i.a.createElement(xe.a,null),onClick:function(){return a("account")}},"\u0410\u043a\u043a\u0430\u0443\u043d\u0442"))))))}}]),t}(o.Component)),la={setActiveTab:ae},sa=Object(c.c)(function(e){return{activeTab:e.app.activeTab,popout:e.app.popout,user:e.app.user,isMobile:e.app.isMobile}},la)(ia),ca=(a(483),function(e){function t(){var e,a;Object(G.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(z.a)(this,(e=Object(K.a)(t)).call.apply(e,[this].concat(r)))).updateInfo=function(){a.props.getUserChannels().then(a.props.soldStreams),a.props.getAvailableChannels(),a.props.getPurchasedChannels().then(a.props.purchasedStreams),a.props.getTariff()},a}return Object(W.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){var e=this;H.a.subscribe(function(t){switch(t.detail.type){case"VKWebAppGetUserInfoResult":e.props.appState({fetchedUser:t.detail.data,vkApp:!0});break;case"VKWebAppAccessTokenReceived":e.props.appState({vk_access_token:t.detail.data.access_token,vkApp:!0}),e.props.newUser().then(function(t){t&&e.updateInfo()});break;case"VKWebAppOpenPayFormResult":t.detail.data.status&&(e.props.login(),e.props.setPopup(!0));break;case"VKWebAppGetUserInfoFailed":console.log("error",t.detail.type);default:console.log(t.detail.type)}}),H.a.send("VKWebAppGetUserInfo",{}),this.props.user||this.props.login().then(function(t){t?e.updateInfo():(H.a.send("VKWebAppGetAuthToken",{app_id:6958212,scope:"groups"}),e.props.fetchedUser&&e.props.vk_access_token&&e.props.newUser())}),this.props.pathname&&("/"===this.props.pathname?this.props.setActiveTab("translations","/"+this.props.search):this.props.setActiveTab(this.props.pathname.split("/")[1],this.props.pathname+this.props.search)),window.addEventListener("resize",function(t){(window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth)<500?e.props.setIsMobile(!0):e.props.setIsMobile(!1)})}},{key:"render",value:function(){return this.props.activeTab?i.a.createElement(J.c,null,i.a.createElement(J.a,{path:"/",exact:!0,component:ht}),i.a.createElement(J.a,{path:"/services",exact:!0,component:ht}),i.a.createElement(J.a,{path:"/groups",exact:!0,component:ht}),i.a.createElement(J.a,{path:"/video",exact:!0,component:Dt}),i.a.createElement(J.a,{path:"/video/album/:id",exact:!0,component:Dt}),i.a.createElement(J.a,{path:"/market",exact:!0,component:Rt}),i.a.createElement(J.a,{path:"/schedule",exact:!0,component:Kt}),i.a.createElement(J.a,{path:"/partner",exact:!0,component:Yt}),i.a.createElement(J.a,{path:"/balance",component:na}),i.a.createElement(J.a,{path:"/account",exact:!0,component:oa}),i.a.createElement(J.a,{path:"/menu",exact:!0,component:sa}),i.a.createElement(J.a,{component:ht})):null}}]),t}(o.Component)),pa={login:function(){return function(e,t){t().app.updating||e({type:v});var a=!1,n=t().app.token||X.a.get("token"),r=t().router.location.search;if(!n&&!r)return e({type:E}),new Promise(function(e){return e(a)});var o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n})},i="".concat(window.location.protocol,"//").concat(window.location.host,"/api/auth").concat(r);return fetch(i,o).then(function(e){return e.ok?e.json():{data:{status:!1}}}).then(function(t){return t.user_id?(t.jwt&&(n=t.jwt,X.a.set("token",t.jwt,{expires:30})),e({type:"LOGIN",payload:{user:t,token:n}}),t.balance&&e({type:"BALANCE",payload:{balance:t.balance,history:t.history}}),a=!0):e({type:E}),a})}},getAvailableChannels:le,getPurchasedChannels:se,getTariff:me,getUserChannels:oe,soldStreams:ue,purchasedStreams:de,setActiveTab:ae,appState:te,setPopup:ne,newUser:function(){return function(e,t){0===t().app.updating&&e({type:v});var a=!1,n=t().app.fetchedUser,r=t().app.vk_access_token;if(!n&&!r)return 1===t().app.updating&&e({type:E}),new Promise(function(e){return e(a)});var o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:n,vk_access_token:r})},i="".concat(window.location.protocol,"//").concat(window.location.host,"/api/auth");return fetch(i,o).then(function(e){return e.ok?e.json():{data:{status:!1}}}).then(function(n){if(n.user_id){var r=!1;n.jwt&&(r=n.jwt,X.a.set("token",n.jwt,{expires:30})),e({type:"LOGIN",payload:{user:n,token:r}}),n.balance&&e({type:"BALANCE",payload:{balance:n.balance}}),a=!0}else n.message&&e({type:"POPUP_MESSAGE",payload:{message:n.message}});return 1===t().app.updating&&e({type:E}),a})}},setIsMobile:function(e){return function(t){t({type:"IS_MOBILE",payload:e})}}},ua=Object(J.f)(Object(c.c)(function(e){return{popout:e.app.popout,user:e.app.user,activeTab:e.app.activeTab,fetchedUser:e.app.fetchedUser,vk_access_token:e.app.vk_access_token,pathname:e.router.location.pathname,search:e.router.location.search,isMobile:e.app.isMobile}},pa)(ca)),da=Object(d.createStore)((r=U,Object(d.combineReducers)({router:Object(p.b)(r),albums:k,app:j,balance:P,channels:D,schedule:I,tariffs:V,videos:B})),n,Object(f.composeWithDevTools)(Object(d.applyMiddleware)(Object(m.a)(U),h.a)));H.a.send("VKWebAppInit",{}),s.a.render(i.a.createElement("div",{className:"container",style:{height:"100%"}},i.a.createElement(c.a,{store:da},i.a.createElement(p.a,{history:U},i.a.createElement(ua,null)))),document.getElementById("root"))}},[[232,2,1]]]);
//# sourceMappingURL=main.073e82ce.chunk.js.map